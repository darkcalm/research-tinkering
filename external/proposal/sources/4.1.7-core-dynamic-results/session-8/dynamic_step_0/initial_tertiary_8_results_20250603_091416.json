{
  "totalHits": 293232,
  "limit": 10,
  "offset": 0,
  "results": [
    {
      "acceptedDate": "",
      "arxivId": null,
      "authors": [
        {
          "name": "Alessandra Papetti"
        },
        {
          "name": "Marta Rossi"
        },
        {
          "name": "Michele Germani"
        },
        {
          "name": "Roberto Menghi"
        }
      ],
      "citationCount": 0,
      "contributors": [],
      "outputs": [
        "https://api.core.ac.uk/v3/outputs/589942171"
      ],
      "createdDate": "2023-10-30T20:31:38",
      "dataProviders": [
        {
          "id": 828,
          "name": "",
          "url": "https://api.core.ac.uk/v3/data-providers/828",
          "logo": "https://api.core.ac.uk/data-providers/828/logo"
        }
      ],
      "depositedDate": "",
      "abstract": "Abstract In the recent years, many methodologies and tools to support the energy efficiency re-design of production systems have been developed, however, they do not investigate the real-time manufacturing process. In this paper, a methodology for energy efficiency re-design of production systems in a context of smart manufacturing is proposed. The continuous production-machine data collection with operator feedbacks enables the creation of a knowledge-based repository that provides useful support during the design of manufacturing systems. A case study in an automotive sector company has allowed to implement the methodology and to assess its effectiveness",
      "doi": "10.1016/j.procir.2020.02.182",
      "downloadUrl": "https://core.ac.uk/download/589942171.pdf",
      "fieldOfStudy": null,
      "fullText": "ScienceDirectAvailable online at www.sciencedirect.comAvailable online at www.sciencedirect.comScienceDirectProcedia CIRP 00 (2017) 000\u2013000  www.elsevier.com/locate/procedia 2212-8271 \u00a9 2017 The Authors. Published by Elsevier B.V. Peer-review under responsibility of the scientific committee of the 28th CIRP Design Conference 2018. 28th CIRP Design Conference, May 2018, Nantes, FranceA new methodology to analyze the functional and physical architecture of existing products for an assembly oriented product family identification Paul Stief *, Jean-Yves Dantan, Alain Etienne, Ali Siadat \u00c9cole Nationale Sup\u00e9rieure d\u2019Arts et M\u00e9tiers, Arts et M\u00e9tiers ParisTech, LCFC EA 4495, 4 Rue Augustin Fresnel, Metz 57078, France * Corresponding author. Tel.: +33 3 87 37 54 30; E-mail address: paul.stief@ensam.euAbstract In today\u2019s business environment, the trend towards more product variety and customization is unbroken. Due to this development, the need of agile and reconfigurable production systems emerged to cope with various products and product families. To design and optimize productionsystems as well as to choose the optimal product matches, product analysis methods are needed. Indeed, most of the known methods aim to analyze a product or one product family on the physical level. Different product families, however, may differ largely in terms of the number and nature of components. This fact impedes an efficient comparison and choice of appropriate product family combinations for the productionsystem. A new methodology is proposed to analyze existing products in view of their functional and physical architecture. The aim is to clusterthese products in new assembly oriented product families for the optimization of existing assembly lines and the creation of future reconfigurable assembly systems. Based on Datum Flow Chain, the physical structure of the products is analyzed. Functional subassemblies are identified, and a functional analysis is performed. Moreover, a hybrid functional and physical architecture graph (HyFPAG) is the output which depicts the similarity between product families by providing design support to both, production system planners and product designers. An illustrativeexample of a nail-clipper is used to explain the proposed methodology. An industrial case study on two product families of steering columns of thyssenkrupp Presta France is then carried out to give a first industrial evaluation of the proposed approach. \u00a9 2017 The Authors. Published by Elsevier B.V. Peer-review under responsibility of the scientific committee of the 28th CIRP Design Conference 2018. Keywords: Assembly; Design method; Family identification1. Introduction Due to the fast development in the domain of communication and an ongoing trend of digitization anddigitalization, manufacturing enterprises are facing importantchallenges in today\u2019s market environments: a continuingtendency towards reduction of product development times andshortened product lifecycles. In addition, there is an increasingdemand of customization, being at the same time in a global competition with competitors all over the world. This trend, which is inducing the development from macro to micro markets, results in diminished lot sizes due to augmentingproduct varieties (high-volume to low-volume production) [1]. To cope with this augmenting variety as well as to be able toidentify possible optimization potentials in the existingproduction system, it is important to have a precise knowledgeof the product range and characteristics manufactured and/or assembled in this system. In this context, the main challenge inmodelling and analysis is now not only to cope with single products, a limited product range or existing product families,but also to be able to analyze and to compare products to definenew product families. It can be observed that classical existingproduct families are regrouped in function of clients or features.However, assembly oriented product families are hardly to find. On the product family level, products differ mainly in twomain characteristics: (i) the number of components and (ii) thetype of components (e.g. mechanical, electrical, electronical). Classical methodologies considering mainly single products or solitary, already existing product families analyze theproduct structure on a physical level (components level) which causes difficulties regarding an efficient definition andcomparison of different product families. Addressing this Procedia CIRP 91 (2020) 319\u20133242212-8271 \u00a9 2020 The Authors. Published by Elsevier B.V.This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/)Peer-review under responsibility of the scientific committee of the CIRP Design Conference 2020 10.1016/j.procir.2020.02.182\u00a9 2020 The Authors. Published by Elsevier B.V. This i  n open ccess article under the CC BY-NC-ND license (http://creativecommons.org/lic nses/by-nc-nd/4.0/)Peer-review under responsibility of the scientific committee of th  CIRP Design Conference 2020Available online at www.sciencedirect.comScienceDirect Procedia CIRP 00 (2020) 000\u2013000     www.elsevier.com/locate/procedia2212-8271 \u00a9 2020 The Authors. Published by Elsevier B.V.Peer-review under responsibility of the scientific committee of the CIRP Design Conference 2020.30th CIRP Design 2020 (CIRP Design 2020)A methodology for energy efficiency redesign of smart production systems Roberto Menghia*, Marta Rossia, Alessandra Papettia, Michele Germaniaa Department of Industrial Engineering and Mathematical Sciences - Universit\u00e0 Politecnica delle Marche,                                  Via Brecce Bianche, A cona 60131, Italy* Corresponding author. Tel.: +390712204880. E-mail address: r.menghi@univpm.itAbstractIn the recent years, many methodologies and tools to support the energy efficiency re-design of production systems have been developed,however, they do not investigate the real-time manufacturing process. In this paper, a methodology for energy efficiency re-design of production systems in a context of smart manufacturing is proposed. The continuous production-machine data collection with operator feedbacks enables the creation of a knowledge-based repository that provides useful support during the design of manufacturing systems. A case study in anautomotive sector company has allowed to implement the methodology and to assess its effectiveness.2020 he uthors. Published by lsevier . .Peer-review under responsibility of the scientific committee of the CIRP Design Conference.Keywords: Energy efficiency design; manufacturing systems; smart manufacturing; knowledge management.1. Introduction The industry sector is one of the major responsible for the resource and energy consumption today. In 2017, it consumed 8945 TWh, about 42% of the world total final electricity consumption and in the coming years, it will grow again considering the forecast growth of industrial production [1]. One of the main possible measures to contrast this trend is to intervene on energy efficiency and to improve production processes from the point of view of sustainability.Energy efficiency has gained increasing importance in recent decades and a large number of methodologies, tools, standards and regulations have been developed to promote the application of its principles inside industrial companies. The efficiency actions often consist in interventions on the production plant's equip ent with the ai  of reducing energy consumption without altering pro ction v lu es. However, the e ergy efficiency during pro uct use is largely dependent on the prod cts\u2019 desig  features, and corrective actions are ften limited due t  functioning paramet rs, which cannot be significantly modified. On the co trary, the first stages of design are crucial: the design characteristics are mostly defined by the end of the early design process and the decisions made at that time have the highest impact on defining the energy efficiency of the product. There are a number of methods and tools for the improvement of process energy efficiency duringthe first phases of design [2]. Nevertheless, these methods are mainly based on the energy-efficiency improvements guideline for machine components given in ISO standard 14955-1:2017 [3] and they usually do not consider the real-life phase of the product.In this paper, a methodology for energy efficiency design and/or re-design of production processes in a context of smart anufacturing is proposed, with the main object to develop a knowledge repository to support the design or re-design phase starting from the data provided by cyber-physical systems(CPS) implemented on the process. It employs the processes\u2019energy data together with the related problems and improvement strategies as in ut and returns the design rules as output. The connection between methodology and CPS allo s the designer to know the correlation betwee  desig  choices and their efficiency in ter s of energy consumption during the Available online at www.sciencedirect.comScienceDirect Procedia CIRP 00 (2020) 000\u2013000     www.elsevier.com/locate/procedia2212-8271 \u00a9 2020 The Authors. Published by Elsevier B.V.Peer-review under responsibility of the scientific committee of the CIRP Design Conference 2020.30th CIRP Design 2020 (CIRP Design 2020)A methodology for energy efficiency redesign of smart production systems Robert  Menghia*, M rta Rossia, Alessandra Papettia, Michele German aa Department of Industrial Engineering and Mathematical Sciences - Universit\u00e0 Politecnica delle Marche,                                  Via Brecce Bianche, Ancona 60131, Italy* Corresponding author. Tel.: +390712204880. E-mail address: r.menghi@univpm.itAbstractIn the recent years, many methodologies and tools to support the energy efficiency re-design of production systems have been developed,however, they do not investigate the real-time manufacturing process. In this paper, a methodology for energy efficiency re-design of production systems in a context of smart manufacturing is proposed. The continuous production-machine data collection with operator feedbacks enables the creation of a knowledge-based repository that provides useful support during the design of manufacturing systems. A case study in anautomotive sector company has allowed to implement the methodology and to assess its effectiveness.\u00a9 2020 The Authors. Published by Elsevier B.V.eer-revie  under responsibility of the scientific co ittee of the CIRP Design Conference.Keywords: Energy efficiency design; manufacturing systems; smart manufacturing; knowledge management.1. Introduction The industry sector is on  of th  major responsible for the resource and energy consumption today. In 2017, it consumed 8945 TWh, about 42% of the world total final lectricity consumption and in the coming years, it will grow again considering the forecast growth of industrial production [1]. One of the main possible measures to contrast this trend is to intervene on energy efficiency and to improve production processes from the point of view of sustainability.Energy efficiency has gained increasing importance in recent decades and a large number of methodologies, tools, standards and regulations have been developed to promote the application of its principles inside industrial companies. The efficiency actions often consist in interventions on the production plant's equipment with the aim of reducing energy consumption without altering production volumes. However, the energy efficiency during product use is largely dependent on the products\u2019 design features, and corrective actions are often limited due to functioning parameters, which cannot be significantly modified. On the contrary, the first stages of design are crucial: the design characteristics are mostly defined by the end of the early design process and the decisions made at that time have the highest impact on defining the energy efficiency of the product. There are a number of methods and tools for the improvement of process energy efficiency duringthe first phases of design [2]. Nevertheless, these methods are mainly based on the energy-efficiency improvements guideline for machine components given in ISO standard 14955-1:2017 [3] and they usually do not consider the real-life phase of the product.In this paper, a methodology for energy efficiency design and/or re-design of production processes in a context of smart manufacturing is proposed, with the main object to develop a knowledge repository to support the design or re-design phase starting from the data provided by cyber-physical systems(CPS) implemented on the process. It employs the processes\u2019energy data together with the related problems and improvement strategies as input and returns the design rules as output. The connection between methodology and CPS allows the designer to know the correlation between design choices and their efficiency in terms of energy consumption during the 320 Roberto Menghi  et al. / Procedia CIRP 91 (2020) 319\u20133242 Author name / Procedia CIRP 00 (2020) 000\u2013000use phase. In this way, designers are supported in the modification or redesigning of a component or a process with the aim to increase its energy efficiency. The knowledge-based repository is continuously updated by collecting data and user feedbacks coming from the companies that are using machines. The methodology has been implemented and validated on a production line for automotive components on which the resources value mapping (RVM) tool [4] has been applied. It used the tool's outputs as input, that is, information on energy consumption and the inefficiencies of the production process. The information has been elaborated and then, a guideline database has been defined to help designers in increasing energy efficiency of manufacturing process.2. Research background Several methods for the improvement of products under energetic impacts in design phase have been developed. They deal with the characterization of the energetic efficiency of a product (i.e. single machine tools or production lines) or process during the use phase. These methods focus a) on the acquisition of the product's energy features and b) on the analysis of energy problems with the implementation of energy efficiency improvement measures [2]. The first group identifies the factors that influence energy consumption through instantaneous measurements or by modelling and simulating the use phase [5]. The analyzed parameters concern the single machine (e.g., working speed and depth, operating states and their duration, etc.) while the process as a whole is often not analyzed. The other topic is the product's energy analysis and finding out where the energy problem is. The assessments are carried out by changing the value of factors and observing the impact [6], by energy benchmarking [7] or by the systematic method given in the ISO standard 14955-1: 2017 for machine tools [3]. Although there are many supporting methods, they are mainly focused on the redesign of individual machine tools and they usually do not analyze the real-time production process. They use limited energy data from short monitoring and do not take into account feedbacks from end users.Furthermore, in the past few years, digital technologies have spread more and more into manufacturing and production processes leading to the statement of a new model defined 'Smart Manufacturing' or 'Industry 4.0'. One of the key technologies are cyber-physical systems (CPS). They are \"systems of collaborating computational entities which are in intensive connection with its on-going processes, providing and using, at the same time, data-accessing and data-processing services available on the Internet\" [8]. CPS are able to acquire information from the surrounding environment, act autonomously, communicate with other elements of the system and respond to internal and external changes. In this model, the physical world of industrial production merges with the digital world of information technology and all elements of the plant(i.e. systems, machines, objects, sensors, actuators and humanbeings) exchange their data [9]. Data analysis and management is a major challenge to improve the energy efficiency of the industry sector considering that it is estimated that only 1% of existing data is analyzed [10]. Several methods and tools for energy management in smart production processes have been developed [11]. However, the researchers' efforts are often focused on finding support methodologies for the energy manager, plant manager and process manager, rather than for the designer. The latest literature reviews on this topic showedthat the main focuses are on the development of methods to help production planning [12], methods for the energy assessment and the identification of process energy inefficiencies [13] and on the modelling and analysis of production systems [14,15]. Production data is often only used to eliminate inefficiencies and optimize the manufacturing process by the stakeholders of the production. Usually, the design departments are not involved in this data exchange, thus preventing the creation or updating of company knowledge to be used during design process.With the term \u201cknowledge\u201d we can collect several meanings according to different viewpoints, i.e. contextual information, framed experience, expert\u2019s experience [16], but also organizational culture, skills, reputation, intuition, and codified theory that influences human behavior and thought [17]. When knowledge is organized and structured in order to be reused, positive effects are observed on firm\u2019s economy [18]. Knowledge management represents in fact the process toacquire, design, manage and share knowledge within anorganization to achieve better performance such as reduced costly rework, faster work and use of best practices [19,20].Many studies have faced the importance of knowledgemanagement on organizational outcomes, such asorganizational learning, innovation, product quality, besides creative, financial, economic and organizational performance[21,22,23,24]. However, the interesting review conducted by Abubakar et al. [25] observes there what is lacking in the literature and practice of knowledge management and organizational performance is a sound judgment and research on the influences of decision-making style on the processes and enablers of knowledge management on organizational performance. Yeh, Lai, and Ho [26] noted that all those systems which allows organizations in developing, stimulating, creating, sharing and protecting knowledge can be considered as a knowledge management enablers. In the context of knowledge related to design, several methodologies, framework and tools have been developed for product design, in order to support designers in their choices. All the sectors are faced by these studies, some examples are the knowledge management framework developed by Mchareke et al. [27]suitable for concurrent design, or frameworks and tools developed for the aerospace design sector [28], for the mechatronic sector [29], for the next generation information appliances [30], for creative conceptual design of multi-disciplinary systems [31]. On the other hand, researchers also identified that there is a lack of data management approaches for improving the transfer of knowledge between manufacturing and design in complex industry setting, due to limitations in the interoperability [28] of the involved systems.Summarizing, three are the main outcomes of the analysis of the research background. Although there are some methodologies to support the energy efficiency re-design of production systems, they do not investigate the real-time manufacturing process, but only the machine tools and its components individually. They do not exploit the possibility Author name / Procedia CIRP 00 (2020) 000\u2013000 3within the context of Industry 4.0 to collect and store a lot of energy data related to process. Finally, these methodologies do not allow the knowledge creation and sharing during design phase. The methods are often designed for plant managers and energy managers and do not involve designers. Starting from these outcomes, the authors have developed the following research questions: how is it possible to support machine design in order to increase their energy efficiency? How is it possible to support data exchange and knowledge creation between production processes and design phase? In order to answer to these questions, the following methodology has been proposed to support process designer in the development of energy efficiency machines and lines.3. MethodologyThe proposed methodology takes place in the context of Industry 4.0, based on CPS implemented on processes, and ableto catch process data, to manage and interpret them. Figure 1 identifies the data exchange process of the methodology. The possibility to derive from CPS process data, to identify them thanks to elaborating systems and to then correlate energy problems with possible solution strategies, gives the possibility to dispose of a high quantity of data, with a very high value for the design process.Fig. 1. Energy process data flowInformation on energy process\u2019 data at multiple levels (e.g. machine, line, plant), related problems (e.g. failure, anomaly) and associated improvement or solving strategies represent for designers a set of useful information able to support them during the design and/or re-design phase of production machine, lines or plant, with the objective to improve theirenergy efficiency. The focus of the proposed methodology is the creation of knowledge, its efficient storing and successive reuse to support design phase and to reduce time to solve recurrent problems. Its aim is therefore to support process designers in energy efficiency design choices yet during the early phase of design, by collecting and making available data, rules, guidelines and suggestions that integrate information onseveral levels (e.g. machines working data, process parameter, failure, maintenance information). Making a mathematical parallelism, the first step is to identify which functions characterized the methodology and how they are satisfied. A function is defined by three elements: a domain, a codomain and a law f(x), which links to each element of the domain, one element of codomain. In this methodology, the domain is represented by a repository in which machine, line and plant information are contained. This information can derive from direct measurements of process parameters and therefore produced by plant manager, or from literature and produced by experts. In the first case, the domain of the function has a strictly correlation with the CPSimplemented in the process, which allows to collect energy related information on different levels of the process and with analytic modules, algorithms and procedures which allow to associate energy information with the related reasons, corrective and/or solution strategies. In the case information data derive from literature, the domain contains recurrent situations for machine, line or plant which can occur during their functioning and related solution strategies. The function to fulfill is to support the design/redesign of energy efficiency machines and/or lines. The possibility for designers to consult material on these different levels, allowsthem to be aware of recurrent energy related problems, solution strategies and corrective actions. It permits to reflect on improvement strategies and be guided in their application yet in the design phase, avoiding the generation of those problems. This function allows to obtain the desired output (codomain): design rules, suggestions and energy process knowledge used by designers with a double effect: increase their knowledge about practical and use-related energy problems, be supported in design choice reducing energy inefficiency. This main function is divided into two sub-functions: (i) data collectionand storing and (ii) manage data, use and reuse.The first one concerns the import of energy machine, line, plant information from the CPS, IoT technology and analytics modules into a structured database (DB), where materials are collected, through the implementation of storing algorithms, according to several attributes:\u2022 Machine, plant or line which are referred;\u2022 Typology of data (e.g. energy information, energy problems, improvement/solution strategies);\u2022 Typology of energy problems (e.g. wait, maintenance, failure);\u2022 Typology of improvement/solution strategies (e.g. design solution, on-site actions, general suggestions);\u2022 Objective of improvement/solution strategies;\u2022 Source (from direct measures or literature);\u2022 Attachment (details on data, problems, and solution/improvement strategies).The second sub-function concerns the way the material collected and structured in the DB are shown to designers in order to provide them support in design/redesign phase, to be simply used, reused and if necessary customized. Four main options are supposed, according to the objective designer want to reach:\u2022 Consultation of material for training purpose: designers can access the DB and query for all those materials retrieved from literature and on-site data which contains typical energy problems and related strategies in order to be more conscious about a specific problematic and possible solutions;\u2022 Consultation of material starting from a machine or line: designers can access the DB and query for all those materials related to a specific aspect in order to go deepen of recurrent energy problems and related strategies;\u2022 Consultation of material starting from a problem: designers can access the DB and query for all those materials related to a specific problem and consult strategies related to the  Roberto Menghi  et al. / Procedia CIRP 91 (2020) 319\u2013324 3212 Author name / Procedia CIRP 00 (2020) 000\u2013000use phase. In this way, designers are supported in the modification or redesigning of a component or a process with the aim to increase its energy efficiency. The knowledge-based repository is continuously updated by collecting data and user feedbacks coming from the companies that are using machines. The methodology has been implemented and validated on a production line for automotive components on which the resources value mapping (RVM) tool [4] has been applied. It used the tool's outputs as input, that is, information on energy consumption and the inefficiencies of the production process. The information has been elaborated and then, a guideline database has been defined to help designers in increasing energy efficiency of manufacturing process.2. Research background Several methods for the improvement of products under energetic impacts in design phase have been developed. They deal with the characterization of the energetic efficiency of a product (i.e. single machine tools or production lines) or process during the use phase. These methods focus a) on the acquisition of the product's energy features and b) on the analysis of energy problems with the implementation of energy efficiency improvement measures [2]. The first group identifies the factors that influence energy consumption through instantaneous measurements or by modelling and simulating the use phase [5]. The analyzed parameters concern the single machine (e.g., working speed and depth, operating states and their duration, etc.) while the process as a whole is often not analyzed. The other topic is the product's energy analysis and finding out where the energy problem is. The assessments are carried out by changing the value of factors and observing the impact [6], by energy benchmarking [7] or by the systematic method given in the ISO standard 14955-1: 2017 for machine tools [3]. Although there are many supporting methods, they are mainly focused on the redesign of individual machine tools and they usually do not analyze the real-time production process. They use limited energy data from short monitoring and do not take into account feedbacks from end users.Furthermore, in the past few years, digital technologies have spread more and more into manufacturing and production processes leading to the statement of a new model defined 'Smart Manufacturing' or 'Industry 4.0'. One of the key technologies are cyber-physical systems (CPS). They are \"systems of collaborating computational entities which are in intensive connection with its on-going processes, providing and using, at the same time, data-accessing and data-processing services available on the Internet\" [8]. CPS are able to acquire information from the surrounding environment, act autonomously, communicate with other elements of the system and respond to internal and external changes. In this model, the physical world of industrial production merges with the digital world of information technology and all elements of the plant(i.e. systems, machines, objects, sensors, actuators and humanbeings) exchange their data [9]. Data analysis and management is a major challenge to improve the energy efficiency of the industry sector considering that it is estimated that only 1% of existing data is analyzed [10]. Several methods and tools for energy management in smart production processes have been developed [11]. However, the researchers' efforts are often focused on finding support methodologies for the energy manager, plant manager and process manager, rather than for the designer. The latest literature reviews on this topic showedthat the main focuses are on the development of methods to help production planning [12], methods for the energy assessment and the identification of process energy inefficiencies [13] and on the modelling and analysis of production systems [14,15]. Production data is often only used to eliminate inefficiencies and optimize the manufacturing process by the stakeholders of the production. Usually, the design departments are not involved in this data exchange, thus preventing the creation or updating of company knowledge to be used during design process.With the term \u201cknowledge\u201d we can collect several meanings according to different viewpoints, i.e. contextual information, framed experience, expert\u2019s experience [16], but also organizational culture, skills, reputation, intuition, and codified theory that influences human behavior and thought [17]. When knowledge is organized and structured in order to be reused, positive effects are observed on firm\u2019s economy [18]. Knowledge management represents in fact the process toacquire, design, manage and share knowledge within anorganization to achieve better performance such as reduced costly rework, faster work and use of best practices [19,20].Many studies have faced the importance of knowledgemanagement on organizational outcomes, such asorganizational learning, innovation, product quality, besides creative, financial, economic and organizational performance[21,22,23,24]. However, the interesting review conducted by Abubakar et al. [25] observes there what is lacking in the literature and practice of knowledge management and organizational performance is a sound judgment and research on the influences of decision-making style on the processes and enablers of knowledge management on organizational performance. Yeh, Lai, and Ho [26] noted that all those systems which allows organizations in developing, stimulating, creating, sharing and protecting knowledge can be considered as a knowledge management enablers. In the context of knowledge related to design, several methodologies, framework and tools have been developed for product design, in order to support designers in their choices. All the sectors are faced by these studies, some examples are the knowledge management framework developed by Mchareke et al. [27]suitable for concurrent design, or frameworks and tools developed for the aerospace design sector [28], for the mechatronic sector [29], for the next generation information appliances [30], for creative conceptual design of multi-disciplinary systems [31]. On the other hand, researchers also identified that there is a lack of data management approaches for improving the transfer of knowledge between manufacturing and design in complex industry setting, due to limitations in the interoperability [28] of the involved systems.Summarizing, three are the main outcomes of the analysis of the research background. Although there are some methodologies to support the energy efficiency re-design of production systems, they do not investigate the real-time manufacturing process, but only the machine tools and its components individually. They do not exploit the possibility Author name / Procedia CIRP 00 (2020) 000\u2013000 3within the context of Industry 4.0 to collect and store a lot of energy data related to process. Finally, these methodologies do not allow the knowledge creation and sharing during design phase. The methods are often designed for plant managers and energy managers and do not involve designers. Starting from these outcomes, the authors have developed the following research questions: how is it possible to support machine design in order to increase their energy efficiency? How is it possible to support data exchange and knowledge creation between production processes and design phase? In order to answer to these questions, the following methodology has been proposed to support process designer in the development of energy efficiency machines and lines.3. MethodologyThe proposed methodology takes place in the context of Industry 4.0, based on CPS implemented on processes, and ableto catch process data, to manage and interpret them. Figure 1 identifies the data exchange process of the methodology. The possibility to derive from CPS process data, to identify them thanks to elaborating systems and to then correlate energy problems with possible solution strategies, gives the possibility to dispose of a high quantity of data, with a very high value for the design process.Fig. 1. Energy process data flowInformation on energy process\u2019 data at multiple levels (e.g. machine, line, plant), related problems (e.g. failure, anomaly) and associated improvement or solving strategies represent for designers a set of useful information able to support them during the design and/or re-design phase of production machine, lines or plant, with the objective to improve theirenergy efficiency. The focus of the proposed methodology is the creation of knowledge, its efficient storing and successive reuse to support design phase and to reduce time to solve recurrent problems. Its aim is therefore to support process designers in energy efficiency design choices yet during the early phase of design, by collecting and making available data, rules, guidelines and suggestions that integrate information onseveral levels (e.g. machines working data, process parameter, failure, maintenance information). Making a mathematical parallelism, the first step is to identify which functions characterized the methodology and how they are satisfied. A function is defined by three elements: a domain, a codomain and a law f(x), which links to each element of the domain, one element of codomain. In this methodology, the domain is represented by a repository in which machine, line and plant information are contained. This information can derive from direct measurements of process parameters and therefore produced by plant manager, or from literature and produced by experts. In the first case, the domain of the function has a strictly correlation with the CPSimplemented in the process, which allows to collect energy related information on different levels of the process and with analytic modules, algorithms and procedures which allow to associate energy information with the related reasons, corrective and/or solution strategies. In the case information data derive from literature, the domain contains recurrent situations for machine, line or plant which can occur during their functioning and related solution strategies. The function to fulfill is to support the design/redesign of energy efficiency machines and/or lines. The possibility for designers to consult material on these different levels, allowsthem to be aware of recurrent energy related problems, solution strategies and corrective actions. It permits to reflect on improvement strategies and be guided in their application yet in the design phase, avoiding the generation of those problems. This function allows to obtain the desired output (codomain): design rules, suggestions and energy process knowledge used by designers with a double effect: increase their knowledge about practical and use-related energy problems, be supported in design choice reducing energy inefficiency. This main function is divided into two sub-functions: (i) data collectionand storing and (ii) manage data, use and reuse.The first one concerns the import of energy machine, line, plant information from the CPS, IoT technology and analytics modules into a structured database (DB), where materials are collected, through the implementation of storing algorithms, according to several attributes:\u2022 Machine, plant or line which are referred;\u2022 Typology of data (e.g. energy information, energy problems, improvement/solution strategies);\u2022 Typology of energy problems (e.g. wait, maintenance, failure);\u2022 Typology of improvement/solution strategies (e.g. design solution, on-site actions, general suggestions);\u2022 Objective of improvement/solution strategies;\u2022 Source (from direct measures or literature);\u2022 Attachment (details on data, problems, and solution/improvement strategies).The second sub-function concerns the way the material collected and structured in the DB are shown to designers in order to provide them support in design/redesign phase, to be simply used, reused and if necessary customized. Four main options are supposed, according to the objective designer want to reach:\u2022 Consultation of material for training purpose: designers can access the DB and query for all those materials retrieved from literature and on-site data which contains typical energy problems and related strategies in order to be more conscious about a specific problematic and possible solutions;\u2022 Consultation of material starting from a machine or line: designers can access the DB and query for all those materials related to a specific aspect in order to go deepen of recurrent energy problems and related strategies;\u2022 Consultation of material starting from a problem: designers can access the DB and query for all those materials related to a specific problem and consult strategies related to the 322 Roberto Menghi  et al. / Procedia CIRP 91 (2020) 319\u20133244 Author name / Procedia CIRP 00 (2020) 000\u2013000same criticality applied on several levels and different typology. In this way designers can observe how a specific problem is faced in similar or dissimilar cases and identify the best strategies for its case;\u2022 Customization of material: designers can access the DB and insert/update solution strategies and design rules according to their direct design experiences. Figure 2 provides a schematic overview of the methodological flow applied in a smart manufacturing context.Energy process data is transferred from CPS and IoT technology installed in the plant toward the repository (in the form of graphs, tables, and texts to store process problems, inefficiency and errors). Then, they are analyzed by plant manager to identify and apply in-loco solution strategies. The identified solution strategies are saved into the repository, according to the attributes defined by the methodology. The data collection and storing allow to correlate and make accessible the quantitative data on energy consumption with the qualitative data on corrective actions and inefficiencies. All the data collected in the repository are available to plant designers which can consult them with multiple objectives previously defined. Designers are supported in the design for energy efficiency thanks to process energy data and can derive design rules for the resolution of future and recurrent problems.Fig. 2. Methodology flow4. Case studyThe methodology has been experimented in collaboration with a manufacturing company of equipment and automated complex system for assembly. In order to achieve first results, it has been implemented in a semi-automatic assembly line for the production of automotive electromechanical components.The production line assembles three different types of car locks and consists of ten machining workstations connected by a conveyor belt and several handling robots (Figure 3). Fiveworkstations are manual while the rest are fully automatic (i.e. W01, W07, W08, W09 and W10). The assembly line represents a CPS that allows to monitor, analyze and manage the entire production process. The system is equipped with several energy meters and various sensors to monitor the machines (i.e. optical, vibration, temperature and noise sensors). These devices provided continuous flow of information about states of the equipment and the average power consumption with a frequency of 1 second. It also collects the data provided by the control system of the process parameters (i.e. setting of the machines, times, quantities, maintenance interventions). Data is gathered in a cloud data center together with the information from the company's manufacturing execution system (MES) and the enterprise resource planning (ERP). The system is supervised by the RVM tool [4] which analyses the production process from the point of view of energy efficiency. The tool has been employed by the energy manager and the plantmanager to identify and eliminate the inefficiencies. Fig. 3. Layout of the semi-automatic assembly line.The identified energy problems were concentrated on the workstations W02, W07 and W08 respectively for rolling I, rolling II and resination. These operations have shown inefficiencies caused by the incorrect management of the machine stand-by mode and the inappropriate parameter setting. In workstations W02 and W07, the tool is always running even if it is not working. In the W02, the rolling occurs for about 2 seconds while the waiting time, with the tool on, is about 6 sec. In the W07, the machining and stand-by time is the same and are approximately 3.5 sec. Moreover, in the W07 station there is a extractor fan which remains always on and it is oversized for the task performed. In the W08 workstation, the inefficiencies are linked to the UV lamp and the blower. They are employed to dry the resin and they are the most energy-intensive devices.The information of identified energy problems are stored in the knowledge-based repository and recorded according to the number and frequency of occurrences, the type of processed product  and the associated energy consumption.Based on the identified inefficiencies, the plant manager together with the energy manager determine the best corrective actions to be implemented. The efficiency measures are then classified in the repository according to specific attributes for this family of semi-automatic assembly lines. The cataloguing is carried out based on the type and object of the corrective measure, the processing phase, the product type and the collected quantitative data on the improvement of energy efficiency.Author name / Procedia CIRP 00 (2020) 000\u2013000 5The catalogued information on the energy problems and the improvement measures is collected in the database and then used to redesign the production line. In detail, the plant designer examines all the collected data, uses them during redesign and derives redesign guidelines. Fifteen guidelines have been created from the data analysis of the three-month production monitoring. They are structured in the form of table and classified according to several attributes: name, description, product family, object, source, type, achievable efficiency improvement and attachments. The attribute 'product family' specifies to which type of corrective action the guidelines is referred. For example, the guidelines that optimize the management of production and operations areclassified as 'Components management', while the guidelines that analyze tasks and manufacturing processes in 'operations', and finally those that concern individual devices in 'tools'. The 'object' attribute connects guidelines to specific module of theproduct (e.g. lights, specific tool, setup).The guidelines created during the redesign process and stored in the DB can provide support for future and similar recurrent design problems. Table 1 provides an extract from the identified guidelines for the production line investigated in the case study. Table 1. Example of design guidelinesProduct familyDesign Guidelines Efficiency improvementComponentsManagementConsider the use of a controller system to operate equipment only when needed.Schedule equipment shutdown when not in use, during breaks and reduce operating time.Upgrade the programmable controller to improve process flexibility+16%+16%+9%Operation Replace the technology of the most energy-intensive operations with more efficient technologies.+22%Tool Consider the replacement of components with energy-efficient tools.Redesign the size and capacity equipment to optimize their use.+10%+7%As regards the guidelines related to the component management, the designer should redesign the stand-by phases with the aim of turning off the tool during breaks or when not used. Alternatively, a on-machine controllers network should be implemented to activate the tool only when really needed avoiding energy wastage. The implementation of these guidelines would improve efficiency by 16%. Furthermore, the programmable controller should be updated to improve process flexibility. The identified energy problems are related to the inability to modify the processing set-ups. In the rolling workstations, the products are processed with the same machining configurations even if they require different processing sequences (i.e. two products require six rollings while one requires only three). In this case, the achievable efficiency improvement is 9%.Regarding the guidelines family related to the tools, theysuggest replacing equipment with more efficient machines. In detail, the electric motors of the most energy-intensive instruments (i.e. the rolling tool and the extractor motor) should be replaced by high efficiency motors complying with the international IE3 or higher standard. In addition, the designer should consider the possibility of adapting the tool to the needs of the machining activity. To prefer tools that can modulate speed and intensity according to the task. The implementation of the first guideline would achieve an efficiency improvement of 10% while the second of 7%.Finally, as regards the most energy-intensive manufacturing tasks, it is necessary to redesign them with new technologies and machines that allow to reduce energy consumption and increase efficiency. The replacement of the UV lamp with Led UV technology will improve efficiency by 22%.5. Discussion and conclusion This paper presents a methodology to support designers in the design or redesign of production systems in a smart manufacturing context. Through the collection of process data in a structured database, it supports designers throughguidelines, and allows them to acquire gradually knowledge to improve the process's energy efficiency. Guidelines are derived by the analysis of energy data collected at different levels of manufacturing processes, plant or lines. The implementation in the case study has highlighted how the methodology is helpful for designers to create a shared knowledge. The use-phase data is collected together with the design rules in an accessible database. In this way, knowledge can be transferred to all other designers and preserved over the time. Knowledge creation processes also enhance design process efficiency through the reuse of helpful information.As emerged from the research context, the main novelties of the proposed methodology are the ability to elaborate real-time energy data related to the process and use them to create design guidelines. Knowledge management allows to catalogue the information provided by the CPS and supports the designer in creating recommendations for the redesign phase.Despite the first encouraging results, the methodology needs to be further investigated to increase its strengths and eliminate the main weaknesses. In particular, the methodology could be improved by considering maintenance data together with energy data. This allows the designer to comprehend the relationships between design choices and frequently occurring tool failures or breakages. It should also include an economic assessment. The introduction of such considerations enables the designer to correctly evaluate costs and benefits of the implementation of each guideline.The main limitation of the methodology is represented by the lack of attitude of companies to share their data. In fact, in order to be fully implemented, it is required the sharing of energy data of the production line between the producer and the end user. Data from the smart factory or CPS systems should be in fact shared with the machine manufacturer or process designer. This limit can be overcome by introducing discounts or favorable conditions to the buyer and ensuring confidential and anonymous data exchange.In the next future, other machine tool families will beinvolved in the test phase, to collect more and more feedbacks and make the methodology the most near to company\u2019s needs.  Roberto Menghi  et al. / Procedia CIRP 91 (2020) 319\u2013324 3234 Author name / Procedia CIRP 00 (2020) 000\u2013000same criticality applied on several levels and different typology. In this way designers can observe how a specific problem is faced in similar or dissimilar cases and identify the best strategies for its case;\u2022 Customization of material: designers can access the DB and insert/update solution strategies and design rules according to their direct design experiences. Figure 2 provides a schematic overview of the methodological flow applied in a smart manufacturing context.Energy process data is transferred from CPS and IoT technology installed in the plant toward the repository (in the form of graphs, tables, and texts to store process problems, inefficiency and errors). Then, they are analyzed by plant manager to identify and apply in-loco solution strategies. The identified solution strategies are saved into the repository, according to the attributes defined by the methodology. The data collection and storing allow to correlate and make accessible the quantitative data on energy consumption with the qualitative data on corrective actions and inefficiencies. All the data collected in the repository are available to plant designers which can consult them with multiple objectives previously defined. Designers are supported in the design for energy efficiency thanks to process energy data and can derive design rules for the resolution of future and recurrent problems.Fig. 2. Methodology flow4. Case studyThe methodology has been experimented in collaboration with a manufacturing company of equipment and automated complex system for assembly. In order to achieve first results, it has been implemented in a semi-automatic assembly line for the production of automotive electromechanical components.The production line assembles three different types of car locks and consists of ten machining workstations connected by a conveyor belt and several handling robots (Figure 3). Fiveworkstations are manual while the rest are fully automatic (i.e. W01, W07, W08, W09 and W10). The assembly line represents a CPS that allows to monitor, analyze and manage the entire production process. The system is equipped with several energy meters and various sensors to monitor the machines (i.e. optical, vibration, temperature and noise sensors). These devices provided continuous flow of information about states of the equipment and the average power consumption with a frequency of 1 second. It also collects the data provided by the control system of the process parameters (i.e. setting of the machines, times, quantities, maintenance interventions). Data is gathered in a cloud data center together with the information from the company's manufacturing execution system (MES) and the enterprise resource planning (ERP). The system is supervised by the RVM tool [4] which analyses the production process from the point of view of energy efficiency. The tool has been employed by the energy manager and the plantmanager to identify and eliminate the inefficiencies. Fig. 3. Layout of the semi-automatic assembly line.The identified energy problems were concentrated on the workstations W02, W07 and W08 respectively for rolling I, rolling II and resination. These operations have shown inefficiencies caused by the incorrect management of the machine stand-by mode and the inappropriate parameter setting. In workstations W02 and W07, the tool is always running even if it is not working. In the W02, the rolling occurs for about 2 seconds while the waiting time, with the tool on, is about 6 sec. In the W07, the machining and stand-by time is the same and are approximately 3.5 sec. Moreover, in the W07 station there is a extractor fan which remains always on and it is oversized for the task performed. In the W08 workstation, the inefficiencies are linked to the UV lamp and the blower. They are employed to dry the resin and they are the most energy-intensive devices.The information of identified energy problems are stored in the knowledge-based repository and recorded according to the number and frequency of occurrences, the type of processed product  and the associated energy consumption.Based on the identified inefficiencies, the plant manager together with the energy manager determine the best corrective actions to be implemented. The efficiency measures are then classified in the repository according to specific attributes for this family of semi-automatic assembly lines. The cataloguing is carried out based on the type and object of the corrective measure, the processing phase, the product type and the collected quantitative data on the improvement of energy efficiency.Author name / Procedia CIRP 00 (2020) 000\u2013000 5The catalogued information on the energy problems and the improvement measures is collected in the database and then used to redesign the production line. In detail, the plant designer examines all the collected data, uses them during redesign and derives redesign guidelines. Fifteen guidelines have been created from the data analysis of the three-month production monitoring. They are structured in the form of table and classified according to several attributes: name, description, product family, object, source, type, achievable efficiency improvement and attachments. The attribute 'product family' specifies to which type of corrective action the guidelines is referred. For example, the guidelines that optimize the management of production and operations areclassified as 'Components management', while the guidelines that analyze tasks and manufacturing processes in 'operations', and finally those that concern individual devices in 'tools'. The 'object' attribute connects guidelines to specific module of theproduct (e.g. lights, specific tool, setup).The guidelines created during the redesign process and stored in the DB can provide support for future and similar recurrent design problems. Table 1 provides an extract from the identified guidelines for the production line investigated in the case study. Table 1. Example of design guidelinesProduct familyDesign Guidelines Efficiency improvementComponentsManagementConsider the use of a controller system to operate equipment only when needed.Schedule equipment shutdown when not in use, during breaks and reduce operating time.Upgrade the programmable controller to improve process flexibility+16%+16%+9%Operation Replace the technology of the most energy-intensive operations with more efficient technologies.+22%Tool Consider the replacement of components with energy-efficient tools.Redesign the size and capacity equipment to optimize their use.+10%+7%As regards the guidelines related to the component management, the designer should redesign the stand-by phases with the aim of turning off the tool during breaks or when not used. Alternatively, a on-machine controllers network should be implemented to activate the tool only when really needed avoiding energy wastage. The implementation of these guidelines would improve efficiency by 16%. Furthermore, the programmable controller should be updated to improve process flexibility. The identified energy problems are related to the inability to modify the processing set-ups. In the rolling workstations, the products are processed with the same machining configurations even if they require different processing sequences (i.e. two products require six rollings while one requires only three). In this case, the achievable efficiency improvement is 9%.Regarding the guidelines family related to the tools, theysuggest replacing equipment with more efficient machines. In detail, the electric motors of the most energy-intensive instruments (i.e. the rolling tool and the extractor motor) should be replaced by high efficiency motors complying with the international IE3 or higher standard. In addition, the designer should consider the possibility of adapting the tool to the needs of the machining activity. To prefer tools that can modulate speed and intensity according to the task. The implementation of the first guideline would achieve an efficiency improvement of 10% while the second of 7%.Finally, as regards the most energy-intensive manufacturing tasks, it is necessary to redesign them with new technologies and machines that allow to reduce energy consumption and increase efficiency. The replacement of the UV lamp with Led UV technology will improve efficiency by 22%.5. Discussion and conclusion This paper presents a methodology to support designers in the design or redesign of production systems in a smart manufacturing context. Through the collection of process data in a structured database, it supports designers throughguidelines, and allows them to acquire gradually knowledge to improve the process's energy efficiency. Guidelines are derived by the analysis of energy data collected at different levels of manufacturing processes, plant or lines. The implementation in the case study has highlighted how the methodology is helpful for designers to create a shared knowledge. The use-phase data is collected together with the design rules in an accessible database. In this way, knowledge can be transferred to all other designers and preserved over the time. Knowledge creation processes also enhance design process efficiency through the reuse of helpful information.As emerged from the research context, the main novelties of the proposed methodology are the ability to elaborate real-time energy data related to the process and use them to create design guidelines. Knowledge management allows to catalogue the information provided by the CPS and supports the designer in creating recommendations for the redesign phase.Despite the first encouraging results, the methodology needs to be further investigated to increase its strengths and eliminate the main weaknesses. In particular, the methodology could be improved by considering maintenance data together with energy data. This allows the designer to comprehend the relationships between design choices and frequently occurring tool failures or breakages. It should also include an economic assessment. The introduction of such considerations enables the designer to correctly evaluate costs and benefits of the implementation of each guideline.The main limitation of the methodology is represented by the lack of attitude of companies to share their data. In fact, in order to be fully implemented, it is required the sharing of energy data of the production line between the producer and the end user. Data from the smart factory or CPS systems should be in fact shared with the machine manufacturer or process designer. This limit can be overcome by introducing discounts or favorable conditions to the buyer and ensuring confidential and anonymous data exchange.In the next future, other machine tool families will beinvolved in the test phase, to collect more and more feedbacks and make the methodology the most near to company\u2019s needs. 324 Roberto Menghi  et al. / Procedia CIRP 91 (2020) 319\u20133246 Author name / Procedia CIRP 00 (2020) 000\u2013000Additional efforts should be also put to implement it in a software tool to allow the easier and guided application.References[1] International Energy Agency. Key world energy statistics. Paris: International Energy Agency, 2017.[2] Li L, Suiran Y, Jing T. Design for energy efficiency in early stages: A top-down method for new product development. Journal of cleaner production 2019; 224:175-187.[3] International Organization for Standardization (ISO). Machine tools \u2014Environmental evaluation of machine tools \u2014 Part 1: Design methodology for energy-efficient machine tools. 2017.[4] Papetti A, Menghi R, Di Domizio G, Germani M, Marconi M.  Resources value mapping: A method to assess the resource efficiency of manufacturing systems. Applied Energy, 249; 2019; 326-342.[5] Zhou L, Li J, Li F, Meng Q, Li J, Xu X. Energy consumption model and energy efficiency of machine tools: a comprehensive literature review. Journal of Cleaner Production 2016, 112, 3721-3734. [6] Peng T, Xu X, Wang L. A novel energy demand modelling approach for CNC machining based on function blocks. Journal of Manufacturing Systems 2014; 33(1):196-208.[7] Cai W, Liu F, Xie J, Liu P, Tuo J. A tool for assessing the energy demand and efficiency of machining systems: energy benchmarking. Energy2017; 138:332-347.[8] Monostori L, K\u00e1d\u00e1r B, Bauernhansl T, Kondoh S, Kumara S, Reinhart G, Sauer O, Schuh G, Sihn W, Ueda K. Cyber-physical systems in manufacturing. Cirp Annals 2016, 65(2), 621-641.[9] Herrmann C, Schmidt C, Kurle D, Blume S, Thiede S. Sustainability in manufacturing and factories of the future. International Journal of precision engineering and manufacturing-green technology 2014;1(4):283-292.[10] Nagasawa T, Pillay C, Beier G, Fritzsche K, Pougel F, Takama T, Bobashev I. Accelerating Clean Energy through Industry 4.0: Manufacturing the Next Revolution. A Report of the United Nations Industrial Development Organization. 2017.[11] May G, Stahl B, Taisch M, Kiritsis D. Energy management in manufacturing: From literature review to a conceptual framework. Journal of Cleaner Production 2017; 167:1464-1489.[12] Hu S, Liu F, He Y, Hu T. An on-line approach for energy efficiency monitoring of machine tools. Journal of cleaner production 2012; 27:133-140.[13] Menghi R, Papetti A, Germani M, Marconi M. Energy efficiency of manufacturing systems: A review of energy assessment methods and tools. Journal of Cleaner Production 2019; 118276.[14] Debnath KB, Mourshed M. Forecasting methods in energy planning models. Renewable and Sustainable Energy Reviews 2018, 88, 297-325.[15] Garwood TL, Hughes BR, Oates MR, O\u2019Connor D, Hughes R. A review of energy simulation tools for the manufacturing sector. Renewable and Sustainable Energy Reviews 2018, 81, 895-911.[16] Davenport TH, Klahr P. Managing customer support knowledge. California Management Review 1998; 40(3):195\u2013208.[17] Hall R, Andriani P. Managing knowledge associated with innovation. Journal of Business Research 2003; 56(2):145\u2013152[18] Du Plessis M. The role of knowledge management in innovation. Journal of Knowledge Management 2007; 11(4):20\u201329.[19] Nonaka I, Byosiere P, Borucki CC, Konno N. Organizational knowledge creation theory: A first comprehensive test. International BusinessReview 1994; 3(4):337\u2013351.[20] Pasternack BA, Viscio AJ. The Centerless Corporation: A Model for Tomorrow: Build organizations around people, knowledge, values and coherence, not just operations. Strategy and Business 1998, 10\u201321.[21] Adams FG, Graham KW. Integration, knowledge creation and B2B governance: The role of resource hierarchies in financial performance. Industrial Marketing Management 2017; 63:179\u2013191. [22] Brix J. Exploring knowledge creation processes as a source of organizational learning: A longitudinal case study of a public innovation project. Scandinavian Journal of Management 2017; 33(2):113\u2013127.[23] Vila LE, Cabrer B, Pav\u00eda JM. On the relationship between knowledge creation and economic performance. Technological and Economic Development of Economy 2015; 21(4):539\u2013556. [24] Li Y, Huang J, Tsai M. Entrepreneurial orientation and firm performance: The role of knowledge creation process. Industrial Marketing Management 2009; 38(4):440\u2013449.[25] Abubakar AM, Elrehail H, Alatailat MA, El\u00e7i A. Knowledge management, decision-making style and organizational performance. Journal of Innovation & Knowledge 2019; 4(2), 104-114.[26] Yeh YJ, Lai SQ, Ho CT. Knowledge management enablers: a case study. Industrial Management & Data Systems 2006; 106(6):793-810.[27] Mcharek M, Hammadi M, Azib T, Larouci C, Choley JY. Collaborative design process and product knowledge methodology for mechatronic systems. Computers in Industry 2019; 105:213-228. [28] El Souri M, Gao J, Simmonds C. Integrating Manufacturing Knowledge with Design Process to Improve Quality in the Aerospace Industry. Procedia CIRP 2019; 84:374-379. [29] Germani M, Mandolini M, Marconi M, Morbidoni A, Rossi M. A case-based reasoning approach to support the application of the eco-design guidelines. Procedia CIRP 2013; 81-86.[30] Park J. Developing a knowledge management system for storing and using the design knowledge acquired in the process of a user-centered design of the next generation information appliances. Design Studies 2011; 32(5):482-513. [31] Chen Y, Liu ZL, Xie YB. A knowledge-based framework for creative conceptual design of multi-disciplinary systems. Computer-Aided Design 2012; 44(2):146-153. ",
      "id": 148966529,
      "identifiers": [
        {
          "identifier": "589942171",
          "type": "CORE_ID"
        },
        {
          "identifier": "10.1016/j.procir.2020.02.182",
          "type": "DOI"
        },
        {
          "identifier": "oai:zenodo.org:87363",
          "type": "OAI_ID"
        }
      ],
      "title": "A methodology for energy efficiency redesign of smart production systems",
      "language": {
        "code": "en",
        "name": "English"
      },
      "magId": null,
      "oaiIds": [
        "oai:zenodo.org:87363"
      ],
      "publishedDate": "2020-01-01T00:00:00",
      "publisher": "",
      "pubmedId": null,
      "references": [],
      "sourceFulltextUrls": [
        "https://www.openaccessrepository.it/record/87363/files/fulltext.pdf"
      ],
      "updatedDate": "2023-10-30T20:31:38",
      "yearPublished": 2020,
      "journals": [],
      "links": [
        {
          "type": "download",
          "url": "https://core.ac.uk/download/589942171.pdf"
        },
        {
          "type": "reader",
          "url": "https://core.ac.uk/reader/589942171"
        },
        {
          "type": "thumbnail_m",
          "url": "https://core.ac.uk/image/589942171/large"
        },
        {
          "type": "thumbnail_l",
          "url": "https://core.ac.uk/image/589942171/large"
        },
        {
          "type": "display",
          "url": "https://core.ac.uk/works/148966529"
        }
      ]
    },
    {
      "acceptedDate": "2017-01-31T00:00:00",
      "arxivId": "1611.01226",
      "authors": [
        {
          "name": "H\u00e4yrynen, Teppo"
        },
        {
          "name": "Oksanen, Jani"
        },
        {
          "name": "Partanen, Mikko"
        },
        {
          "name": "Tulkki, Jukka"
        }
      ],
      "citationCount": 0,
      "contributors": [],
      "outputs": [
        "https://api.core.ac.uk/v3/outputs/112373433",
        "https://api.core.ac.uk/v3/outputs/189595983"
      ],
      "createdDate": "2016-12-01T20:58:47",
      "dataProviders": [
        {
          "id": 144,
          "name": "",
          "url": "https://api.core.ac.uk/v3/data-providers/144",
          "logo": "https://api.core.ac.uk/data-providers/144/logo"
        },
        {
          "id": 4786,
          "name": "",
          "url": "https://api.core.ac.uk/v3/data-providers/4786",
          "logo": "https://api.core.ac.uk/data-providers/4786/logo"
        },
        {
          "id": 525,
          "name": "",
          "url": "https://api.core.ac.uk/v3/data-providers/525",
          "logo": "https://api.core.ac.uk/data-providers/525/logo"
        }
      ],
      "depositedDate": "2017-02-10T00:00:00",
      "abstract": "The quantization of optical fields in vacuum has been known for decades, but\nextending the field quantization to lossy and dispersive media in\nnonequilibrium conditions has proven to be complicated due to the\nposition-dependent electric and magnetic responses of the media. In fact,\nconsistent position-dependent quantum models for the photon number in resonant\nstructures have only been formulated very recently and only for dielectric\nmedia. Here we present a general position-dependent quantized fluctuational\nelectrodynamics (QFED) formalism that extends the consistent field quantization\nto describe the photon number also in the presence of magnetic field-matter\ninteractions. It is shown that the magnetic fluctuations provide an additional\ndegree of freedom in media where the magnetic coupling to the field is\nprominent. Therefore, the field quantization requires an additional independent\nnoise operator that is commuting with the conventional bosonic noise operator\ndescribing the polarization current fluctuations in dielectric media. In\naddition to allowing the detailed description of field fluctuations, our\nmethods provide practical tools for modeling optical energy transfer and the\nformation of thermal balance in general dielectric and magnetic nanodevices. We\nuse the QFED to investigate the magnetic properties of microcavity systems to\ndemonstrate an example geometry in which it is possible to probe fields arising\nfrom the electric and magnetic source terms. We show that, as a consequence of\nthe magnetic Purcell effect, the tuning of the position of an emitter layer\nplaced inside a vacuum cavity can make the emissivity of a magnetic emitter to\nexceed the emissivity of a corresponding electric emitter",
      "documentType": "research",
      "doi": "10.1088/1361-6455/aa5baa",
      "downloadUrl": "http://arxiv.org/abs/1611.01226",
      "fieldOfStudy": "physics",
      "fullText": "Generalized noise terms for the quantized fluctuational electrodynamics\nMikko Partanen,1 Teppo Ha\u00a8yrynen,1, 2 Jukka Tulkki,1 and Jani Oksanen1\n1Engineered Nanosystems group, School of Science,\nAalto University, P.O. Box 12200, 00076 Aalto, Finland\n2DTU Fotonik, Department of Photonics Engineering,\nTechnical University of Denmark, \u00d8rsteds Plads,\nBuilding 343, DK-2800 Kongens Lyngby, Denmark\n(Dated: December 21, 2016)\nThe quantization of optical fields in vacuum has been known for decades, but extending the\nfield quantization to lossy and dispersive media in nonequilibrium conditions has proven to be\ncomplicated due to the position-dependent electric and magnetic responses of the media. In fact,\nconsistent position-dependent quantum models for the photon number in resonant structures have\nonly been formulated very recently and only for dielectric media. Here we present a general position-\ndependent quantized fluctuational electrodynamics (QFED) formalism that extends the consistent\nfield quantization to describe the photon number also in the presence of magnetic field-matter\ninteractions. It is shown that the magnetic fluctuations provide an additional degree of freedom\nin media where the magnetic coupling to the field is prominent. Therefore, the field quantization\nrequires an additional independent noise operator that is commuting with the conventional bosonic\nnoise operator describing the polarization current fluctuations in dielectric media. In addition\nto allowing the detailed description of field fluctuations, our methods provide practical tools for\nmodeling optical energy transfer and the formation of thermal balance in general dielectric and\nmagnetic nanodevices. We use QFED to investigate the magnetic properties of microcavity systems\nto demonstrate an example geometry in which it is possible to probe fields arising from the electric\nand magnetic source terms. We show that, as a consequence of the magnetic Purcell effect, the\ntuning of the position of an emitter layer placed inside a vacuum cavity can make the emissivity of\na magnetic emitter to exceed the emissivity of a corresponding electric emitter.\nI. INTRODUCTION\nBetter understanding of optical phenomena and\nnanoscale energy transfer has enabled advances in optical\ntechnologies, e.g., in nanoplasmonics [1\u20134], near-field mi-\ncroscopy [5, 6], thin-film light-emitting diodes [7, 8], pho-\ntonic crystals [9, 10], and metamaterials [11, 12]. These\nadvances are strongly influenced by the availability of\nsimple and transparent theoretical tools that allow in-\ndepth understanding of the pertinent phenomena in suf-\nficiently simple form. Formulating a simple and suffi-\nciently detailed description of the quantum aspects of\nenergy transfer in lossy resonant structures, however, has\nbeen particularly challenging due to several phenomena,\nsuch as wave-particle dualism, intertwined electric and\nmagnetic fields, and field-matter interactions [13, 14], af-\nfecting the energy transfer.\nWe have recently introduced quantized fluctuational\nelectrodynamics (QFED) formalism [15\u201318] for the de-\nscription of field-matter interactions and the formation\nof thermal balance in nonequilibrium conditions in di-\nelectric media. Using the QFED approach it has finally\nbecome possible to formulate the canonical commutation\nrelations preserving ladder and photon-number opera-\ntors for the total electromagnetic field also in resonant\nstructures [15\u201317], thus resolving the previously reported\nanomalies in their commutation relations [19\u201323]. Here\nwe present a more general QFED formalism that also ac-\ncounts for the interactions arising due to magnetic effects.\nThe need to formulate the unified theory emerges from\nthe present observation that the single electric noise oper-\nator picture is insufficient to correctly describe the field-\nmatter interactions and the photon annihilation opera-\ntor of a single polarization in the general case. Instead,\nthe use of two commuting bosonic noise source opera-\ntors is needed to formulate the general model. By using\ntwo separate operators it becomes straightforward to de-\nvelop the QFED model starting from the macroscopic\nMaxwell\u2019s equations and the polarization and magneti-\nzation related material responses. Overall, however, the\nrequirement of using two commuting noise operators to\nallow consistent field quantization presents a significant\nchange in the conventional description of the photon an-\nnihilation operator in interfering structures.\nAfter deriving the generalized QFED formalism, we\napply it to show that, due to the magnetic Purcell effect,\nwe can tune the position of the emitter in a vacuum cav-\nity such that the emissivity of a magnetic emitter signif-\nicantly exceeds the emissivity of a corresponding electric\nemitter. This is a consequence of different position de-\npendences of the electric and magnetic local densities of\nstates (LDOSs). The differences in emissivities are ex-\npected to be experimentally observable by detecting the\noutput radiation with a photodetector or an antenna.\nThis manuscript is organized as follows: The theory\nis presented in Sec. II. It covers the introduction of the\nquantized equations, representation of the Green\u2019s func-\ntions and the related noise source operators. We also\nbriefly review the theory of field fluctuations, photon\nnumbers, Poynting vector, and absorption and emission\noperators while presenting the new generalized forms of\nar\nX\niv\n:1\n61\n1.\n01\n22\n6v\n2 \n [q\nua\nnt-\nph\n]  \n10\n Fe\nb 2\n01\n7\n2the densities of states. In Sec. III, we investigate the\nphysical implications of the concepts by applying the\nmethods to study the emissivity of electric and magnetic\nemitters placed inside the vacuum cavity and demon-\nstrate the different characteristics of the two fundamen-\ntally different source terms of our theory. Finally, con-\nclusions are drawn in Sec. IV.\nII. FIELD QUANTIZATION\nA. Quantized equations\nMaxwell\u2019s equations relate the electric field strength E,\nthe magnetic field strength H, the electric flux density\nD, and the magnetic flux density B to the free electric\ncharge \u03c1f and current Jf densities [24]. In the frequency\ndomain, the equations for positive frequencies read\n\u2207 \u00b7D = \u03c1f , (1)\n\u2207 \u00b7B = 0, (2)\n\u2207\u00d7E = i\u03c9B = i\u03c9\u00b50(\u00b5H+ \u03b4M), (3)\n\u2207\u00d7H = Jf \u2212 i\u03c9D = Jf \u2212 i\u03c9(\u03b50\u03b5E+ \u03b4P), (4)\nwhere we have related the fields and field densities in\nEqs. (3) and (4) using the constitutive relations D =\n\u03b50\u03b5E+ \u03b4P and B = \u00b50(\u00b5H+ \u03b4M), where \u03b50 and \u00b50 are\nthe permittivity and permeability of vacuum, \u03b5 = \u03b5r + i\u03b5i\nand \u00b5 = \u00b5r + i\u00b5i are the relative permittivity and per-\nmeability of the medium with real and imaginary parts\ndenoted by subscripts r and i, and the polarization and\nmagnetization fields \u03b4P and \u03b4M denote the polarization\nand magnetization that are not linearly proportional to\nthe respective field strengths [25]. In the context of the\npresent work, \u03b4P and \u03b4M describe small noise related\nparts in the linear polarization and magnetization fields\nas customary in the classical fluctuational electrodynam-\nics [26].\nFrom the Maxwell\u2019s equations in Eqs. (1)\u2013(4) it follows\nthat the electric and the magnetic fields obey the well-\nknown equations\n\u2207\u00d7\n(\u2207\u00d7E\n\u00b50\u00b5\n)\n\u2212 \u03c92\u03b50\u03b5E = i\u03c9Je \u2212\u2207\u00d7\n( Jm\n\u00b50\u00b5\n)\n, (5)\n\u2207\u00d7\n(\u2207\u00d7H\n\u03b50\u03b5\n)\n\u2212 \u03c92\u00b50\u00b5H = i\u03c9Jm +\u2207\u00d7\n( Je\n\u03b50\u03b5\n)\n, (6)\nwhere the terms Je = Jf\u2212i\u03c9\u03b4P and Jm = \u2212i\u03c9\u00b50\u03b4M rep-\nresent the polarization and magnetization noise currents\nthat act as field sources also in the classical fluctuational\nelectrodynamics [27, 28]. The electric term Je includes\ncontributions from both the electric currents due to free\ncharges (which amount to zero for insulating dielectrics)\nas well as polarization terms associated with dipole cur-\nrents and thermal dipole fluctuations. For the magnetic\nterm Jm, the only contribution arises from the magnetic\ndipoles.\nFor simplicity, we limit the present analysis to the case\nof normal incidence in a structure where the material pa-\nrameters only depend on the position coordinate x and\nformulate Eqs. (5) and (6) as a single polarization scalar\nproblem where the electric and magnetic fields are paral-\nlel to the y and z axes, respectively. In the QFED frame-\nwork, the components of the classical fields and currents\nin Eqs. (1)\u2013(6) are replaced by corresponding quantum\nfield operators E\u02c6+(x, \u03c9) and H\u02c6+(x, \u03c9) and noise current\noperators J\u02c6+e (x, \u03c9) and J\u02c6\n+\nm(x, \u03c9) to account for the quan-\ntum features of the field and the noise statistics. From\nEqs. (5) and (6) it follows that, in our case of normal inci-\ndence, the noise current operators J\u02c6+e (x, \u03c9) and J\u02c6\n+\nm(x, \u03c9)\ndescribe noise current components that are parallel to the\nelectric and magnetic fields, respectively. In the scalar\nform, the equations in Eqs. (5) and (6) then simplify to\n\u2202\n\u2202x\n( \u2202E\u02c6+(x, \u03c9)\n\u00b50\u00b5(x, \u03c9)\u2202x\n)\n+ \u03c92\u03b50\u03b5(x, \u03c9)E\u02c6\n+(x, \u03c9)\n= \u2212i\u03c9J\u02c6+e (x, \u03c9)\u2212\n\u2202\n\u2202x\n( J\u02c6+m(x, \u03c9)\n\u00b50\u00b5(x, \u03c9)\n)\n, (7)\n\u2202\n\u2202x\n( \u2202H\u02c6+(x, \u03c9)\n\u03b50\u03b5(x, \u03c9)\u2202x\n)\n+ \u03c92\u00b50\u00b5(x, \u03c9)H\u02c6\n+(x, \u03c9)\n= \u2212i\u03c9J\u02c6+m(x, \u03c9)\u2212\n\u2202\n\u2202x\n( J\u02c6+e (x, \u03c9)\n\u03b50\u03b5(x, \u03c9)\n)\n. (8)\nNote that these equations are not independent as either\nequation allows fully solving the system, leaving the cal-\nculation of the remaining fields a simple task when apply-\ning the appropriate Maxwell\u2019s equation. In the following,\nwe will mainly use Eq. (7) as the starting point for further\nanalysis.\nB. Green\u2019s functions\nIn order to write the solution of Eq. (7) in a gen-\neral form, we first define the electric Green\u2019s function\nGee(x, \u03c9, x\n\u2032) that satisfies\n\u2202\n\u2202x\n(\u2202Gee(x, \u03c9, x\u2032)\n\u00b5(x, \u03c9)\u2202x\n)\n+k20\u03b5(x, \u03c9)Gee(x, \u03c9, x\n\u2032) = \u2212\u03b4(x\u2212x\u2032),\n(9)\nwhere k0 = \u03c9/c is the wavenumber in vacuum with the\nvacuum velocity of light c. In terms of the electric Green\u2019s\nfunction, the solution of Eq. (7) is written as\nE\u02c6+(x, \u03c9)\n= \u00b50\n\u222b \u221e\n\u2212\u221e\nGee(x, \u03c9, x\n\u2032)\n[\ni\u03c9J\u02c6+e (x\n\u2032, \u03c9) +\n\u2202\n\u2202x\u2032\n( J\u02c6+m(x\u2032, \u03c9)\n\u00b50\u00b5(x\u2032, \u03c9)\n)]\ndx\u2032\n= i\u03c9\u00b50\n\u222b \u221e\n\u2212\u221e\nGee(x, \u03c9, x\n\u2032)J\u02c6+e (x\n\u2032, \u03c9)dx\u2032\n+k0\n\u222b \u221e\n\u2212\u221e\nGem(x, \u03c9, x\n\u2032)J\u02c6+m(x\n\u2032, \u03c9)dx\u2032,\n(10)\n3where, in the case of the second term, we have applied\nintegration by parts with the boundary condition that\nthe Green\u2019s functions go to zero at infinities as they are\nexponentially decaying in lossy media and lossless media\ncan be described in the limit of small losses. We have\nalso defined the exchange Green\u2019s function Gem(x, \u03c9, x\n\u2032)\nas\nGem(x, \u03c9, x\n\u2032) = \u2212\u2202Gee(x, \u03c9, x\n\u2032)\nk0\u00b5(x\u2032, \u03c9)\u2202x\u2032\n. (11)\nSolving for the magnetic field in the Maxwell\u2019s equa-\ntion in Eq. (3) and substituting the electric field operator\nin terms of the Green\u2019s functions in Eq. (10) gives\nH\u02c6+(x, \u03c9)\n=\n1\ni\u03c9\u00b50\u00b5(x, \u03c9)\n(\nJ\u02c6+m(x, \u03c9) +\n\u2202E\u02c6+(x, \u03c9)\n\u2202x\n)\n=\n1\ni\u03c9\u00b50\u00b5(x, \u03c9)\n(\nJ\u02c6+m(x, \u03c9) + i\u03c9\u00b50\n\u222b \u221e\n\u2212\u221e\n\u2202Gee(x, \u03c9, x\n\u2032)\n\u2202x\n\u00d7J\u02c6+e (x\u2032, \u03c9)dx\u2032 + k0\n\u222b \u221e\n\u2212\u221e\n\u2202Gem(x, \u03c9, x\n\u2032)\n\u2202x\nJ\u02c6+m(x\n\u2032, \u03c9)dx\u2032\n)\n= k0\n\u222b \u221e\n\u2212\u221e\n\u2202Gee(x, \u03c9, x\n\u2032)\nk0\u00b5(x, \u03c9)\u2202x\nJ\u02c6+e (x\n\u2032, \u03c9)dx\u2032\n\u2212 ik\n2\n0\n\u03c9\u00b50\n\u222b \u221e\n\u2212\u221e\n[\u2202Gem(x, \u03c9, x\u2032)\nk0\u00b5(x, \u03c9)\u2202x\n+\n\u03b4(x\u2212 x\u2032)\nk20\u00b5(x, \u03c9)\n]\nJ\u02c6+m(x\n\u2032, \u03c9)dx\u2032\n= k0\n\u222b \u221e\n\u2212\u221e\nGme(x, \u03c9, x\n\u2032)J\u02c6+e (x\n\u2032, \u03c9)dx\u2032\n+i\u03c9\u03b50\n\u222b \u221e\n\u2212\u221e\nGmm(x, \u03c9, x\n\u2032)J\u02c6+m(x\n\u2032, \u03c9)dx\u2032,\n(12)\nwhere we have defined the magnetic Green\u2019s func-\ntion Gmm(x, \u03c9, x\n\u2032) and the exchange Green\u2019s function\nGme(x, \u03c9, x\n\u2032) as\nGme(x, \u03c9, x\n\u2032) =\n\u2202Gee(x, \u03c9, x\n\u2032)\nk0\u00b5(x, \u03c9)\u2202x\n, (13)\nGmm(x, \u03c9, x\n\u2032) = \u2212\u2202Gem(x, \u03c9, x\n\u2032)\nk0\u00b5(x, \u03c9)\u2202x\n\u2212 \u03b4(x\u2212 x\n\u2032)\nk20\u00b5(x, \u03c9)\n. (14)\nBy using Eqs. (11) and (14), one also obtains an ex-\npression of the magnetic Green\u2019s function Gmm(x, \u03c9, x\n\u2032)\ndirectly in terms of the electric Green\u2019s function\nGee(x, \u03c9, x\n\u2032) as\nGmm(x, \u03c9, x\n\u2032) =\n\u22022Gee(x, \u03c9, x\n\u2032)\nk20\u00b5(x, \u03c9)\u00b5(x\n\u2032, \u03c9)\u2202x\u2202x\u2032\n\u2212 \u03b4(x\u2212 x\n\u2032)\nk20\u00b5(x, \u03c9)\n.\n(15)\nIn Eq. (15), the first term has a discontinuity at x = x\u2032\ndue to the discontinuity of the second order derivative of\nGee(x, \u03c9, x\n\u2032). However, this discontinuity is completely\nbalanced by the second term rendering Gmm(x, \u03c9, x\n\u2032)\ncontinuous everywhere.\nThe electric and magnetic Green\u2019s functions obey the\ngeneral reciprocity relations Gee(x, \u03c9, x\n\u2032) = Gee(x\u2032, \u03c9, x)\nand Gmm(x, \u03c9, x\n\u2032) = Gmm(x\u2032, \u03c9, x) [27]. The reci-\nprocity relation for the exchange Green\u2019s functions\nGme(x, \u03c9, x\n\u2032) = \u2212Gem(x\u2032, \u03c9, x), follows from the defini-\ntions in Eqs. (11) and (13) and the reciprocity relations\nof Gee(x, \u03c9, x\n\u2032) and Gmm(x, \u03c9, x\u2032).\nThe Green\u2019s functions depend on the problem geom-\netry via the material permittivity and permeability and\nthey are continuous at material interfaces which follows\nfrom the continuity of the electric and magnetic fields\nE\u02c6+(x, \u03c9) and H\u02c6+(x, \u03c9). For example, in a homoge-\nneous space the electric and magnetic Green\u2019s functions\nGee(x, \u03c9, x\n\u2032) and Gmm(x, \u03c9, x\u2032) are\nGee(x, \u03c9, x\n\u2032) = \u00b5(\u03c9)\nieik(\u03c9)|x\u2212x\n\u2032|\n2k(\u03c9)\n, (16)\nGmm(x, \u03c9, x\n\u2032) = \u03b5(\u03c9)\nieik(\u03c9)|x\u2212x\n\u2032|\n2k(\u03c9)\n, (17)\nwhere k(\u03c9) = k0n(\u03c9) is the wavenumber in the medium.\nA simple method to calculate the Green\u2019s functions in\nmore general stratified media is described in Appendix\nA.\nC. Noise operators\nIn order to determine the forms of the noise cur-\nrent operators J\u02c6+e (x, \u03c9) and J\u02c6\n+\nm(x, \u03c9), we require that\nthe resulting electric and magnetic field operators, re-\nlated to the noise source operators by Eq. (7) and\n(8), obey the well-known canonical commutation re-\nlations, i.e., [A\u02c6(x, t), E\u02c6(x\u2032, t)] = \u2212i~/(\u03b50S)\u03b4(x \u2212 x\u2032)\n[20, 29, 30]. For purely dielectric media, studied in\nRefs. [15] and [30], the electric noise current operator\nis directly proportional to a bosonic annihilation oper-\nator f\u02c6(x, \u03c9) satisfying the canonical commutation rela-\ntion [f\u02c6(x, \u03c9), f\u02c6\u2020(x\u2032, \u03c9\u2032)] = \u03b4(x \u2212 x\u2032)\u03b4(\u03c9 \u2212 \u03c9\u2032) through\nJ\u02c6+(x, \u03c9) = j0(x, \u03c9)f\u02c6(x, \u03c9) where j0(x, \u03c9) is a normaliza-\ntion factor given by j0(x, \u03c9) =\n\u221a\n4pi~\u03c92\u03b50Im[n(x, \u03c9)2]/S,\nin which S is the area of quantization in the y-z plane\nand ~ is the reduced Planck constant. The opera-\ntor f\u02c6(x, \u03c9) gives the local source field number opera-\ntor \u03b7\u02c6(x, \u03c9) =\n\u222b\nf\u02c6\u2020(x, \u03c9)f\u02c6(x\u2032, \u03c9\u2032)dx\u2032d\u03c9\u2032 whose expecta-\ntion value \u3008\u03b7\u02c6(x, \u03c9)\u3009 is given by the Bose-Einstein distri-\nbution as \u3008\u03b7\u02c6(x, \u03c9)\u3009 = 1/[e~\u03c9/[kBT (x)] \u2212 1], in which T (x)\nis the possibly position-dependent temperature profile of\nthe medium [15]. In the formalism for dielectrics, the\nderivation of the coefficient j0(x, \u03c9) assumes the relation\n\u03b5(x, \u03c9) = n(x, \u03c9)2 [30], which is not satisfied in the case\nof magnetic media. It also follows that the canonical\ncommutation relations of fields would not be satisfied in\nthe case of magnetic media if we just neglected the mag-\nnetic noise current operator and assumed the same form\nfor the electric noise current operator as that in purely\ndielectric media.\nThus, to preserve the commutation relations and to\nfind the correct form of the current operators, we al-\n4low an additional degree of freedom to conform with the\naddition of the magnetic noise current operator. The\nsimplest possible current operator form using two in-\ndependent bosonic source field operators f\u02c6e(x, \u03c9) and\nf\u02c6m(x, \u03c9) is J\u02c6\n+\ne (x, \u03c9) = j0,e(x, \u03c9)f\u02c6e(x, \u03c9) and J\u02c6m(x, \u03c9) =\nj0,m(x, \u03c9)f\u02c6m(x, \u03c9), where j0,e(x, \u03c9) and j0,m(x, \u03c9) are\nnormalization factors. The above forms can also be\npartly motivated by the fact that the electric and\nmagnetic current operators J\u02c6+e (x, \u03c9) and J\u02c6\n+\nm(x, \u03c9) de-\nscribe currents in different directions. The bosonic\nsource field operators f\u02c6e(x, \u03c9) and f\u02c6m(x, \u03c9) are as-\nsumed to obey the same canonical commutation rela-\ntion [f\u02c6j(x, \u03c9), f\u02c6\n\u2020\nk(x\n\u2032, \u03c9\u2032)] = \u03b4jk\u03b4(x \u2212 x\u2032)\u03b4(\u03c9 \u2212 \u03c9\u2032), where\nj, k \u2208 {e,m}, as above. Similarly, they also define two\nseparate local source field number operators \u03b7\u02c6e(x, \u03c9) and\n\u03b7\u02c6m(x, \u03c9). In the case of a thermal source field described\nby the Bose-Einstein distribution, the expectation values\n\u3008\u03b7\u02c6e(x, \u03c9)\u3009 and \u3008\u03b7\u02c6m(x, \u03c9)\u3009 are additionally equal and de-\nnoted by \u3008\u03b7\u02c6(x, \u03c9)\u3009. The normalization factors j0,e(x, \u03c9)\nand j0,m(x, \u03c9) can be determined apart from the possi-\nble phase factors by requiring that the vector potential\nand electric field operators obey the canonical commu-\ntation relation [A\u02c6(x, t), E\u02c6(x\u2032, t)] = \u2212i~/(\u03b50S)\u03b4(x \u2212 x\u2032)\n[20, 29, 30]. As a result from the calculation presented in\nAppendix B, we obtain j0,e(x, \u03c9) =\n\u221a\n4pi~\u03c92\u03b50\u03b5i(x, \u03c9)/S\nand j0,m(x, \u03c9) =\n\u221a\n4pi~\u03c92\u00b50\u00b5i(x, \u03c9)/S. This essentially\nproves that neither of the two noise source operators\nf\u02c6e(x, \u03c9) and f\u02c6m(x, \u03c9) can be neglected.\nD. Field fluctuations, photon numbers, and\ndensities of states\nIn the case of purely dielectric media, the formulas for\nthe field fluctuations, photon numbers, Poynting vector,\nand local densities of states as described in QFED are\npresented in Refs. 15 and 16. In the present case, the\ngeneral form of the equations stays the same but the\ndensities of states are substantially modified. For com-\npleteness, we review below the general formulae while\npresenting the new generalized nonlocal and interference\ndensities of states.\nThe spectral components of the time domain elec-\ntric and magnetic field fluctuations and the en-\nergy density \u3008u\u02c6(x, t)\u3009\u03c9 = 12 |\u03b50\u03b5(x, \u03c9)|\u3008E\u02c6(x, t)2\u3009\u03c9 +\n1\n2 |\u00b50\u00b5(x, \u03c9)|\u3008H\u02c6(x, t)2\u3009\u03c9 for a single polarization and an-\ngular frequency \u03c9 are written in terms of the photon-\nnumber expectation values as [16]\n\u3008E\u02c6(x, t)2\u3009\u03c9 = ~\u03c9\n\u03b50\n\u03c1e(x, \u03c9)\n(\n\u3008n\u02c6e(x, \u03c9)\u3009+ 1\n2\n)\n, (18)\n\u3008H\u02c6(x, t)2\u3009\u03c9 = ~\u03c9\n\u00b50\n\u03c1m(x, \u03c9)\n(\n\u3008n\u02c6m(x, \u03c9)\u3009+ 1\n2\n)\n, (19)\n\u3008u\u02c6(x, t)\u3009\u03c9 = ~\u03c9\u03c1tot(x, \u03c9)\n(\n\u3008n\u02c6tot(x, \u03c9)\u3009+ 1\n2\n)\n. (20)\nThe photon-number expectation values \u3008n\u02c6j(x, \u03c9)\u3009, j \u2208\n{e,m, tot}, in Eqs. (18)\u2013(20) are given by\n\u3008n\u02c6j(x, \u03c9)\u3009 =\n\u222b\u221e\n\u2212\u221e \u03c1NL,j(x, \u03c9, x\n\u2032)\u3008\u03b7\u02c6(x\u2032, \u03c9)\u3009dx\u2032\u222b\u221e\n\u2212\u221e \u03c1NL,j(x, \u03c9, x\n\u2032)dx\u2032\n. (21)\nIn contrast to purely dielectric media, the nonlocal den-\nsities of states (NLDOSs) \u03c1NL,j(x, \u03c9, x\n\u2032) now include ad-\nditional terms originating from magnetic field-matter in-\nteractions. The generalized NLDOSs are given by\n\u03c1NL,e(x, \u03c9, x\n\u2032)\n=\n2\u03c93\npic4S\n[\n\u03b5i(x\n\u2032, \u03c9)|Gee(x, \u03c9, x\u2032)|2+\u00b5i(x\u2032, \u03c9)|Gem(x, \u03c9, x\u2032)|2\n]\n,\n(22)\n\u03c1NL,m(x, \u03c9, x\n\u2032)\n=\n2\u03c93\npic4S\n[\n\u03b5i(x\n\u2032, \u03c9)|Gme(x, \u03c9, x\u2032)|2+\u00b5i(x\u2032, \u03c9)|Gmm(x, \u03c9, x\u2032)|2\n]\n,\n(23)\n\u03c1NL,tot(x, \u03c9, x\n\u2032)\n=\n|\u03b5(x, \u03c9)|\n2\n\u03c1NL,e(x, \u03c9, x\n\u2032) +\n|\u00b5(x, \u03c9)|\n2\n\u03c1NL,m(x, \u03c9, x\n\u2032).\n(24)\nThe local densities of states (LDOSs) also existing in\nthe denominator of Eq. (21) are given in terms of the\nNLDOSs as\n\u03c1j(x, \u03c9) =\n\u222b \u221e\n\u2212\u221e\n\u03c1NL,j(x, \u03c9, x\n\u2032)dx\u2032. (25)\nThe electric and magnetic LDOSs in Eq. (25) with j \u2208\n{e,m} are related to the imaginary parts of the respective\nGreen\u2019s functions Gee(x, \u03c9, x) and Gmm(x, \u03c9, x) as\n\u03c1j(x, \u03c9) =\n2\u03c9\npic2S\nIm[Gjj(x, \u03c9, x)]. (26)\nNote that the electric and magnetic LDOSs are directly\ngiven by the imaginary parts of the Green\u2019s functions\nGee(x, \u03c9, x) and Gmm(x, \u03c9, x) even though the NLDOSs\nin Eqs. (22) and (23) also depend on the Green\u2019s func-\ntions Gem(x, \u03c9, x) and Gme(x, \u03c9, x). This manifests the\nintimate coupling of the four Green\u2019s functions. Note\nthat the obtained LDOSs are equivalent to those obtained\nby using the conventional fluctuational electrodynamics\nin the case of normal incidence [26, 31, 32].\nThe position-dependent photon-ladder operators con-\ntributing to the effective photon-number expectation val-\nues in Eq. (21) can be obtained by the same procedure as\nthat presented for dielectric media in Ref. 15. The only\nexception is that we now have two commuting source\nfield operators f\u02c6e(x, \u03c9) and f\u02c6m(x, \u03c9) instead of a single\noperator f\u02c6(x, \u03c9). The resulting expression for the ladder\noperators reads\na\u02c6j(x, \u03c9) =\n1\u221a\n\u03c1j(x, \u03c9)\n\u222b \u221e\n\u2212\u221e\n[\u221a\n\u03c1NL,j,e(x, \u03c9, x\u2032)f\u02c6e(x\u2032, \u03c9)\n+\n\u221a\n\u03c1NL,j,m(x, \u03c9, x\u2032)f\u02c6m(x\u2032, \u03c9)\n]\ndx\u2032, (27)\n5where \u03c1NL,j,e(x, \u03c9, x\n\u2032) and \u03c1NL,j,m(x, \u03c9, x\u2032) with j \u2208\n{e,m} denote, respectively, the first and the second\nterms of Eqs. (22) and (23). The total NLDOS terms\n\u03c1NL,tot,e(x, \u03c9, x\n\u2032) and \u03c1NL,tot,m(x, \u03c9, x\u2032) are calculated by\nusing Eq. (24) with the corresponding terms in the elec-\ntric and magnetic NLDOSs.\nAs in the case of dielectric media [15, 17], we apply\nthe general definition of the quantum optical Poynting\nvector operator as a normal ordered operator in terms\nof the positive and negative frequency parts of the elec-\ntric and magnetic field operators, given by S\u02c6(x, t) =:\nE\u02c6(x, t)H\u02c6(x, t) := E\u02c6\u2212(x, t)H\u02c6+(x, t) + H\u02c6\u2212(x, t)E\u02c6+(x, t)\n[33]. Substituting the electric and magnetic field oper-\nators in Eqs. (10) and (12) into the Poynting vector def-\ninition and taking the expectation value results in\n\u3008S\u02c6(x, t)\u3009\u03c9 = ~\u03c9v(x, \u03c9)\n\u222b \u221e\n\u2212\u221e\n\u03c1IF(x, \u03c9, x\n\u2032)\u3008\u03b7\u02c6(x\u2032, \u03c9)\u3009dx\u2032,\n(28)\nwhere v(x, \u03c9) = c/nr(x, \u03c9) is the energy propagation ve-\nlocity, nr(x, \u03c9) is the real part of the refractive index,\nand the quantity \u03c1IF(x, \u03c9, x\n\u2032), introduced for nonmag-\nnetic media in Ref. 17, is referred to as the interference\ndensity of states (IFDOS) and it is, in the present case,\ngiven by\n\u03c1IF(x, \u03c9, x\n\u2032)\n=\n2\u03c92nr(x, \u03c9)\npic4S\n[\n\u03b5i(x\n\u2032, \u03c9)Re\n(\ni\u03c9Gee(x, \u03c9, x\n\u2032)G\u2217me(x, \u03c9, x\n\u2032)\n)\n+ \u00b5i(x\n\u2032, \u03c9)Re\n(\ni\u03c9Gmm(x, \u03c9, x\n\u2032)G\u2217em(x, \u03c9, x\n\u2032)\n)]\n.\n(29)\nThe integral of the IFDOS with respect to x\u2032 is always\nzero as required, e.g. by the fact that in a medium in\nthermal equilibrium, there is no net energy flow [17]. In\naddition, it is important to note that the total Poynting\nvector expectation value in Eq. (28) is always continuous\nat interfaces, which is necessary due to the conservation\nof energy. Note that, in the QFED framework, it is also\npossible to apply the density of states concepts to ex-\npress the Poynting vector expectation value in Eq. (28)\nin terms of the left and right propagating photon-number\nexpectation values by using the procedure described in\nRef. 17.\nE. Macroscopic emission and absorption operators\nand thermal balance\nA particularly insightful view of the effective photon\nnumbers is provided by their connection to local ther-\nmal balance between the field and matter studied in the\ncase of nonmagnetic media in Ref. 15. Here we present\nthe corresponding thermal balance equation in the case of\ngeneral media including field-matter interactions through\nthe magnetic field. First, we present the emission and ab-\nsorption operators Q\u02c6em(x, t) and Q\u02c6abs(x, t) that capture\nthe macroscopic nature of the material layers that are as-\nsumed to act as constant memoryless reservoirs. In terms\nof the field and the noise current operators, the normal\nordered emission and absorption operators Q\u02c6em(x, t) and\nQ\u02c6abs(x, t) are given by\nQ\u02c6em(x, t) = \u2212 : J\u02c6e(x, t)E\u02c6(x, t) : \u2212 : J\u02c6m(x, t)H\u02c6(x, t) :,\n(30)\nQ\u02c6abs(x, t) =: J\u02c6e,abs(x, t)E\u02c6(x, t) : + : J\u02c6m,abs(x, t)H\u02c6(x, t) : .\n(31)\nThe second terms describe the field-matter interactions\nthrough the magnetic field and they are not present in\nthe formalism for dielectrics. Whereas the emission cur-\nrent operators J\u02c6e(x, t) and J\u02c6m(x, t) directly present the\nfield sources as shown in frequency domain in Eq. (7)\nand (8), the absorption current operators J\u02c6e,abs(x, t) and\nJ\u02c6m,abs(x, t) describe secondary currents that are induced\nby the electric and magnetic fields. Therefore, the oper-\nators J\u02c6e(x, t) and J\u02c6m(x, t) can be seen to correspond to\nthe classical free current densities whereas the operators\nJ\u02c6e,abs(x, t) and J\u02c6m,abs(x, t) correspond to the classical\nbound current densities [24]. The operators J\u02c6e,abs(x, t)\nand J\u02c6m,abs(x, t) are written in the spectral domain as\nJ\u02c6+e,abs(x, \u03c9) = \u2212i\u03c9\u03b50\u03c7e(x, \u03c9)E\u02c6+(x, \u03c9) and J\u02c6+m,abs(x, \u03c9) =\n\u2212i\u03c9\u00b50\u03c7m(x, \u03c9)H\u02c6+(x, \u03c9), where \u03c7e(x, \u03c9) = \u03b5(x, \u03c9) \u2212 1\nand \u03c7m(x, \u03c9) = \u00b5(x, \u03c9)\u2212 1 are the electric and magnetic\nsusceptibilities of the medium. The total current den-\nsity operators are then given by J\u02c6e,tot(x, t) = J\u02c6e(x, t) +\nJ\u02c6e,abs(x, t) and J\u02c6m,tot(x, t) = J\u02c6m(x, t) + J\u02c6m,abs(x, t).\nThe net emission operator Q\u02c6(x, t) = Q\u02c6em(x, t) \u2212\nQ\u02c6abs(x, t), whose expectation value equals the divergence\nof the Poynting vector expectation value in Eq. (28) [15],\nis given in terms of the electric and magnetic field opera-\ntors and the total current density operators as Q\u02c6(x, t) =:\nJ\u02c6e,tot(x, t)E\u02c6(x, t) : + : J\u02c6m,tot(x, t)H\u02c6(x, t) :. In the case\nof dielectrics, the spectral component of the expectation\nvalue of the net emission operator can be written in terms\nof the electric LDOS and the effective electric field pho-\nton number expectation value [15]. In the present case,\nwe obtain the net emission expectation value in terms of\nboth the electric and magnetic LDOSs and the effective\nelectric and magnetic field photon numbers as\n\u3008Q\u02c6(x, t)\u3009\u03c9\n= ~\u03c92\u03b5i(x, \u03c9)\u03c1e(x, \u03c9)[\u3008\u03b7\u02c6(x, \u03c9)\u3009 \u2212 \u3008n\u02c6e(x, \u03c9)\u3009]\n+ ~\u03c92\u00b5i(x, \u03c9)\u03c1m(x, \u03c9)[\u3008\u03b7\u02c6(x, \u03c9)\u3009 \u2212 \u3008n\u02c6m(x, \u03c9)\u3009]. (32)\nAt global thermal equilibrium, the effective electric and\nmagnetic photon-number expectation values \u3008n\u02c6e(x, \u03c9)\u3009\nand \u3008n\u02c6m(x, \u03c9)\u3009 both reach the source field value\n\u3008\u03b7\u02c6(x, \u03c9)\u3009 = \u3008\u03b7\u02c60\u3009 when the net emission rate in Eq. (32)\nbecomes zero. In resonant systems where the energy ex-\nchange is dominated by a narrow frequency band, condi-\ntion \u3008Q\u02c6(x, t)\u3009\u03c9 = 0 can be used to determine the approx-\nimate steady state temperature of a weakly interacting\nresonant particle [34].\n6Photodetector\nReflector ReflectorEmitter layer\nFIG. 1. (Color online) Schematic illustration of the setup for\nmeasuring the emissivity of electric and magnetic emitter lay-\ners placed in the middle of the vacuum cavity formed by two\nreflectors. The electric and magnetic LDOSs are position-\ndependent inside the cavity which results in significantly dif-\nferent emissivities of electric and magnetic emitters as de-\ntected by a photodetector outside the cavity.\nIII. EXAMPLES\nTo investigate the physical implications and advan-\ntages of the concepts presented in Sec. II we apply the\nmethods to study the emissivities of electric and mag-\nnetic emitters placed in the middle of a vacuum cavity\nto show that it is possible to directly probe and demon-\nstrate the essentially independent nature of the electric\nand magnetic source terms.\nIn the example, a thin heated material layer which\ninteracts with the electromagnetic field through electric\nor magnetic interaction terms is placed in the middle of a\n10 \u00b5m thick vacuum cavity as illustrated in Fig. 1. The\nrelative permittivity and permeability of the lossless 1\n\u00b5m thick cavity walls are \u03b5 = 10 and \u00b5 = 1, resulting in\nthe cavity wall power reflection coefficient R = 0.64 for\nthe second cavity resonance with energy ~\u03c9 = 0.119 eV\n(\u03bb = 10.4 \u00b5m). We focus on the second resonance since\nit exhibits a node for the electric field and anti-node for\nthe magnetic field in the middle of the cavity.\nFigure 2(a) shows the electric and magnetic LDOSs for\nthe second resonant photon energy. Inside the cavity, the\nelectric LDOS has two maxima and the magnetic LDOS,\nrespectively, has two minima. In the middle of the cav-\nity, the electric LDOS obtains its minimum value which\nis close to zero. The magnetic LDOS instead obtains its\nmaximum value at the same point. The LDOSs deter-\nmine the local field-matter interactions as seen in the net\nemission rate in Eq. (32).\nFigure 2(b) shows the effective photon number of the\ntotal electromagnetic field for the second resonant en-\nergy when a 1 \u00b5m thick electric or magnetic emitter layer\nwith temperature T = 300 K is placed in the middle of\nthe cavity. The electric emitter layer has a relative per-\nmittivity \u03b5 = 1.1 + 0.1i and a permeability \u00b5 = 1 and\nthe magnetic emitter layer, respectively, has a relative\npermittivity \u03b5 = 1 and a permeability \u00b5 = 1.1 + 0.1i.\nThe photon number is piecewise constant in all lossless\nmedia in the geometry. It can be seen that the magni-\ntude of the photon number is significantly larger in the\n\u22125 0 5 10 150\n1\n2\n3\n4\n5\nPosition (\u00b5m)\nLD\nO\nS\n(a)\n\u22125 0 5 10 150\n0.5\n1\n1.5\n2\n2.5\n3\nx 10\u22123\nPosition (\u00b5m)\nPh\not\non\n n\num\nbe\nr\n(b)\nFIG. 2. (Color online) (a) Electric (solid line) and magnetic\n(dashed line) LDOSs in the vicinity of a vacuum cavity with\nrelative wall permittivity \u03b5 = 10 and permeability \u00b5 = 1 for\nthe second resonant energy ~\u03c9 = 0.119 eV (\u03bb = 10.4 \u00b5m). (b)\nEffective photon number of the total electromagnetic field for\nthe above photon energy in the case of electric (solid line) and\nmagnetic (dashed line) emitter layers at temperature T = 300\nK placed in the middle of the cavity. The electric emitter layer\nhas relative permittivity \u03b5 = 1.1+0.1i and permeability \u00b5 = 1\nand the magnetic emitter layer has relative permittivity \u03b5 = 1\nand permeability \u00b5 = 1.1 + 0.1i. The width of the cavity is\n10 \u00b5m and the thickness of the cavity walls and the emitter\nlayers is 1 \u00b5m. The LDOSs are given in the units of 2/(picS).\ncase of the magnetic emitter layer due to the different\nemissivities following from the electric field node and the\nmagnetic field anti-node at the position of the emitter\nlayer. This behavior, which manifests the magnetic Pur-\ncell effect, should be directly experimentally measurable\nby detecting the normally emitted field outside the cavity.\nThe experimental verification of the phenomenon would\ntherefore demonstrate the essentially independent nature\nof the polarization and magnetization source terms.\nTo experimentally verify the existence of the magnetic\nPurcell effect and the need for the second noise source\nterm, it would be necessary to construct a cavity system\nwith a magnetically interacting emitter layer, in addition\n7to a conventional electrically interacting one. The emit-\nter layer might need to be constructed using engineered\nmaterials [35, 36]. The cavity itself could consist of al-\nmost any kind of transparent materials or vacuum, and\npartly reflecting walls allowing an appropriate amount\nof emission to escape from the cavity. The detection of\nthe light could then be carried out by using any frequency\nand direction selective setup, such as the setup presented\nby Marquier et al. [37]. In agreement with the Kirchoff\u2019s\nlaw of radiation, a complementary setup could also be\nconstructed in reverse, measuring the power absorbed by\nthe Purcell enhanced absorber.\nIV. CONCLUSIONS\nIn conclusion, we have formulated a generalized QFED\nnoise operator formalism that is able to consistently de-\nscribe the effective photon number, field-matter interac-\ntions, and the formation of thermal balance in nonequi-\nlibrium conditions in general isotropic media. It was\nshown that two commuting bosonic noise operators are\nneeded to describe the field sources for a single polar-\nization in order to maintain the well-known canonical\ncommutation relations for the field operators. The two\nbosonic noise operators are directly related to the electric\nand magnetic field-matter interactions in the medium.\nWe have also used the model to predict how thermal\nemission from electric or magnetic emitters changes in a\nconfiguration where the emitters are located in an optical\ncavity. The results suggest that it is possible to design a\nconceptually straightforward experimental setup to dif-\nferentiate between the two independent noise sources\nwith fundamentally different origin.\nACKNOWLEDGMENTS\nThis work has in part been funded by the Academy of\nFinland and the Aalto Energy Efficiency Research Pro-\ngramme.\nAppendix A: Green\u2019s functions\n1. Multi-interface reflection and transmission\ncoefficients\nWe first define the conventional single interface electric\nand magnetic field reflection and transmission coefficients\nre, rm, te, tm. The materials on the left and right have\nrelative permittivities and permeabilities \u03b51, \u00b51, \u03b52, and\n\u00b52, and refractive indices n1 =\n\u221a\n\u03b51\u00b51 and n2 =\n\u221a\n\u03b52\u00b52.\nFor left normal incidence the reflection and transmission\ncoefficients are given by\nre =\n\u00b52n1 \u2212 \u00b51n2\n\u00b52n1 + \u00b51n2\n, te =\n2\u00b52n1\n\u00b52n1 + \u00b51n2\n,\nrm =\n\u03b52n1 \u2212 \u03b51n2\n\u03b52n1 + \u03b51n2\n, tm =\n2\u03b52n1\n\u03b52n1 + \u03b51n2\n, (A1)\nThe reflection and transmission coefficients for right in-\ncidence r\u2032e, r\n\u2032\nm, t\n\u2032\ne, and t\n\u2032\nm are obtained by switching the\nindices 1 and 2 in the expressions of re, rm, te, and tm.\nThe multi-interface geometry is defined by interface\npositions xl, l = 1, 2, ..., N separating material layers\nwith relative permittivities and permeabilities \u03b5l and\n\u00b5l, refractive indices nl and wavenumbers kl, where\nl = 1, 2, ..., N + 1. The layer thicknesses are denoted by\ndl = xl\u2212xl\u22121, where l = 2, ..., N . The multi-interface re-\nflection and transmission coefficients Rl,j and Tl,j , which\naccount for the multiple reflections in different medium\nlayers, are recursively given in terms of the single inter-\nface reflection and transmission coefficients as\nRl,j = rl,j +Rl+1,je\n2ikl+1dl+1\n1 + rl,jRl+1,je2ikl+1dl+1 (A2)\nTl,j = tl,j\u03bdl+1,j\n\u03bdl,j(1\u2212R\u2032l\u22121,jrl,je2ikldl)\n, (A3)\nwhere l = 1, 2, ..., N , j \u2208 {e,m}, \u03bdl,j = 1/(1 \u2212\nR\u2032l\u22121,jRl,je2ikldl), and R\u20320,j = RN+1,j = 0. As in the\ncase of single interface coefficients in Eq. (A1) the primed\ncoefficients denote the coefficients for right incidence.\nThe layers are indexed such that R\u2032l,j corresponds to the\nsame interface as Rl,j . The propagation coefficient for a\nmaterial layer l of thickness dl is given by e\nikldl , the trans-\nmission coefficient Tl,l\u2032,j from layer l\u2032 to layer l > l\u2032 + 1\nis recursively given by Tl,l\u2032,j = Tl\u22121,l\u2032,jTl\u22121,jeikl\u22121dl\u22121\nwith Tl\u2032+1,l\u2032,j = Tl\u2032,j , and the transmission coefficient\nT \u2032l,l\u2032,j from layer l\u2032 to layer l < l\u2032 \u2212 1 is given by\nT \u2032l,l\u2032,j = T \u2032l+1,l\u2032,jT \u2032l,jeikl+1dl+1 with T \u2032l\u2032\u22121,l\u2032,j = T \u2032l\u2032\u22121,j .\n2. Green\u2019s functions for layered structures\nWe write the electric and magnetic Green\u2019s func-\ntions Gee(x, \u03c9, x\n\u2032) and Gmm(x, \u03c9, x\u2032) for a general lay-\nered structure in terms of the scaled Green\u2019s functions\n\u03bej(x, \u03c9, x\n\u2032) defined below as\nGee(x, \u03c9, x\n\u2032) = \u00b5(x\u2032, \u03c9)\u03bee(x, \u03c9, x\u2032) (A4)\nGmm(x, \u03c9, x\n\u2032) = \u03b5(x\u2032, \u03c9)\u03bem(x, \u03c9, x\u2032). (A5)\nIn the following, the source point x\u2032 is located in layer\nl\u2032 (xl\u2032\u22121 < x\u2032 < xl\u2032) and field point x is located in layer\nl (xl\u22121 < x < xl) with x0 = \u2212\u221e and xN+1 = \u221e. In\nthe source layer (l = l\u2032), the scaled Green\u2019s function has\nthree components as\n\u03bel=l\u2032,j(x, \u03c9, x\n\u2032)\n= \u03be0,l\u2032(x, \u03c9, x\n\u2032) + \u03be+,l\u2032,j(x, \u03c9, x\u2032) + \u03be\u2212,l\u2032,j(x, \u03c9, x\u2032).\n(A6)\nThe component \u03be0,l\u2032(x, \u03c9, x\n\u2032) is the homogeneous\nspace solution and the components \u03be+,l\u2032,j(x, \u03c9, x\n\u2032) and\n\u03be\u2212,l\u2032,j(x, \u03c9, x\u2032) describe the right and left propagating\nfields due to the reflections at the interfaces. The ho-\nmogeneous space solution is given by\n\u03be0,l\u2032(x, \u03c9, x\n\u2032) =\nieikl\u2032 |x\u2212x\n\u2032|\n2kl\u2032\n(A7)\n8and the right propagating reflection originating compo-\nnent is written as\n\u03be+,l\u2032,j(x, \u03c9, x\n\u2032)\n= eikl\u2032 (x\u2212xl\u2032\u22121)\u03be0,l\u2032(xl\u2032\u22121, \u03c9, x\u2032)R\u2032l\u2032\u22121,j\n\u00d7\n\u221e\u2211\nm=0\n(R\u2032l\u2032\u22121,jRl\u2032,je2ikl\u2032dl\u2032 )m\n+eikl\u2032 (x\u2212xl\u2032\u22121)\u03be0,l\u2032(xl\u2032 , \u03c9, x\u2032)R\u2032l\u2032\u22121,jRl\u2032,jeikjdj\n\u00d7\n\u221e\u2211\nm=0\n(R\u2032l\u2032\u22121,jRl\u2032,je2ikl\u2032dl\u2032 )m\n= eikl\u2032 (x\u2212xl\u22121)\nieikl\u2032 (x\n\u2032\u2212xl\u2032\u22121)\n2kl\n\u03bdl\u2032,jR\u2032l\u2032\u22121,j\n+eikl\u2032 (x\u2212xl\u2032\u22121)\nieikl\u2032 (xl\u2032\u2212x\n\u2032)\n2kl\u2032\neikl\u2032dl\u03bdl\u2032,jR\u2032l\u2032\u22121Rl\u2032\n=\ni\n2kl\u2032\n\u03bdl\u2032,jR\u2032l\u2032\u22121,j(eikl\u2032 (x+x\n\u2032\u22122xl\u2032\u22121) +Rl\u2032,jeikl\u2032 (x\u2212x\u2032+2dl\u2032 )).\n(A8)\nThe first term describes the field component incident\nfrom the source point to the left and the second\nterm describes the field component incident from the\nsource point to the right. The factor \u03bdl\u2032,j = 1/(1 \u2212\nR\u2032l\u2032\u22121,jRl\u2032,je2ikl\u2032dl\u2032 ) arises from the series accounting for\nthe multiple reflections inside the source layer. Respec-\ntively, the left propagating reflection originating compo-\nnent is written as\n\u03be\u2212,l\u2032,j(x, \u03c9, x\u2032)\n= e\u2212ikl\u2032 (x\u2212xl\u2032 )\u03be0,l\u2032(xl\u2032 , \u03c9, x\u2032)Rl\u2032,j\n\u221e\u2211\nm=0\n(R\u2032l\u2032\u22121,jRl\u2032,je2ikl\u2032dl\u2032 )m\n+e\u2212ikl\u2032 (x\u2212xl\u2032 )\u03be0,l\u2032(xl\u2032\u22121, \u03c9, x\u2032)R\u2032l\u2032\u22121,jRl\u2032,jeikl\u2032dl\u2032\n\u221e\u2211\nm=0\n(R\u2032l\u2032\u22121,jRl\u2032,je2ikl\u2032dl\u2032 )m\n= e\u2212ikl\u2032 (x\u2212xl\u2032 )\nieikl\u2032 (xl\u2032\u2212x\n\u2032)\n2kl\u2032\n\u03bdl\u2032,jRl\u2032,j\n+e\u2212ikl\u2032 (x\u2212xl\u2032 )\nieikl\u2032 (x\n\u2032\u2212xl\u2032\u22121)\n2kl\u2032\neikl\u2032dl\u2032 \u03bdl\u2032,jR\u2032l\u2032\u22121,jRl\u2032,j\n=\ni\n2kl\u2032\n\u03bdl\u2032,jRl\u2032,j(e\u2212ikl\u2032 (x+x\u2032\u22122xl\u2032 ) +R\u2032l\u2032\u22121,je\u2212ikl\u2032 (x\u2212x\n\u2032\u22122dl\u2032 )).\n(A9)\nTherefore, the total scaled Green\u2019s function is given in\nthe source layer by\n\u03bel=l\u2032,j(x, \u03c9, x\n\u2032)\n=\ni\n2kl\u2032\n(\neikl\u2032 |x\u2212x\n\u2032| + \u03bdl\u2032,jRl\u2032,j [e\u2212ikl\u2032 (x+x\u2032\u22122xl\u2032 )\n+R\u2032l\u2032\u22121,je\u2212ikl\u2032 (x\u2212x\n\u2032\u22122dl\u2032 )] + \u03bdl\u2032,jR\u2032l\u2032\u22121,j\n\u00d7 [eikl\u2032 (x+x\u2032\u22122xl\u2032\u22121) +Rl\u2032,jeikl\u2032 (x\u2212x\u2032+2dl\u2032 )]\n)\n. (A10)\nWriting the scaled Green\u2019s functions in other layers is\neven more straightforward and, as a result, the scaled\nGreen\u2019s functions are given in the cases l > l\u2032 and l < l\u2032\nby\n\u03bel>l\u2032,j(x, \u03c9, x\n\u2032)\n=\ni\n2kl\u2032\nTl,l\u2032,j\n(\neikl\u2032 (xl\u2032\u2212x\n\u2032) + \u03bdl\u2032,jR\u2032l\u2032\u22121,j [eikl\u2032 (x\n\u2032\u2212xl\u2032\u22121+dl\u2032 )\n+Rl\u2032,jeikl\u2032 (2dl\u2032\u2212x\u2032+xl\u2032 )]\n)\n\u00d7\n(\neikl(x\u2212xl\u22121) +Rl,je\u2212ikl(x\u2212xl\u22121\u22122dl)\n)\n, (A11)\n\u03bel<l\u2032,j(x, \u03c9, x\n\u2032)\n=\ni\n2kl\u2032\nT \u2032l,l\u2032,j\n(\neikl\u2032 (x\n\u2032\u2212xl\u2032\u22121)+\u03bdl\u2032,jRl\u2032,j [e\u2212ikl\u2032 (x\u2032\u2212xl\u2032\u22121\u22122dl\u2032 )\n+R\u2032l\u2032\u22121,jeikl\u2032 (x\n\u2032\u2212xl\u2032\u22121+2dl\u2032 )]\n)\n\u00d7\n(\ne\u2212ikl(x\u2212xl) +R\u2032l\u22121,jeikl(x\u2212xl\u22121+dl)\n)\n. (A12)\nAppendix B: Canonical commutation relations of\nfields\nHere we determine the normalization factors j0,e(x, \u03c9)\nand j0,m(x, \u03c9) of the noise current operators by requiring\nthat the vector potential and electric field operators obey\nthe canonical commutation relation [A\u02c6(x, t), E\u02c6(x\u2032, t)] =\n\u2212i~/(\u03b50S)\u03b4(x\u2212x\u2032) [20, 29, 30]. The vector potential and\nelectric field operators are given in the frequency domain\nby\nA\u02c6+(x, \u03c9)\n= \u00b50\n\u222b \u221e\n\u2212\u221e\nj0,e(x\n\u2032, \u03c9)Gee(x, \u03c9, x\u2032)f\u02c6e(x\u2032, \u03c9)dx\u2032\n+\n1\nic\n\u222b \u221e\n\u2212\u221e\nj0,m(x\n\u2032, \u03c9)Gem(x, \u03c9, x\u2032)f\u02c6m(x\u2032, \u03c9)dx\u2032.\n(B1)\nE\u02c6+(x, \u03c9)\n= i\u03c9\u00b50\n\u222b \u221e\n\u2212\u221e\nj0,e(x\n\u2032, \u03c9)Gee(x, \u03c9, x\u2032)f\u02c6e(x\u2032, \u03c9)dx\u2032\n+ k0\n\u222b \u221e\n\u2212\u221e\nj0,m(x\n\u2032, \u03c9)Gem(x, \u03c9, x\u2032)f\u02c6m(x\u2032, \u03c9)dx\u2032.\n(B2)\nThe frequency domain commutator is obtained by using\nthe frequency domain vector potential and electric field\n9operators as\n[A\u02c6+ \u2020(x, \u03c9), E\u02c6+(x\u2032, \u03c9\u2032)]\n= i\u03c9\u00b520\n\u222b \u221e\n\u2212\u221e\n\u222b \u221e\n\u2212\u221e\nj0,e(y, \u03c9)j\n\u2217\n0,e(y\n\u2032, \u03c9\u2032)Gee(x, \u03c9, y)\n\u00d7G\u2217ee(x\u2032, \u03c9\u2032, y\u2032)[f\u02c6\u2020e (y, \u03c9), f\u02c6e(y\u2032, \u03c9\u2032)]dydy\u2032\n\u2212k0\nic\n\u222b \u221e\n\u2212\u221e\n\u222b \u221e\n\u2212\u221e\nj0,m(y, \u03c9)j\n\u2217\n0,m(y\n\u2032, \u03c9\u2032)Gem(x, \u03c9, y)\n\u00d7G\u2217em(x\u2032, \u03c9\u2032, y\u2032)[f\u02c6\u2020m(y, \u03c9), f\u02c6m(y\u2032, \u03c9\u2032)]dydy\u2032\n=\n\u03b4(\u03c9 \u2212 \u03c9\u2032)\ni\u03c9\n[\n\u03c92\u00b520\n\u222b \u221e\n\u2212\u221e\n|j0,e(y, \u03c9)|2Gee(x, \u03c9, y)G\u2217ee(x\u2032, \u03c9, y)dy\n+k20\n\u222b \u221e\n\u2212\u221e\n|j0,m(y, \u03c9)|2Gem(x, \u03c9, y)G\u2217em(x\u2032, \u03c9, y)dy\n]\n= \u2212i 4pi~\u03c9\n\u03b50c2S\n\u03b4(\u03c9 \u2212 \u03c9\u2032)\n[\nk20\n\u222b \u221e\n\u2212\u221e\n[\u03b5i(y, \u03c9) + C1(y, \u03c9)]\n\u00d7Gee(x, \u03c9, y)G\u2217ee(x\u2032, \u03c9, y)dy\n+k20\n\u222b \u221e\n\u2212\u221e\n[\u00b5i(y, \u03c9) + C2(y, \u03c9)]Gem(x, \u03c9, y)G\n\u2217\nem(x\n\u2032, \u03c9, y)dy\n]\n= \u2212i 4pi~\u03c9\n\u03b50c2S\n\u03b4(\u03c9 \u2212 \u03c9\u2032)Im[Gee(x, \u03c9, x\u2032)]\n\u2212i4pi~\u03c9\n3\n\u03b50c4S\n\u03b4(\u03c9 \u2212 \u03c9\u2032)\n\u222b \u221e\n\u2212\u221e\nC(x, x\u2032, y, \u03c9)dy,\n(B3)\nwhere we have first substituted the field operators in\nEqs. (B1) and (B2), then applied the commutation re-\nlations of operators f\u02c6e(y, \u03c9) and f\u02c6m(y, \u03c9) after which\nwe have substituted |j0,e(y, \u03c9)|2 = 4pi~\u03c92\u03b50[\u03b5i(y, \u03c9) +\nC1(y, \u03c9)]/S and |j0,m(y, \u03c9)|2 = 4pi~\u03c92\u00b50[\u00b5i(y, \u03c9) +\nC2(y, \u03c9)]/S, where C1(y, \u03c9) and C2(y, \u03c9) are functions\nthat will be determined at the end of the calculation.\nThese substitutions essentially just transform the unde-\ntermined factors |j0,e(y, \u03c9)|2 and |j0,m(y, \u03c9)|2 to unde-\ntermined factors C1(y, \u03c9) and C2(y, \u03c9). The forms of the\nsubstitutions are chosen so that the functions C1(y, \u03c9)\nand C2(y, \u03c9) can be shown to be zero at the end of the\ncalculation. In the final step in Eq. (B3), we have ap-\nplied the Green\u2019s function integral identity in Eq. (C6)\nand denoted\nC(x, x\u2032, y, \u03c9) = C1(y, \u03c9)Gee(x, \u03c9, y)G\u2217ee(x\n\u2032, \u03c9, y)\n+ C2(y, \u03c9)Gem(x, \u03c9, y)G\n\u2217\nem(x\n\u2032, \u03c9, y).\n(B4)\nNext, we present the time domain equal-time commu-\ntator. The time domain operators are given in terms of\nthe frequency domain operators as\nA\u02c6(x, t) =\n1\n2pi\n\u222b \u221e\n0\nA\u02c6+(x, \u03c9)e\u2212i\u03c9td\u03c9 +H.c., (B5)\nE\u02c6(x, t) =\n1\n2pi\n\u222b \u221e\n0\nE\u02c6+(x, \u03c9)e\u2212i\u03c9td\u03c9 +H.c., (B6)\nwhere H.c. denotes the Hermitian conjugate of the\nfirst term. In the calculation of the commutator, we\nalso use the general relation [A\u02c6+(x, \u03c9), E\u02c6+ \u2020(x\u2032, \u03c9\u2032)] =\n[A\u02c6+ \u2020(x, \u03c9), E\u02c6+(x\u2032, \u03c9\u2032)], which relates the commutators\nof the conjugate terms. By using Eq. (B3), the time do-\nmain equal-time commutator is then given by\n[A\u02c6(x, t), E\u02c6(x\u2032, t)]\n=\n1\n4pi2\n\u222b \u221e\n0\n\u222b \u221e\n0\n[A\u02c6+ \u2020(x, \u03c9), E\u02c6+(x\u2032, \u03c9\u2032)]e\u2212i(\u03c9\u2212\u03c9\n\u2032)td\u03c9d\u03c9\u2032\n+\n1\n4pi2\n\u222b \u221e\n0\n\u222b \u221e\n0\n[A\u02c6+(x, \u03c9), E\u02c6+ \u2020(x\u2032, \u03c9\u2032)]ei(\u03c9\u2212\u03c9\n\u2032)td\u03c9d\u03c9\u2032\n= \u2212i 2~\npi\u03b50c2S\n\u222b \u221e\n0\n\u03c9Im[Gee(x, \u03c9, x\n\u2032)]d\u03c9\n\u2212 i 2~\npi\u03b50c4S\n\u222b \u221e\n0\n\u222b \u221e\n\u2212\u221e\n\u03c93C(x, x\u2032, y, \u03c9)dyd\u03c9\n= \u2212 ~\npi\u03b50c2S\n\u222b \u221e\n0\n\u03c9[Gee(x, \u03c9, x\n\u2032)\u2212G\u2217ee(x, \u03c9, x\u2032)]d\u03c9\n\u2212 i 2~\npi\u03b50c4S\n\u222b \u221e\n0\n\u222b \u221e\n\u2212\u221e\n\u03c93C(x, x\u2032, y, \u03c9)dyd\u03c9\n= \u2212 ~\npi\u03b50c2S\n\u222b \u221e\n\u2212\u221e\n\u03c9Gee(x, \u03c9, x\n\u2032)d\u03c9\n\u2212 i 2~\npi\u03b50c4S\n\u222b \u221e\n0\n\u222b \u221e\n\u2212\u221e\n\u03c93C(x, x\u2032, y, \u03c9)dyd\u03c9. (B7)\nwhere we have used the relation 2iIm(z) = z \u2212 z\u2217,\nz \u2208 C, and then, for the resulting conjugate term,\nthe Green\u2019s function conjugation relation G\u2217ee(x, \u03c9, x\n\u2032) =\nGee(x,\u2212\u03c9, x\u2032) and the change of variables \u03c9 \u2212\u2192 \u2212\u03c9.\nThis allows us to express the first integral term as an\nintegral over the whole real axis.\nBy substituting different Green\u2019s function terms into\nthe first term in the result of Eq. (B7), it can be shown\nthat only the homogeneous space solution term of the\nGreen\u2019s function contributes to the result. Substituting\nthe homogeneous space solution term of the Green\u2019s func-\ntion into the first term in Eq. (B7), we obtain\n[A\u02c6(x, t), E\u02c6(x\u2032, t)]\n= \u2212 i~\npi\u03b50c2S\n\u222b \u221e\n\u2212\u221e\n\u03c9\u00b5(x\u2032, \u03c9)\nei\u03c9n(x\n\u2032,\u03c9)|x\u2212x\u2032|/c\n2\u03c9n(x\u2032, \u03c9)/c\nd\u03c9\n\u2212 i 2~\npi\u03b50c4S\n\u222b \u221e\n0\n\u222b \u221e\n\u2212\u221e\n\u03c93C(x, x\u2032, y, \u03c9)dyd\u03c9\n= \u2212 ~\n2pi2\u03b50c2S\n\u222b \u221e\n\u2212\u221e\n\u03c9\u00b5(x\u2032, \u03c9)\n\u222b \u221e\n\u2212\u221e\neik(x\u2212x\n\u2032)\nk2 \u2212 \u03c92n(x\u2032, \u03c9)2/c2 dkd\u03c9\n= \u2212 ~\n2pi2\u03b50S\n\u222b \u221e\n\u2212\u221e\neik(x\u2212x\n\u2032)\n\u222b \u221e\n\u2212\u221e\n\u03c9\u00b5(x\u2032, \u03c9)\nk2c2 \u2212 \u03c92n(x\u2032, \u03c9)2 d\u03c9dk\n\u2212 i 2~\npi\u03b50c4S\n\u222b \u221e\n0\n\u222b \u221e\n\u2212\u221e\n\u03c93C(x, x\u2032, y, \u03c9)dyd\u03c9\n= \u2212 i~\n\u03b50S\n1\n2pi\n\u222b \u221e\n\u2212\u221e\neik(x\u2212x\n\u2032)dk\n\u2212 i 2~\npi\u03b50c4S\n\u222b \u221e\n0\n\u222b \u221e\n\u2212\u221e\n\u03c93C(x, x\u2032, y, \u03c9)dyd\u03c9\n= \u2212 i~\n\u03b50S\n\u03b4(x\u2212x\u2032)\u2212i 2~\npi\u03b50c4S\n\u222b \u221e\n0\n\u222b \u221e\n\u2212\u221e\n\u03c93C(x, x\u2032, y, \u03c9)dyd\u03c9,\n(B8)\n10\nwhere we have applied the mathematical integral iden-\ntities in Eqs. (C11) and (C14) and the definition of the\nDirac delta function. From the final result, it follows that\nthe second term must be zero as the canonical commuta-\ntion relation is known to be given by [A\u02c6(x, t), E\u02c6(x\u2032, t)] =\n\u2212i~/(\u03b50S)\u03b4(x \u2212 x\u2032) [20, 29, 30]. Therefore, as the inte-\ngral of C(x, x\u2032, y, \u03c9) must give zero for all values of x and\nx\u2032 and as the position-dependence of C(x, x\u2032, y, \u03c9) comes\ndirectly from two linearly independent Green\u2019s functions\nas presented in Eq. (B4), we must have C1(y, \u03c9) =\nC2(y, \u03c9) = 0. This condition then fixes the values of\nthe normalization factors j0,e(x, \u03c9) and j0,m(x, \u03c9) to\nj0,e(x, \u03c9) =\n\u221a\n4pi~\u03c92\u03b50\u03b5i(x, \u03c9)/S, (B9)\nj0,m(x, \u03c9) =\n\u221a\n4pi~\u03c92\u00b50\u00b5i(x, \u03c9)/S, (B10)\nwhich are unique apart from the possible phase factors.\nAppendix C: Mathematical identities\n1. Green\u2019s function integral identities\nHere we derive the integral identities for the Green\u2019s\nfunction used in the final step in the evaluation of\nEq. (B3). The electric Green\u2019s function obeys the dif-\nferential equation in Eq. (9) which we write by renaming\nthe variables as\n\u2202\n\u2202y\n(\u2202Gee(y, \u03c9, x)\n\u00b5(y, \u03c9)\u2202y\n)\n+ k20\u03b5(y, \u03c9)Gee(y, \u03c9, x) = \u2212\u03b4(y \u2212 x).\n(C1)\nWe multiply this with the conjugated Green\u2019s function\nG\u2217ee(y, \u03c9, x\n\u2032) and integrate over y to obtain\n\u222b \u221e\n\u2212\u221e\nG\u2217ee(y, \u03c9, x\n\u2032)\n\u2202\n\u2202y\n(\u2202Gee(y, \u03c9, x)\n\u00b5(y, \u03c9)\u2202y\n)\ndy\n+ k20\n\u222b \u221e\n\u2212\u221e\n\u03b5(y, \u03c9)G\u2217ee(y, \u03c9, x\n\u2032)Gee(y, \u03c9, x)dy\n= \u2212G\u2217ee(x, \u03c9, x\u2032). (C2)\nHere, the first term can be integrated by parts accounting\nfor the fact that the boundary term becomes zero as the\nGreen\u2019s function is exponentially decaying in lossy media\nand lossless media can be studied in the limit of small\nlosses. Therefore, we get\n\u2212\n\u222b \u221e\n\u2212\u221e\n\u00b5\u2217(y, \u03c9)\n\u2202Gee(y, \u03c9, x)\n\u00b5(y, \u03c9)\u2202y\n\u2202G\u2217ee(y, \u03c9, x\n\u2032)\n\u00b5\u2217(y, \u03c9)\u2202y\ndy\n+ k20\n\u222b \u221e\n\u2212\u221e\n\u03b5(y, \u03c9)Gee(y, \u03c9, x)G\n\u2217\nee(y, \u03c9, x\n\u2032)dy\n= \u2212G\u2217ee(x, \u03c9, x\u2032). (C3)\nThe first term can be expressed in terms of the Green\u2019s\nfunction Gme(x, \u03c9, x\n\u2032) by using Eq. (13). Thus, we obtain\n\u2212 k20\n\u222b \u221e\n\u2212\u221e\n\u00b5\u2217(y, \u03c9)Gme(y, \u03c9, x)G\u2217me(y, \u03c9, x\n\u2032)dy\n+ k20\n\u222b \u221e\n\u2212\u221e\n\u03b5(y, \u03c9)Gee(y, \u03c9, x)G\n\u2217\nee(y, \u03c9, x\n\u2032)dy\n= \u2212G\u2217ee(x, \u03c9, x\u2032). (C4)\nBy applying the Green\u2019s function reciprocity rela-\ntions Gee(x, \u03c9, x\n\u2032) = Gee(x\u2032, \u03c9, x) and Gme(x, \u03c9, x\u2032) =\n\u2212Gem(x\u2032, \u03c9, x), we get\n\u2212 k20\n\u222b \u221e\n\u2212\u221e\n\u00b5\u2217(y, \u03c9)Gem(x, \u03c9, y)G\u2217em(x\n\u2032, \u03c9, y)dy\n+ k20\n\u222b \u221e\n\u2212\u221e\n\u03b5(y, \u03c9)Gee(x, \u03c9, y)G\n\u2217\nee(x\n\u2032, \u03c9, y)dy\n= \u2212G\u2217ee(x, \u03c9, x\u2032). (C5)\nTaking the imaginary part and switching the terms gives\nthe final result\nk20\n\u222b \u221e\n\u2212\u221e\n\u03b5i(y, \u03c9)Gee(x, \u03c9, y)G\n\u2217\nee(x\n\u2032, \u03c9, y)dy\n+ k20\n\u222b \u221e\n\u2212\u221e\n\u00b5i(y, \u03c9)Gem(x, \u03c9, y)G\n\u2217\nem(x\n\u2032, \u03c9, y)dy\n= Im[Gee(x, \u03c9, x\n\u2032)]. (C6)\nRespectively, for the magnetic Green\u2019s function, we ob-\ntain\nk20\n\u222b \u221e\n\u2212\u221e\n\u00b5i(y, \u03c9)Gmm(x, \u03c9, y)G\n\u2217\nmm(x\n\u2032, \u03c9, y)dy\n+ k20\n\u222b \u221e\n\u2212\u221e\n\u03b5i(y, \u03c9)Gme(x, \u03c9, y)G\n\u2217\nme(x\n\u2032, \u03c9, y)dy\n= Im[Gmm(x, \u03c9, x\n\u2032)]. (C7)\n2. Integral identity for k integration\nHere we derive the integral identity for k integration\nused in one of the intermediate steps in Eq. (B8). The\nintegrand in\n1\n2pii\n\u222b \u221e\n\u2212\u221e\neik(x\u2212x\n\u2032)\nk2 \u2212 \u03c92n2/c2 dk (C8)\nhas two poles at positions k = \u00b1\u03c9n/c. The pole with\npositive sign is located in the upper half of the complex\nk plane and the pole with negative sign is located in the\nlower half plane. When x > x\u2032 the integrand goes to zero\nin the upper half plane as k \u2192 \u221e. Therefore, by using\nthe residue theorem we obtain\n1\n2pii\n\u222b \u221e\n\u2212\u221e\neik(x\u2212x\n\u2032)\nk2 \u2212 \u03c92n2/c2 dk\n= Res\nk=\u03c9n/c\neik(x\u2212x\n\u2032)\nk2 \u2212 \u03c92n2/c2 =\nei\u03c9n(x\u2212x\n\u2032)/c\n2\u03c9n/c\n. (C9)\n11\nWhen x < x\u2032 the integrand, respectively, goes to zero in\nthe lower half of the complex plane as k \u2192 \u221e and, by\napplying the residue theorem, we obtain\n1\n2pii\n\u222b \u221e\n\u2212\u221e\neik(x\u2212x\n\u2032)\nk2 \u2212 \u03c92n2/c2 dk\n= \u2212 Res\nk=\u2212\u03c9n/c\neik(x\u2212x\n\u2032)\nk2 \u2212 \u03c92n2/c2 =\ne\u2212i\u03c9n(x\u2212x\n\u2032)/c\n2\u03c9n/c\n. (C10)\nThe two equations in Eqs. (C9) and (C10) can be com-\nbined to give the final result\n1\n2pii\n\u222b \u221e\n\u2212\u221e\neik(x\u2212x\n\u2032)\nk2 \u2212 \u03c92n2/c2 dk =\nei\u03c9n|x\u2212x\n\u2032|/c\n2\u03c9n/c\n. (C11)\n3. Integral identity for \u03c9 integration\nHere we derive the integral identity for \u03c9 integration\nused in one of the intermediate steps in Eq. (B8). The\nintegrand in \u222b \u221e\n\u2212\u221e\n\u03c9\u00b5(\u03c9)\nk2c2 \u2212 \u03c92n(\u03c9)2 d\u03c9 (C12)\nhas no poles in the upper half of the complex \u03c9 plane.\nThe integral along the real \u03c9 axis in Eq. (C12) is there-\nfore the negative of the integral around the semicircle at\ninfinity in the upper half plane, so putting \u03c9 = \u2126ei\u03d5, we\nobtain\n\u222b \u221e\n\u2212\u221e\n\u03c9\u00b5(\u03c9)\nk2c2 \u2212 \u03c92n(\u03c9)2 d\u03c9\n= \u2212 lim\n\u2126\u2192\u221e\n\u222b pi\n0\ni\u00b5(\u2126e2i\u03d5)\u21262e2i\u03d5\nk2c2 \u2212 \u21262n(\u2126e2i\u03d5)2e2i\u03d5 d\u03d5\n= i\n\u222b pi\n0\nd\u03d5 = ipi (C13)\nwhere we have applied the fact that material parameters\nare analytic functions of frequency and become unity at\nhigh frequencies. Thus, we have\n\u222b \u221e\n\u2212\u221e\n\u03c9\u00b5(\u03c9)\nk2c2 \u2212 \u03c92n(\u03c9)2 d\u03c9 = ipi. (C14)\n[1] V. J. Sorger and X. Zhang, Science 333, 709 (2011).\n[2] R. F. Oulton, V. J. Sorger, R. Zentgraf, R.-M. Ma,\nC. Gladden, L. Dai, G. Bartal, and X. Zhang, Nature\n461, 629 (2009).\n[3] L. Huang, X. Chen, H. Mu\u00a8hlenbernd, H. Zhang, S. Chen,\nB. Bai, Q. Tan, G. Jin, K.-W. Cheah, C.-W. Qiu, J. Li,\nT. Zentgraf, and S. Zhang, Nat. Commun. 4, 2808\n(2013).\n[4] T. Sadi, J. Oksanen, J. Tulkki, P. Mattila, and J. Bel-\nlessa, IEEE J. Sel. Top Quantum Electron. 19, 1 (2013).\n[5] T. Taubner, D. Korobkin, Y. Urzhumov, G. Shvets, and\nR. Hillenbrand, Science 313, 1595 (2006).\n[6] R. Hillenbrand, T. Taubner, and F. Keilmann, Nature\n418, 159 (2002).\n[7] S. Nakamura and M. Krames, Proc. IEEE 101, 2211\n(2013).\n[8] O. Heikkila\u00a8, J. Oksanen, and J. Tulkki, Appl. Phys. Lett.\n102, 111111 (2013).\n[9] P. Russell, Science 299, 358 (2003).\n[10] Y. Akahane, T. Asano, B. S. Song, and S. Noda, Nature\n425, 944 (2003).\n[11] K. Tanaka, E. Plum, J. Y. Ou, T. Uchino, and N. I.\nZheludev, Phys. Rev. Lett. 105, 227403 (2010).\n[12] N. Mattiucci, M. J. Bloemer, N. Ako\u00a8zbek, and\nG. D\u2019Aguanno, Sci. Rep. 3, 3203 (2013).\n[13] P. Shadbolt, J. C. F. Mathews, A. Laing, and J. L.\nO\u2019Brien, Nat. Phys. 10, 278 (2014).\n[14] K. Altmann, Opt. Express 23, 3731 (2015).\n[15] M. Partanen, T. Ha\u00a8yrynen, J. Oksanen, and J. Tulkki,\nPhys. Rev. A 89, 033831 (2014).\n[16] M. Partanen, T. Ha\u00a8yrynen, J. Oksanen, and J. Tulkki,\nPhys. Rev. A 90, 063804 (2014).\n[17] M. Partanen, T. Ha\u00a8yrynen, J. Tulkki, and J. Oksanen,\nPhys. Rev. A 92, 033839 (2015).\n[18] M. Partanen, T. Ha\u00a8yrynen, J. Oksanen, and J. Tulkki, in\nProc. SPIE 9136, Nonlinear Optics and Its Applications\nVIII; and Quantum Optics III, 91362B (SPIE, 2014).\n[19] M. G. Raymer and C. J. McKinstrie, Phys. Rev. A 88,\n043819 (2013).\n[20] S. M. Barnett, C. R. Gilson, B. Huttner, and N. Imoto,\nPhys. Rev. Lett. 77, 1739 (1996).\n[21] M. Ueda and N. Imoto, Phys. Rev. A 50, 89 (1994).\n[22] A. Aiello, Phys. Rev. A 62, 063813 (2000).\n[23] O. Di Stefano, S. Savasta, and R. Girlanda, Phys. Rev.\nA 61, 023803 (2000).\n[24] J. D. Jackson, Classical electrodynamics (Wiley, New\nYork, 1999).\n[25] J. E. Sipe, J. Opt. Soc. 4, 481 (1987).\n[26] K. Joulain, J.-P. Mulet, F. Marquier, R. Carminati, and\nJ.-J. Greffet, Surf. Sci. Rep. 57, 59 (2005).\n[27] A. Narayanaswamy and Y. Zheng, J. Quant. Spectrosc.\nRadiat. Transf. 132, 12 (2014).\n[28] A. G. Polimeridis, M. T. H. Reid, W. Jin, S. G. Johnson,\nJ. K. White, and A. W. Rodriguez, Phys. Rev. B 92,\n134202 (2015).\n[29] S. M. Barnett, R. Matloob, and R. Loudon, J. Mod.\nOpt. 42, 1165 (1995).\n[30] R. Matloob, R. Loudon, S. M. Barnett, and J. Jeffers,\nPhys. Rev. A 52, 4823 (1995).\n[31] K. Joulain, R. Carminati, J.-P. Mulet, and J.-J. Greffet,\nPhys. Rev. B 68, 245405 (2003).\n[32] A. Narayanaswamy and G. Chen, J. Quant. Spectrosc.\nRadiat. Transf. 111, 1877 (2010).\n[33] R. Loudon, The quantum theory of light (Oxford Univer-\nsity Press, Oxford, 2000).\n[34] C. F. Bohren and D. R. Huffman, Absorption and scat-\ntering of light by small particles (Wiley, Chichester, UK,\n1998).\n12\n[35] V. M. Shalaev, Nat. Photon. 1, 41 (2007).\n[36] P. Tighineanu, M. L. Andersen, A. S. S\u00f8rensen, S. Sto-\nbbe, and P. Lodahl, Phys. Rev. Lett. 113, 043601 (2014).\n[37] F. Marquier, K. Joulain, J.-P. Mulet, R. Carminati, J.-J.\nGreffet, and Y. Chen, Phys. Rev. B 69, 155412 (2004).\n",
      "id": 37639895,
      "identifiers": [
        {
          "identifier": "info:doi/10.1088%2f1361-6455%2faa5baa",
          "type": "OAI_ID"
        },
        {
          "identifier": "73407712",
          "type": "CORE_ID"
        },
        {
          "identifier": "oai:pure.atira.dk:publications/7145bb79-444a-470b-bb4f-799a27d85890",
          "type": "OAI_ID"
        },
        {
          "identifier": "oai:arxiv.org:1611.01226",
          "type": "OAI_ID"
        },
        {
          "identifier": "189595983",
          "type": "CORE_ID"
        },
        {
          "identifier": "10.1088/1361-6455/aa5baa",
          "type": "DOI"
        },
        {
          "identifier": "2553969947",
          "type": "MAG_ID"
        },
        {
          "identifier": "112373433",
          "type": "CORE_ID"
        },
        {
          "identifier": "1611.01226",
          "type": "ARXIV_ID"
        }
      ],
      "title": "Generalized noise terms for the quantized fluctuational electrodynamics",
      "language": {
        "code": "en",
        "name": "English"
      },
      "magId": "2553969947",
      "oaiIds": [
        "oai:pure.atira.dk:publications/7145bb79-444a-470b-bb4f-799a27d85890",
        "info:doi/10.1088%2f1361-6455%2faa5baa",
        "oai:arxiv.org:1611.01226"
      ],
      "publishedDate": "2017-01-01T00:00:00",
      "publisher": "'IOP Publishing'",
      "pubmedId": null,
      "references": [],
      "sourceFulltextUrls": [
        "http://arxiv.org/abs/1611.01226"
      ],
      "updatedDate": "2024-02-28T12:58:59",
      "yearPublished": 2017,
      "journals": [
        {
          "title": null,
          "identifiers": [
            "0953-4075"
          ]
        }
      ],
      "links": [
        {
          "type": "download",
          "url": "http://arxiv.org/abs/1611.01226"
        },
        {
          "type": "display",
          "url": "https://core.ac.uk/works/37639895"
        }
      ]
    },
    {
      "acceptedDate": "2014-04-09T00:00:00",
      "arxivId": "1408.2011",
      "authors": [
        {
          "name": "A Filinov"
        },
        {
          "name": "A Filinov"
        },
        {
          "name": "Anders W. Sandvik"
        },
        {
          "name": "AP Lyubartsev"
        },
        {
          "name": "AV Filinov"
        },
        {
          "name": "B Holst"
        },
        {
          "name": "D Hochstuhl"
        },
        {
          "name": "D.M. Ceperley"
        },
        {
          "name": "DM Ceperley"
        },
        {
          "name": "E Gull"
        },
        {
          "name": "H Haberland"
        },
        {
          "name": "HF Trotter"
        },
        {
          "name": "JS Tse"
        },
        {
          "name": "Karsten Balzer"
        },
        {
          "name": "KP Driver"
        },
        {
          "name": "M Bonitz"
        },
        {
          "name": "M Suzuki"
        },
        {
          "name": "M Troyer"
        },
        {
          "name": "M Troyer"
        },
        {
          "name": "MA Morales"
        },
        {
          "name": "N Metropolis"
        },
        {
          "name": "N.V. Prokofev"
        },
        {
          "name": "N.V. Prokofev"
        },
        {
          "name": "Proceedings of the conference. Strongly Coupled Coulomb systems"
        },
        {
          "name": "R Egger"
        },
        {
          "name": "R Redmer"
        },
        {
          "name": "T Nakamura"
        },
        {
          "name": "T Schoof"
        },
        {
          "name": "Trygve Helgaker"
        },
        {
          "name": "VS Filinov"
        }
      ],
      "citationCount": 0,
      "contributors": [
        "Michael",
        "Tim"
      ],
      "outputs": [
        "https://api.core.ac.uk/v3/outputs/186972495"
      ],
      "createdDate": "2014-10-24T19:28:35",
      "dataProviders": [
        {
          "id": 144,
          "name": "",
          "url": "https://api.core.ac.uk/v3/data-providers/144",
          "logo": "https://api.core.ac.uk/data-providers/144/logo"
        },
        {
          "id": 4786,
          "name": "",
          "url": "https://api.core.ac.uk/v3/data-providers/4786",
          "logo": "https://api.core.ac.uk/data-providers/4786/logo"
        }
      ],
      "depositedDate": "2014-01-01T00:00:00",
      "abstract": "In low-temperature high-density plasmas quantum effects of the electrons are\nbecoming increasingly important. This requires the development of new\ntheoretical and computational tools. Quantum Monte Carlo methods are among the\nmost successful approaches to first-principle simulations of many-body quantum\nsystems. In this chapter we present a recently developed method---the\nconfiguration path integral Monte Carlo (CPIMC) method for moderately coupled,\nhighly degenerate fermions at finite temperatures. It is based on the second\nquantization representation of the $N$-particle density operator in a basis of\n(anti-)symmetrized $N$-particle states (configurations of occupation numbers)\nand allows to tread arbitrary pair interactions in a continuous space.\n  We give a detailed description of the method and discuss the application to\nelectrons or, more generally, Coulomb-interacting fermions. As a test case we\nconsider a few quantum particles in a one-dimensional harmonic trap. Depending\non the coupling parameter (ratio of the interaction energy to kinetic energy),\nthe method strongly reduces the sign problem as compared to direct path\nintegral Monte Carlo (DPIMC) simulations in the regime of strong degeneracy\nwhich is of particular importance for dense matter in laser plasmas or compact\nstars. In order to provide a self-contained introduction, the chapter includes\na short introduction to Metropolis Monte Carlo methods and the second\nquantization of quantum mechanics.Comment: chapter in book \"Introduction to Complex Plasmas: Scientific\n  Challenges and Technological Opportunities\", Michael Bonitz, K. Becker, J.\n  Lopez and H. Thomsen (Eds.) Springer Series \"Atomic, Optical and Plasma\n  Physics\", vol. 82, Springer 2014, pp. 153-194 ISBN: 978-3-319-05436-0 (Print)\n  978-3-319-05437-7 (Online",
      "documentType": "research",
      "doi": "10.1007/978-3-319-05437-7_5",
      "downloadUrl": "http://arxiv.org/abs/1408.2011",
      "fieldOfStudy": null,
      "fullText": "Introduction to Configuration Path Integral\nMonte Carlo\nT. Schoof, S. Groth and M. Bonitz\nAbstract In low-temperature high-density plasmas quantum effects of the electrons\nare becoming increasingly important. This requires the development of new theoret-\nical and computational tools. Quantum Monte Carlo methods are among the most\nsuccessful approaches to first-principle simulations of many-body quantum systems.\nIn this chapter we present a recently developed method\u2014the configuration path in-\ntegral Monte Carlo (CPIMC) method for moderately coupled, highly degenerate\nfermions at finite temperatures. It is based on the second quantization representa-\ntion of the N-particle density operator in a basis of (anti-)symmetrized N-particle\nstates (configurations of occupation numbers) and allows to tread arbitrary pair in-\nteractions in a continuous space.\nWe give a detailed description of the method and discuss the application to elec-\ntrons or, more generally, Coulomb-interacting fermions. As a test case we consider\na few quantum particles in a one-dimensional harmonic trap. Depending on the\ncoupling parameter (ratio of the interaction energy to kinetic energy), the method\nstrongly reduces the sign problem as compared to direct path integral Monte Carlo\n(DPIMC) simulations in the regime of strong degeneracy which is of particular im-\nportance for dense matter in laser plasmas or compact stars. In order to provide a\nself-contained introduction, the chapter includes a short introduction to Metropolis\nMonte Carlo methods and the second quantization of quantum mechanics.\nT. Schoof\nKiel University, Department of Physics, Leibnizstr. 15 , Germany; e-mail: schoof@\ntheo-physik.uni-kiel.de\nS. Groth\nKiel University, Department of Physics, Leibnizstr. 15, Germany; e-mail: groth@\ntheo-physik.uni-kiel.de\nM. Bonitz\nKiel University, Department of Physics, Leibnizstr. 15, Germany; e-mail: bonitz@physik.\nuni-kiel.de\n1\nar\nX\niv\n:1\n40\n8.\n20\n11\nv1\n  [\nco\nnd\n-m\nat.\nsta\nt-m\nec\nh]\n  9\n A\nug\n 20\n14\n2 T. Schoof, S. Groth and M. Bonitz\n1 Introduction\nInteracting fermionic many-body systems are of great interest in many areas of\nphysics. These include atoms and molecules, electron gases in solids, partly ionized\nand dense plasmas in strong laser fields, and astro-physical plasma or the quark-\ngluon plasma [1, 2, 3, 4, 5, 6]. In these systems the quantum behavior of the electrons\n(and, at high density, also of the ions) plays an important role. Similar relevance of\nquantum effects is observed in low-temperature plasmas at atmospheric pressure, in\nparticular, when the plasma comes in contact with a solid surface. For the quantum\ntreatment of electrons in the latter case, see the chapter by Heinisch et al.\nThermodynamic properties of these system can only be calculated with huge dif-\nficulties if long range interactions as well as degeneracy of the quantum particles be-\ncome important. Many models and approximations exist, including quantum hydro-\ndynamics (QHD), cf. the chapter by Khan et al. in this book, but these are often in-\naccurate or not controllable. For that reason first-principle computer-simulation are\nof great importance. Among the most successful methods for the simulation of in-\nteracting many-body quantum systems are the density functional theory (DFT) [7],\nmany-body theories like, e.g. Green functions [8, 9, 10], and quantum Monte Carlo\n(QMC) methods. Nevertheless, the ab initio simulation of fermions is still an un-\nsolved problem.\nThe main idea of finite-temperature QMC methods is based on the description of\nthe system in terms of the Feynman path integral [11]. In this formulation a quan-\ntum system in thermodynamic equilibrium can be described by classical paths in\nan effective \u201cimaginary time\u201d. While, in principle, exact results can be obtained for\narbitrary large particle numbers for bosons [12, 13], Monte Carlo (MC) methods for\nfermions suffer from the so-called fermion sign problem [14, 15], which leads to\nexponentially increasing statistical errors in dependence of the particle number. The\nmathematical reason for this is the alternating sign of the terms that contribute to the\nexpectation values due to the antisymmetry of the fermionic wave function under\nparticle permutations. The physical origin is the Pauli principle. There exist several\napproaches to reduce or even avoid the sign problem. The fixed-nodes path integral\nMonte Carlo approximation can be considered as one of the most successful meth-\nods for highly degenerate systems like warm dense matter [16, 17, 18, 19]. It uses the\nknowledge about the nodal surface structure of a trial density matrix to completely\navoid the sign problem. However, the choice of the trial density matrix introduces\nsystematical errors that are difficult to estimate. Another approach is the multi-level-\nblocking algorithm [20]. Exact direct path integral Monte Carlo (DPIMC) calcula-\ntions are also possible with the use of several optimizations [21, 22] but this is\npossible only for sufficiently high temperature (moderate degeneracy).\nIn this chapter we will present a different approach\u2014the configuration path in-\ntegral Monte Carlo (CPIMC) method [23]. The main idea of this approach is to\nevaluate the path integral not in configuration space (as in DPIMC), but in second\nquantization. This leads to paths in Slater determinant space in occupation number\nrepresentation instead of paths in coordinate space. The idea is based on the continu-\nous time path integral method [24, 25], which is widely used for lattice models such\nIntroduction to Configuration Path Integral Monte Carlo 3\nas the Hubbard model, see [26], and for impurity models, see [27]. These models\nare described by simplified Hamiltonians where the interaction is typically of short-\nrange. However, for many systems, in particular plasmas, the long-range Coulomb\ninteraction is of central importance. In this chapter we will show how the CPIMC\nidea can be used to calculate thermodynamic properties of plasmas or, more gener-\nally, spatially continuous fermionic systems with arbitrary pair interactions.\nThe chapter will start with a short introduction to Metropolis Monte Carlo meth-\nods and an advanced description of the estimation of statistical errors. We will then\nintroduce the formalism of the second quantization as far it is needed to understand\nthe presented algorithm and give a short overview over the equations of statisti-\ncal quantum physics that describe the thermodynamics of the systems of interest\nin equilibrium. In the main part we will derive the underlying formulas of CPIMC\nin detail and give a complete description of the MC algorithm. At the end of the\nchapter a demonstrative application of the method to a one-dimensional system of\nCoulomb-interacting fermions in a harmonic trap will be discussed.\n2 Monte Carlo\nIn the first section of this chapter, the Metropolis algorithm, which has been de-\nveloped by Metropolis et. al. in 1953 [28], shall be explained in a fairly general\nform. The next section, where we will briefly illustrate how to estimate the error of\nquantities computed with the Metropolis algorithm, is based on [29]. We mention\nthat similar Monte Carlo methods are used also in the chapters by Thomsen et al.\n(classical Metropolis MC) and Rosenthal et al. (kinetic MC) of this book.\n2.1 Metropolis algorithm\nOur ultimate goal is the computation of thermodynamic properties of quantum\nmany-body systems in equilibrium. However, the following considerations are com-\npletely general and are valid for classical and quantum systems. In the classical case,\nwe only have to remove the operator heats of the observables. Regardless of the cho-\nsen ensemble, expectation values of observables O\u02c6 are always of the form\n\u3008O\u02c6\u3009=\n\u222b\n\u2211\nC\nO(C)\nW (C)\nZ\nwith Z =\n\u222b\n\u2211\nC\nW (C) . (1)\nThe partition function Z is given by the sum over all weights W (C), where the multi-\nvariable C defines exactly one contribution to the partition function, i.e. one specific\nweight. Moreover, we refer to the multi-variable C as a configuration or a microstate\nof the system. Such a configuration is generally defined by a set of discrete and/or\n4 T. Schoof, S. Groth and M. Bonitz\ncontinuous variables, which is why the symbol\n\u222b\n\u2211\nC\nwas introduced in (1) denoting\nthe integration or summation over all these variables. Further, O(C) denotes the\nvalue of the observable in the configuration C. We can interpret P(C) = W (C)Z as the\nprobability of the system to be in the configuration C if and only if the weights W (C)\nare always real and positive. Hence, the expectation value of an observable [Eq. (1)]\nis given by the sum over all possible values of the observable O(C) weighted with\nits corresponding probability.\nThe difference between classical and quantum systems as well as the choice of\nthe ensemble (microcanonical, canonical or grand canonical ensemble) enter in the\nactual form of the weights and in the set of variables necessary to define a configura-\ntion. [In Chap. 1 by Thomsen et al., Metropolis Monte Carlo of a classical system in\nthe canonical ensemble is described.] For a quantum system, the partition function\nis given by the trace over the N\u2212particle density operator \u03c1\u02c6 discussed in detail in\nSec. 4 below:\nZ = Tr \u03c1\u02c6 . (2)\nEach choice of a different basis in which the trace is performed leads to a differ-\nent Monte Carlo algorithm. For example, performing the trace in coordinate space\nresults in the DPIMC method [12], whereas the occupation number representation\nyields the CPIMC method described in Sec. 5 and [23].\nNow we will continue with the general consideration of the Metropolis algorithm\nfor quantum and classical systems. Using the Metropolis algorithm, one can gener-\nate a sequence of configurations Ci which are distributed with probability P(Ci).\nHowever, P(Ci) involves the partition function Z (normalization of the distribution),\nthat is typically very hard to compute. To avoid this problem, one defines a transition\nprobability v(Ci\u2192Ci+1) for the system that characterizes the transition into the con-\nfiguration Ci+1 starting from Ci. To ensure that the configurations Ci are distributed\nwith P(Ci), the transition probability has to fulfill the detailed balance condition1:\nP(Ci)v(Ci\u2192Ci+1) = P(Ci+1)v(Ci+1\u2192Ci) . (3)\nA possible solution of this equation is given by\nv(Ci\u2192Ci+1) = min\n[\n1,\nP(Ci+1)\nP(Ci)\n]\n= min\n[\n1,\nW (Ci+1)\nW (Ci)\n]\n. (4)\nNow the algorithm works as follows. Suppose the system is in the configuration Ci.\nA Monte Carlo step then consists of proposing a certain change of the configuration\nconverting it into Ci+1. After that, a random number from [0,1) is generated, and\nthe transition probability is calculated according to Eq. (4). If the random number\nis smaller than v(Ci\u2192Ci+1), then the change (Monte Carlo step) is accepted. Oth-\nerwise, the system stays in the previous configuration, i.e. it is Ci+1 = Ci. Starting\n1 In fact, there are weaker conditions on the transition probabilities, but in practice, one uses the\ndetailed balance.\nIntroduction to Configuration Path Integral Monte Carlo 5\nfrom an arbitrary configuration C0, after some steps, the configurations will be dis-\ntributed with P(C) forming a so-called Markov chain. We refer to the number of\nsteps which are necessary for the initial correlations to vanish as the equilibration\ntime.\nIn addition to the detailed balance, we have to make sure the transition probabil-\nities are ergodic, i.e. it must be possible to reach every configuration with W (C)> 0\nin a finite number of steps. In practice, one will usually need a few different Monte\nCarlo steps to ensure the ergodicity. These steps address different degrees of free-\ndom of the configurations, which, of course, depend on the actual form of the parti-\ntion function, Eq. (1). Furthermore, in the majority of cases, it will be more efficient\nnot to propose every change of the configuration with equal probability. Therefore,\nwe split the transition probability into a sampling probability T (Ci\u2192Ci+1) and an\nacceptance probability A(Ci\u2192Ci+1) for that specific change, i.e. it is\nv(Ci\u2192Ci+1) = A(Ci\u2192Ci+1)T (Ci\u2192Ci+1) . (5)\nInserting this factorization into the detailed balance, one readily obtains the solution\nfor the acceptance probability\nA(Ci\u2192Ci+1) = min\n[\n1,\nT (Ci+1\u2192Ci)W (Ci+1)\nT (Ci\u2192Ci+1)W (Ci)\n]\n. (6)\nThis generalization is also called the Metropolis Hastings algorithm. The algorithm\nis most efficient if the acceptance probability is about 50%. A suitable choice of the\nsampling probability can help optimizing the acceptance probability.\nOnce we have generated a Markov chain of length NMC via the Metropolis algo-\nrithm, a good estimator for the expectation value of an observable is given by\n\u3008O\u02c6\u3009 \u2248 1\nNMC\nNMC\n\u2211\ni=1\nO(Ci) =: O , (7)\nwhich directly follows from Eq. (1) and the fact that all configurations Ci in the\nMarkov chain are distributed with P(Ci).\nUnfortunately, the weight W (C) is not always strictly positive, so we can not\nalways interpret W (C)Z as a probability. Especially for systems of fermions, there\nare many sources of sign changes in the weights. However, we can still apply the\nMetropolis algorithm if we define a new partition function\nZ\u2032 :=\u2211\nC\n|W (C)| , (8)\nand rewrite the expectation values as follows:\n\u3008O\u02c6\u3009= \u2211C O(C)W (C)\n\u2211C W (C)\n=\n1\nZ\u2032 \u2211C O(C)S(C)|W (C)|\n1\nZ\u2032 \u2211C S(C)|W (C)|\n=\n\u3008O\u02c6S\u3009\u2032\n\u3008S\u3009\u2032 , (9)\n6 T. Schoof, S. Groth and M. Bonitz\nwhere S(C) = sgn[W (C)] denotes the sign of the weight. Obviously, the expectation\nvalue of O\u02c6 in the physical system, described by the partition function Z, is equivalent\nto the expectation value of O\u02c6S divided by the expectation value of the sign (average\nsign), both averaged in the primed system described by Z\u2032, cf. Eq. (8). For that\nsystem, we can generate a Markov chain if we simply insert the modulus of the\nweights |W (C)| in Eq. (6) when computing the acceptance probability. Combining\nEq. (7) and (9), we obtain an expression for the estimator of the observable in the\nreal system:\n\u3008O\u02c6\u3009 \u2248 \u2211\nNMC\ni=1 O(Ci)S(Ci)\n\u2211NMCi=01 S(Ci)\n=:\nOS \u2032\nS \u2032\n= O. (10)\nThus, we actually simulate the primed system and calculate quantities of the physi-\ncal system via Eq. (10).\n2.2 Error in the Monte Carlo simulation\nEstimating the errors of quantities computed with the Metropolis algorithm is not a\ntrivial task. First, we consider the case of strictly positive weights, where the estima-\ntor of an observable is given by Eq. (7). It is reasonable to interpret the values of the\nobservable in each configuration of the Markov chain as a series of measurements.\nThe estimator O, which is obtained by averaging over all measurements, fluctuates\nstatistically around the true expectation value \u3008O\u02c6\u3009. The error of the arithmetic mean\nof a measurement series of length NMC is defined by\n\u2206O =\n\u03c3O\u221a\nNMC\n, (11)\nwhere \u03c3O is the standard deviation which, for uncorrelated measurements, can be\nestimated by\n\u03c3O =\n\u221a\u221a\u221a\u221a 1\n(NMC\u22121)\nNMC\n\u2211\ni=0\n(Oi\u2212O)2 , with Oi = O(Ci). (12)\nCertainly, the \u201cmeasurement\u201d series obtained from the Markov chain is correlated,\nsince we generate each configuration from the previous one. The correlation of these\nconfigurations can be measured by the integrated auto-correlation time\n\u03c4int,O =\n1\n2\n+\nNMC\n\u2211\nk=1\nOiOi+k\u2212O2\n\u03c32O\u00af\n, (13)\nwith OiOi+k =\n1\nNMC\nNMC\n\u2211\ni=1\nOiOi+k .\nIntroduction to Configuration Path Integral Monte Carlo 7\nThe auto-correlation of the measurements enhances the statistical error by a factor\nof\n\u221a\n2\u03c4int,O, i.e. it is\n\u2206Oauto = \u2206O\n\u221a\n2\u03c4int,O =\n\u03c3O\u00af\u221a\nNMC\n\u221a\n2\u03c4int,O =\n\u03c3O\u00af\u221a\nNeff\n. (14)\nTherefore, if we have generated a Markov-chain of length NMC, we have effectively\ngained only NMC2\u03c4int,O uncorrelated measurements. To keep the correlation small, effi-\ncient Monte Carlo steps are essential, which change many degrees of freedom of\nthe configurations simultaneously while still having an acceptance ratio of about\n50%. In practice, acceptance ratios are much smaller than 50%, and one therefore\nperforms a certain number of Monte Carlo steps (a cycle) before again measuring\nthe observables.\nThings become more complex if the weights are not strictly positive. In that case,\nwe have expressed quantities of the physical system by quantities of the primed\nsystem, Eq. (10). We simulate the primed system and calculate the r.h.s. of Eq. (10)\nto obtain O. The measurements of the quantities OS \u2032 and S \u2032 are not only auto-\ncorrelated but also cross-correlated with each other. The relative statistical error can\nbe estimated according to (cf. [29])\n\u2206Oauto,cross\nO\n=\n\u221a\u221a\u221a\u221a(\u2206OS \u2032\nOS \u2032\n)2\n+\n(\n\u2206S \u2032\nS \u2032\n)2\n\u2212 2\nNMC\nOSS \u2032\u2212OS \u2032 S \u2032\nOS \u2032 S \u2032\n2\u03c4int,OS,S , (15)\nwhere we have the statistical errors of OS \u2032 and S \u2032\n\u2206OS \u2032 =\n\u221a\n(OS)2\n\u2032\u2212 (OS) \u2032\n2\nNMC\n2\u03c4int,OS ,\n\u2206S \u2032 =\n\u221a\nS2\n\u2032\u2212S \u2032 2\nNMC\n2\u03c4int,S , (16)\neach enhanced by their individual auto-correlation time and in the last term the\nintegrated cross-correlation time\n\u03c4int,OS,S =\n1\n2\n+\nNMC\n\u2211\nk=1\nOiSiSi+k\n\u2032\u2212OS \u2032 S \u2032\nOSS \u2032\u2212OS \u2032 S \u2032\n, with OiSiSi+k\n\u2032\n=\n1\nNMC\nNMC\n\u2211\ni=1\nOiSiSi+k .\nAssuming we are working in the canonical ensemble, then, from the definition of\nthe partition function and the average sign, cf. Eq. (9), it immediately follows that\nS \u2032 \u2248 \u3008S\u3009\u2032 = Z\nZ\u2032\n= e\u2212\u03b2N( f\u2212 f\n\u2032) \u2264 1 , (17)\nwhere \u03b2 is the inverse temperature, N the particle number, and f (\u2032) the free energy\nper particle in the physical (primed) system. Combining Eqs. (15) and (17) yields\n8 T. Schoof, S. Groth and M. Bonitz\n\u2206Oauto,sign\nO\n\u221d\n1\nS \u2032\n\u221a\nNMC\n\u2248 1\u221a\nNMC\ne\u03b2N( f\u2212 f\n\u2032) . (18)\nThe relative error of an observable grows exponentially with the product of the parti-\ncle number, the inverse temperature and the difference of the free energy per particle\nin the physical and the primed system. Unfortunately, the error can only be reduced\nwith the square root of the number of Monte Carlo samples (measurements). There-\nfore, the value of the average sign of a given system determines if one can compute\nreliable quantities via the Metropolis algorithm for that system. This severe limita-\ntion is called the (fermion) sign problem. In practice, an average sign of the order\n\u2248 10\u22123 is the limit for reliable Monte Carlo simulations. Also, one should be aware\nthat even the sign itself has a statistical error of the form (14). Besides, we note that\nthe proportionality (17) can be obtained by a simple Gaussian error propagation of\nO, cf. Eq. (10).\nThe sign problem is strongly dependent on the actual representation of the par-\ntition function, cf. Eq. (1). For some special systems, the sign problem can be cir-\ncumvented by a specific choice of the representation [30, 31], but a general solution\nis highly unlikely, since it has been shown to be NP-complete [15].\n3 Second quantization\nSecond quantization refers to the introduction of creation and annihilation opera-\ntors for the description of quantum many-particle systems. Thereby, not only the\nobservables are represented by operators but also the wave functions, in contrast\nto the standard formulation of quantum mechanics (correspondingly called \u201cfirst\u201d\nquantization), where only the observables are represented by operators. The proper\nsymmetry properties of the bosonic (fermionic) many-particle states are automati-\ncally included in the (anti-)commutation relations of the creation and annihilation\noperators. Simultaneously, also observables can be expressed by these operators.\nThis unifying picture of quantum mechanics is often advantageous when it comes\nto the description of many-particle systems.\nSince CPIMC makes extensive use of the second quantization of quantum me-\nchanics, a brief introduction will be given in this section, where we will focus on\nthose aspects which are necessary for the comprehension of the method. Especially\nthe derivation of the crucial Slater-Condon rules shall be outlined. For a detailed\nintroduction to the second quantization see e.g. [32].\n3.1 (Anti-)Symmetric many-particle states\nWe consider a system of N identical, ideal (i.e. not interacting) quantum particles\nwhich is described by the Hamiltonian H\u02c60. For an ideal system, the Hamiltonian can\nIntroduction to Configuration Path Integral Monte Carlo 9\nbe written as a sum of one-particle Hamiltonians:\nH\u02c60 =\nN\n\u2211\n\u03b1=1\nh\u02c6\u03b1 , (19)\nh\u02c6\u03b1 =\np\u02c62\u03b1\n2m\n+ v\u02c6\u03b1 , (20)\nwhere p\u02c6\u03b1 denotes the momentum operator and v\u02c6\u03b1 the operator of the potential en-\nergy of the particle \u03b1 in an external field. Thus, the subscript \u03b1 indicates that those\noperators are acting on states from the one-particle Hilbert spaceH\u03b1 of the particle\n\u03b1 . We imply that the solutions of the eigenvalue problem\nh\u02c6 |i\u3009= \u03b5i |i\u3009 , with i \u2208 N0 (21)\nare known. The one-particle states |i\u3009 form a complete orthonormal system (CONS)\nof the one-particle Hilbert space. Further, we assume the states are arranged accord-\ning to their one-particle energy, i.e. \u03b5i \u2264 \u03b5 j for all i\u2264 j. In general, the one-particle\nstates are spin orbitals, i.e. |i\u3009 \u2208Hcoord\u2297Hspin with the tensor product of the co-\nordinate and spin Hilbert space. Hence, the wave function \u3008r\u03c3 |i\u3009 = (\u3008r | \u3008\u03c3 |) |i\u3009 =\n\u03c6i(r,\u03c3) depends on both the coordinate r and the spin projection \u03c3 of the particle.\nIn the case of an ideal system, the solution of the N\u2212particle eigenvalue problem\nH\u02c60 |\u03a8\u3009= E |\u03a8\u3009 (22)\ncan be constructed from products of one-particle states:\n|i1i2 . . . iN\u3009= |i1\u30091 |i2\u30092 . . . |iN\u3009N . (23)\nThe many-body Hilbert space of N particlesH N =\n\u2297N\n\u03b1=1H\u03b1 is thus given by the\ntensor product of one-particle Hilbert spaces. The states |i1i2 . . . iN\u3009 form a basis of\nH N , and the used notation indicates that particle \u03b1 is in the state |i\u03b1\u3009.\nApart from some special exceptions as e.g. Axions, only totally symmetric or\nantisymmetric states with respect to arbitrary two-particle exchanges are physically\nrealized, i.e. states with\n|. . . i\u03b1 . . . i\u03b2 . . .\u3009\u00b1 =\u00b1|. . . i\u03b2 . . . i\u03b1 . . .\u3009 \u2200\u03b1,\u03b2 . (24)\nParticles that are described by symmetric states (upper sign) are called bosons and\nthose with antisymmetric states (lower sign) fermions. The reason for this sym-\nmetry of N\u2212particle states lies in the indistinguishability of the quantum particles,\nwhereby physical properties of the system cannot change under particle exchange.\nThe spin-statistics-theorem states that fermions have half-integer and bosons integer\nspin.\nTotally (anti-)symmetric states can be constructed from the product states (23)\nby summing up all N! permutations of N particles:\n10 T. Schoof, S. Groth and M. Bonitz\n|i1i2 . . . iN\u3009\u00b1 =\n1\nN \u2211P\u2208SN\n(\u00b11)PP\u02c6 |i1\u30091 |i2\u30092 . . . |iN\u3009N , (25)\nwhere P\u02c6 is the N\u2212particle permutation operator that can be constructed from a\ncomposition of two-particle exchanges. The normalization factorN is given by\nN =\n\uf8f1\uf8f2\uf8f3\n\u221a\nN!\u220f\u221ei=0 ni , for bosons,\n\u221a\nN! , for fermions,\n(26)\nwhere ni denotes the number of one-particle states |i\u3009 in the product state. The her-\nmitian operator S\u02c6(A\u02c6)\nS\u02c6/A\u02c6 =\n1\nN \u2211P\u2208SN\n(\u00b11)PP\u02c6 , (27)\nis referred to as the (anti-)symmetrization operator. For fermions, the sign of each\nsummand is determined by the number of two-particle exchanges P in the permuta-\ntion operator P\u02c6 . Further, arbitrary (anti-)symmetric states can be constructed from\nlinear combinations of these (anti-)symmetric states, Eq. (25). Therefore, they form\na basis in the (anti-)symmetric Hilbert spaceH N\u00b1 \u2282H N . The operator (N /N!)S\u02c6 or\n(N /N!)A\u02c6 is a projection operator on the respective subspace, it is S\u02c62 = (N!/N )S\u02c6\nand A\u02c62 = (N!/N )A\u02c6, respectively and also S\u02c6A\u02c6 = 0.\nIn coordinate-spin representation, the anti-symmetric product states of fermions\ncan be written as determinants (called Slater determinants):\n\u03a8(x1, . . . ,xN)\u2212 =\n1\nN!\n\u2223\u2223\u2223\u2223\u2223\u2223\u2223\u2223\u2223\n\u03c6i1(x1) \u03c6i2(x1) \u00b7 \u00b7 \u00b7 \u03c6iN (x1)\n\u03c6i1(x2) \u03c6i2(x2) \u00b7 \u00b7 \u00b7 \u03c6iN (x2)\n...\n...\n...\n\u03c6i1(xN) \u03c6i2(xN) \u00b7 \u00b7 \u00b7 \u03c6iN (xN)\n\u2223\u2223\u2223\u2223\u2223\u2223\u2223\u2223\u2223 . (28)\nFor bosons, one obtains instead permanents. From this representation of antisym-\nmetric states it becomes obvious that there is none with a one-particle state occurring\ntwice in the product state, for a determinant with two equal columns vanishes. This\nis also known as the famous Pauli principle. For bosons, there is no such restriction.\n3.2 Occupation number representation\nDue to the (anti-)symmetrization of the many-particle states (25), such states are\nentirely characterized by the occurrence frequency of each one-particle state in the\nproduct state. The number of particles ni in the one-particle state |i\u3009 is called the\noccupation number (of the i-th state/orbital). Since the complete set of occupation\nnumbers, denoted with {n}, defines an (anti-)symmetric many-particle state, we can\nIntroduction to Configuration Path Integral Monte Carlo 11\nalso write\n|i1 . . . iN\u3009\u00b1 \u2261 |n0n1n2 . . .\u3009=: |{n}\u3009 , (29)\nwith\nni \u2208\n{\nN0 , for bosons\n{0,1} , for fermions .\nThe order of the occupation numbers equals the order of the one-particle states in the\nproduct state, which can be arbitrary but must remain fixed for further calculations.\nThe Pauli principle for fermions is automatically included in the restriction on the\noccupation numbers to be either zero or one.\nIf we only consider many-particle states with fixed particle number, N =\u2211\u221ei=0 ni,\nthen the states |{n}\u3009 form a CONS of the (anti-)symmetric N\u2212particle Hilbert space\nN N\u00b1 with the orthogonality relation\n\u3008{n}|{n\u00af}\u3009=\n\u221e\n\u220f\ni=0\n\u03b4ni,n\u00afi =: \u03b4{n},{n\u00af} , (30)\nand the completeness relation\n\u2211\n{n}\n|{n}\u3009\u3008{n}|\u03b4\u2211i ni,N = 1\u02c6N . (31)\nTo shorten the notation, we introduced the following abbreviation:\n\u2211\n{n}\n:=\n\uf8f1\uf8f2\uf8f3\u2211\n\u221e\nn0=0\u2211\n\u221e\nn1=0 \u00b7 \u00b7 \u00b7 , for bosons\n\u22111n0=0\u2211\n1\nn1=0 \u00b7 \u00b7 \u00b7 , for fermions\n. (32)\nIn practical simulations, one has to work with a finite number of one-particle orbitals\nNB. This equals the approximation\n\u2211\n{n}\n\u2248\n\uf8f1\uf8f2\uf8f3\u2211\n\u221e\nn0=0\u2211\n\u221e\nn1=0 \u00b7 \u00b7 \u00b7\u2211\u221enNB=0, for bosons\n\u22111n0=0\u2211\n1\nn1=0 \u00b7 \u00b7 \u00b7\u22111nNB=0, for fermions\n. (33)\nGiven a certain one-particle basis, each antisymmetric state |{n}\u3009 can be uniquely\nidentified with a Slater determinant (28). The relations (30) and (31) are consistent\nwith the respective relations for determinants. For that reason, it is common to also\nrefer to the states |{n}\u3009 as Slater determinants.\nNow we drop the restriction of a fixed number of particles. The inner product\nin Eq. (30) is still well defined for states with different particle numbers; only the\ncompleteness relation is slightly modified\n12 T. Schoof, S. Groth and M. Bonitz\n\u2211\n{n}\n|{n}\u3009\u3008{n}|= 1\u02c6 . (34)\nThe states |{n}\u3009 thereby form a CONS in the so-called Fock space F\u00b1 =H 0\u2295\nH 1\u2295H 2\u00b1 . . ., which contains (anti-)symmetric states of varying particle number.\nConsequently, any state of the Fock space can be written as a linear combination of\nthe Slater determinants |{n}\u3009:\n|\u03a8\u3009=\u2211\n{n}\nc{n} |{n}\u3009 . (35)\nFor example, if we consider a general Hamiltonian of interacting particles\nH\u02c6 = H\u02c60+W\u02c6 , (36)\nwhere we added the interaction operator W\u02c6 to the ideal Hamiltonian H\u02c60, then the\nsolution |\u03a8\u3009 of the eigenvalue problem\nH\u02c6 |\u03a8\u3009= E |\u03a8\u3009 , (37)\ncan in general not be written in terms of a single Slater determinant |{n}\u3009 but will\nbe of the form (35). Besides, those states do not necessarily have a defined particle\nnumber. Furthermore, the Slater determinant without any particles |00 . . .\u3009 = |{0}\u3009\nis the vacuum state that is normalized to one according to Eq. (30) and also belongs\nto the Fock space (The vacuum state should not be confused with the zero vector).\nFinally, we could have chosen any arbitrary, complete one-particle set {|\u03bd\u3009} in\nthe definition of the states |{n}\u3009, cf. Eq. (29). Since from the states |{n}\u3009 it is not\nclear which one-particle basis has been used for the quantization, one usually has to\nexplicitly specify the chosen basis.\n3.3 Creation and annihilation operators\nThe introduction of creation and annihilation operators, which induce transitions be-\ntween states of different particle number, is of crucial importance for the formalism\nof the second quantization. Originally, these operators have been constructed for the\ndescription of the harmonic oscillator (so-called ladder operators). In the following\nbosons and fermions will be treated separately.\n3.3.1 Bosons\nIn the bosonic case, the action of the creation and annihilation operators on sym-\nmetric states in the occupation number representation is defined by\nIntroduction to Configuration Path Integral Monte Carlo 13\na\u02c6\u2020i |n0n1 . . .ni . . .\u3009=\n\u221a\nni+1 |n0n1 . . .ni+1 . . .\u3009 , (38)\na\u02c6i |n0n1 . . .ni . . .\u3009=\n\u221a\nni |n0n1 . . .ni\u22121 . . .\u3009 , (39)\nwhere the prefactors ensure the correct normalization. Apparently, the annihilation\noperator vanishes for ni = 0. Hence, the creation and annihilation operators are not\nhermitian but pairwise adjoint. The bosonic creation and annihilation operators ful-\nfill the commutation relations\n[a\u02c6\u2020i , a\u02c6\n\u2020\nj ] = [a\u02c6i, a\u02c6 j] = 0,\n[a\u02c6i, a\u02c6\n\u2020\nj ] = \u03b4i, j , (40)\nwith the commutator [A\u02c6, B\u02c6] = A\u02c6B\u02c6\u2212B\u02c6A\u02c6. Using the creation operator, we can construct\narbitrary states of the form (29):\n|{n}\u3009= 1\u221a\n\u220fi ni!\n( \u221e\n\u220f\ni=0\n(a\u02c6\u2020i )\nni\n)\n|{0}\u3009 . (41)\nOf particular interest is the hermitian occupation number operator of the i\u2212th orbital\nn\u02c6i = a\u02c6\n\u2020\ni a\u02c6i . (42)\nIts action is given by\nn\u02c6i |{n}\u3009= ni |{n}\u3009 , (43)\nand the eigenvalues are simply the occupation numbers ni of the i\u2212th orbital. Simi-\nlarly, we have the total particle number operator\nN\u02c6 =\n\u221e\n\u2211\ni=0\nn\u02c6i , (44)\nwith the total particle number N of the state as its eigenvalue\nN\u02c6 |{n}\u3009= N |{n}\u3009 . (45)\nConsequently, the states |{n}\u3009 are common eigenstates of the occupation number\noperator, the particle number operator and the ideal Hamilton operator (if we choose\nthe ideal one-particle basis (21) for the quantization).\n3.3.2 Fermions\nFor fermions, the states have to be antisymmetric. A definition of the fermionic\ncreation and annihilation operators which satisfies this condition is given by\n14 T. Schoof, S. Groth and M. Bonitz\na\u02c6\u2020i |{n}\u3009= (1\u2212ni)(\u22121)\u03b1{n},i |. . . ,ni+1, . . .\u3009 ,\na\u02c6i |{n}\u3009= ni(\u22121)\u03b1{n},i |. . . ,ni\u22121, . . .\u3009 , (46)\nwhere the sign is determined by\n\u03b1{n},i =\ni\u22121\n\u2211\nl=0\nnl . (47)\nThe sign is positive if the number of particles in the one-particle states before the\ni\u2212th state is even (with respect to the chosen order) and negative if it is odd. Further,\nthe prefactors ensure that the creation (annihilation) operator vanishes if the orbital i,\nwhere the particle shall be created (annihilated), is already occupied (unoccupied),\nand so the definition also includes the Pauli principle. In contrast to the bosonic\ncommutation relations, for fermions, the creation and annihilation operators fulfill\nthe three anti-commutation relations:\n{a\u02c6\u2020i , a\u02c6\u2020j}= {a\u02c6i, a\u02c6 j}= 0 ,\n{a\u02c6i, a\u02c6\u2020j}= \u03b4i, j (48)\nwith the anti-commutator being defined as {A\u02c6, B\u02c6} = A\u02c6B\u02c6+ B\u02c6A\u02c6. When it comes to\nthe algebraic treatment of physical systems, the only difference between the second\nquantization for bosons and for fermions lies in the difference of the commutation\nrelation (40) and anticommutation relation (48). For example, from the first anti-\ncommutation relation directly follows that (a\u02c6\u2020i )\n2 = 0, i.e. doubly occupied orbitals\ndo not exist in the case of fermions. As a consequence of the non-commutativity of\nthe fermionic creation and annihilation operators, we have to make sure the ordering\nof the creation operators equals the chosen order of the orbitals when constructing\nan arbitrary state from the vacuum states according to\n|{n}\u3009=\n( \u221e\n\u220f\ni=0\n(a\u02c6\u2020i )\nni\n)\n|{0}\u3009 . (49)\nThe formulas for the occupation number operator and the particle number operator\n(42)-(44) remain unchanged for fermions.\nFor further calculations, we will need the matrix elements of the creation and\nannihilation operators\n\u3008{n}|a\u02c6\u2020k |{n\u00af}\u3009= (\u22121)\u03b1{n},k\u03b4 k{n},{n\u00af}\u03b4nk,1\u03b4nk,n\u00afk+1 ,\n\u3008{n}|a\u02c6k|{n\u00af}\u3009= (\u22121)\u03b1{n},k\u03b4 k{n},{n\u00af}\u03b4nk,0\u03b4nk,n\u00afk\u22121 ,\n\u03b4 k{n},{n\u00af} : =\n\u221e\n\u220f\ni=0\ni 6=k\n\u03b4ni,n\u00afi . (50)\nIntroduction to Configuration Path Integral Monte Carlo 15\nThese follow directly from the definitions (46). Evidently, the creation and annihila-\ntion operators are defined with respect to a certain one-particle basis {|i\u3009}, the basis\nthat we chose for the quantization. The transformation of the creation and annihila-\ntion operators to a different basis {|\u03bd\u3009} can be performed as follows:\na\u02c6\u2020\u03bd =\n\u221e\n\u2211\ni=0\n\u3008i|\u03bd\u3009 a\u02c6\u2020i , (51)\na\u02c6\u03bd =\n\u221e\n\u2211\ni=0\n\u3008\u03bd |i\u3009 a\u02c6i . (52)\nFor example, choosing spin-coordinate space for the quantization, i.e. |\u03bd\u3009= |x\u3009 ,x=\n{r,\u03c3}, leads to the so-called field operators\n\u03a8\u02c6 \u2020(x) := a\u02c6\u2020x =\n\u221e\n\u2211\ni=0\n\u3008i|x\u3009 a\u02c6\u2020i =\n\u221e\n\u2211\ni=0\n\u03c6 \u2217i (x)a\u02c6\n\u2020\ni , (53)\n\u03a8\u02c6(x) := a\u02c6x =\n\u221e\n\u2211\ni=0\n\u3008x|i\u3009 a\u02c6i =\n\u221e\n\u2211\ni=0\n\u03c6i(x)a\u02c6i . (54)\nThe field operator \u03a8\u02c6 \u2020(x) creates and \u03a8\u02c6(x) annihilates a particle at the space point r\nwith spin projection \u03c3 .\n3.4 Operators in second quantization\nArbitrary first quantized operators can be expressed in the second quantization via\nthe creation and annihilation operators. In the following, we will consider this rep-\nresentation for the one- and two-particle operators. For fermions, in particular, we\nwill give the expressions for the corresponding matrix elements of the interaction\npotential, which leads to the Slater-Condon-rules.\n3.4.1 One-particle operators\nThough somewhat misleadingly, it is common to refer to the N\u2212particle operator\nB\u02c61 =\u2211\n\u03b1\nb\u02c6\u03b1 , (55)\nthat is a sum of true one-particle operators b\u02c6\u03b1 as a \u201cone-particle operator\u201d, too. In\nsecond quantization, that operator takes the following form:\nB\u02c61 =\n\u221e\n\u2211\ni, j=1\nbi ja\u02c6\n\u2020\ni a\u02c6 j, (56)\n16 T. Schoof, S. Groth and M. Bonitz\nwith the one-particle integrals\nbi j = \u3008i|b\u02c6| j\u3009=\n\u222b\ndx\u03c6 \u2217i (x)b(x)\u03c6 j(x) , (57)\nwhere the integration over x = {r,\u03c3} includes an integration over the space coordi-\nnate and a summation over the spin. As usual, we have assumed local operators in\ncoordinate space. From the matrix elements of the creation and annihilation opera-\ntors (50), we readily obtain the matrix elements of the one-particle operators (56):\n\u3008{n}|a\u02c6\u2020l a\u02c6k|{n\u00af}\u3009= \u2211\n{n\u2032}\n\u3008{n}|a\u02c6\u2020l |{n\u2032}\u3009\u3008{n\u2032}|a\u02c6k|{n\u00af}\u3009\n= \u2211\n{n\u2032}\n(\u22121)\u03b1{n\u2032},l+\u03b1{n\u00af},k\u03b4 l{n},{n\u2032}\u03b4 k{n\u2032},{n\u00af}\u03b4n\u2032l ,0\u03b4nl ,1\u03b4n\u00afk,1\u03b4n\u2032k,0 . (58)\nVia case differentiation we can simplify this to\n\u3008{n}|a\u02c6\u2020l a\u02c6k|{n\u00af}\u3009=\n{\n(\u22121)\u03b1{n},l+\u03b1{n\u00af},k\u03b4 kl{n},{n\u00af}\u03b4nl ,1\u03b4n\u00afk,1\u03b4n\u00afl ,0\u03b4nk,0, k 6= l\nnl\u03b4{n},{n\u00af}, k = l\n. (59)\nInserting this into Eq. (56) and rearranging the sums with respect to terms with k = l\nand k 6= l yields\n\u3008{n}|B\u02c61|{n\u00af}\u3009= \u03b4{n},{n\u00af}\n\u221e\n\u2211\nk=0\nbkknk\n+\n\u221e\n\u2211\nk=1\n\u221e\n\u2211\nl=1\nl 6=k\nblk(\u22121)\u03b1{n},l+\u03b1{n\u00af},k\u03b4 kl{n},{n\u00af}\u03b4nl ,1\u03b4n\u00afk,1\u03b4n\u00afl ,0\u03b4nk,0 . (60)\nThe first term only gives a contribution if both Slater determinants are equal; thus,\nthese are the diagonal elements of the matrix. The second term does not vanish only\nif the right and left state differ in exactly two occupation numbers while conserving\nthe total particle number.\nLet |{n}pq\u3009 be the N\u2212particle state that one obtains from the state |{n}\u3009 if one\nparticle is removed from the q\u2212th orbital and added to the p\u2212th orbital, i.e. for\nq < p it is\n|{n}pq\u3009= |. . . ,nq\u22121, . . . ,np+1, . . .\u3009 . (61)\nUsing this notation, we can rewrite the matrix elements of a one-particle operator of\nthe form (56) in a compact way:\nIntroduction to Configuration Path Integral Monte Carlo 17\n\u3008{n}|B\u02c61|{n\u00af}\u3009=\n\uf8f1\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f2\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f3\n\u221e\n\u2211\nk=1\nbkknk, {n}= {n\u00af}\nbpq(\u22121)\nmax(p,q)\u22121\n\u2211\nl=min(p,q)+1\nnl\n, {n}= {n\u00af}pq\n0, else\n. (62)\nThereby, we have expressed the matrix elements of a second quantized one-particle\noperator (56) by the one-particle integrals (57).\n3.4.2 Two-particle operators\nIn analogy to the one-particle operators, general two-particle operators of the form\nB\u02c62 = 12 \u2211\nN\n\u03b1 6=\u03b2=1 b\u02c6\u03b1,\u03b2 take the following form in second quantization:\nB\u02c62 =\n1\n2\n\u221e\n\u2211\ni, j,k,l=1\nbi jkl a\u02c6\n\u2020\ni a\u02c6\n\u2020\nj a\u02c6l a\u02c6k . (63)\nNote the exchange of the orbital indices of the annihilation operators and the two-\nparticle integrals, which is important for fermions due to the non-commutativity of\nthe creation and annihilation operators. The two-particle integrals are given by\nbi jkl = \u3008i j|b\u02c6|kl\u3009=\n\u222b\ndx\n\u222b\ndy\u03c6 \u2217i (x)\u03c6\n\u2217\nj (y)b(x,y)\u03c6k(x)\u03c6l(y) . (64)\nThe following considerations are restricted to fermions only. For the most interesting\ncase of the pair interaction operator W\u02c6 , one can take advantage of the fact that the\ninteraction is symmetric under particle exchange, i.e. w(x,y) = w(y,x), and real, i.e.\nw\u2217(x,y) = w(x,y). Hence, for the two-particle integrals, we have\nwi jkl = w jilk , (65)\nw\u2217i jkl = wkli j . (66)\nUsing these symmetries, we can bring the interaction operator into a more suitable\nform:\nW\u02c6 =\n\u221e\n\u2211\ni=1\n\u221e\n\u2211\nj=i+1\n\u221e\n\u2211\nk=1\n\u221e\n\u2211\nl=k+1\nw\u2212i jkl a\u02c6\n\u2020\ni a\u02c6\n\u2020\nj a\u02c6l a\u02c6k , (67)\nwhere we have introduced the antisymmetric two-particle integrals w\u2212i jkl = wi jkl \u2212\nwi jlk. Obviously, there are only terms with i < j and k < l. Therefore, we end up\nwith six different cases to be considered:\n18 T. Schoof, S. Groth and M. Bonitz\nW\u02c6 = \u2211\ni=1\n\u2211\nj=i+1\nw\u2212i ji j a\u02c6\n\u2020\nj a\u02c6\n\u2020\ni a\u02c6ia\u02c6 j +\u2211\ni=1\n\u2211\nj=i+1\n\u2211\nl=i+1\nl 6= j\nw\u2212i jil a\u02c6\n\u2020\nj a\u02c6\n\u2020\ni a\u02c6ia\u02c6l\n+\u2211\ni=1\n\u2211\nj=i+1\nj\u22121\n\u2211\nk=1\nk 6=i\nw\u2212i jk j a\u02c6\n\u2020\nj a\u02c6\n\u2020\ni a\u02c6ka\u02c6 j +\u2211\ni=1\n\u2211\nj=i+1\ni\u22121\n\u2211\nk=1\nw\u2212i jki a\u02c6\n\u2020\nj a\u02c6\n\u2020\ni a\u02c6ka\u02c6i\n+\u2211\ni=1\n\u2211\nj=i+1\n\u2211\nl= j+1\nw\u2212i j jl a\u02c6\n\u2020\nj a\u02c6\n\u2020\ni a\u02c6 ja\u02c6l +\u2211\ni=1\n\u2211\nj=i+1\n\u2211\nk=1\nk 6=i, j\n\u2211\nl=k+1\nl 6=i, j\nw\u2212i jkl a\u02c6\n\u2020\nj a\u02c6\n\u2020\ni a\u02c6ka\u02c6l . (68)\nFor each of these cases, one readily computes the matrix elements \u3008{n}|a\u02c6\u2020j a\u02c6\u2020i a\u02c6ka\u02c6l |{n\u00af}\u3009.\nRearranging of the terms finally yields\n\u3008{n}|W\u02c6 |{n\u00af}\u3009= \u03b4{n},{n\u00af}\n\u221e\n\u2211\ni=1\n\u221e\n\u2211\nj=i+1\nw\u2212i ji jnin j\n+\n\u221e\n\u2211\np=1\n\u221e\n\u2211\nq=1\n\u03b4 pq{n},{n\u00af}\u03b4np,1\u03b4n\u00afp,0\u03b4nq,0\u03b4n\u00afq,1\n\u00b7\n\u221e\n\u2211\ni=1\nw\u2212ipiq(\u22121)\u03b1{n},i+\u03b1{n\u00af},i+\u03b1{n},p+\u03b1{n\u00af},q\u0398(i, p,q)ni\n+\n\u221e\n\u2211\np=1\n\u221e\n\u2211\nq=p+1\n\u221e\n\u2211\nr=1\n\u221e\n\u2211\ns=r+1\n\u03b4 pqrs{n},{n\u00af}\u03b4np,1\u03b4n\u00afp,0\u03b4nq,1\u03b4n\u00afq,0\u03b4nr ,0\u03b4n\u00afr ,1\u03b4ns,0\u03b4n\u00afs,1\n\u00b7w\u2212pqrs(\u22121)\u03b1{n},p+\u03b1{n},q+\u03b1{n\u00af},r+\u03b1{n\u00af},s ,\n(69)\nwith\n\u0398(i, p,q) =\n\uf8f1\uf8f4\uf8f2\uf8f4\uf8f3\n\u22121, p < i < q, or q < i < p\n0, i = p or i = q\n1, else\n. (70)\nThus, there are three different contributions to the matrix elements. These are the\nSlater-Condon-rules [32], which can be rewritten as follows:\nIntroduction to Configuration Path Integral Monte Carlo 19\nW\u02c6{n},{n\u00af} := \u3008{n}|W\u02c6 |{n\u00af}\u3009= W\u02c6 I{n},{n\u00af}+W\u02c6 II{n},{n\u00af}+W\u02c6 III{n},{n\u00af} ,\nW\u02c6 I{n},{n\u00af} = \u03b4{n},{n\u00af}\n\u221e\n\u2211\ni=0\n\u221e\n\u2211\nj=i+1\nw\u2212i ji jnin j ,\nW\u02c6 II{n},{n\u00af} =\n\u221e\n\u2211\np,q=1\n\u03b4 pq{n},{n\u00af}\u03b4np,1\u03b4n\u00afp,0\u03b4nq,0\u03b4n\u00afq,1 \u2211\ni=0\ni 6=p,q\nw\u2212ipiq(\u22121)\u2211\nmax(p,q)\u22121\nl=min(p,q)+1 nl ni ,\nW\u02c6 III{n},{n\u00af} =\n\u221e\n\u2211\np=1\n\u221e\n\u2211\nq=p+1\n\u221e\n\u2211\nr=1\n\u221e\n\u2211\ns=r+1\n\u03b4 pqrs{n},{n\u00af}\u03b4np,1\u03b4n\u00afp,0\u03b4nq,1\u03b4n\u00afq,0\u03b4nr ,0\u03b4n\u00afr ,1\u03b4ns,0\u03b4n\u00afs,1\n\u00b7w\u2212pqrs(\u22121)\u2211\nq\u22121\nl=p nl+\u2211\ns\u22121\nl=r n\u00afl .\n(71)\nThe first term only gives a contribution if both states are equal and the second if\nleft and right state differ in exactly two orbitals. In contrast, the third term is not\nvanishing only if both states differ in exactly four orbitals. In all cases, the left and\nright state must have the same particle number. All other matrix elements vanish.\nCollecting the obtained results, we finally end up with\n\u3008{n}|W\u02c6 |{n\u00af}\u3009=\n\uf8f1\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f2\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f3\n\u2211\u221ei=0\n\u221e\n\u2211\nj=i+1\nw\u2212i ji jnin j, {n}= {n\u00af}\n\u2211 i=0\ni 6=p,q\nw\u2212ipiq(\u22121)\u2211\nmax(p,q)\u22121\nl=min(p,q)+1 nl ni, {n}= {n\u00af}pq\nw\u2212pqrs(\u22121)\u2211\nq\u22121\nl=p nl+\u2211\ns\u22121\nl=r n\u00afl , {n}= {n\u00af}p<qr<s\n0, else\n. (72)\nThereby, |{n}p<qr<s \u3009 is the N\u2212particle state that one obtains from |{n}\u3009 if a particle is\nadded to the orbitals |p\u3009 and |q\u3009 each, with p < q, and removed from the orbitals |r\u3009\nand |s\u3009, with r < s.\n4 The density operator\nThe density operator \u03c1\u02c6 is of extreme importance for the description of thermody-\nnamic properties of quantum many-particle systems. While in standard quantum\nmechanics a quantum system is described by a certain state |\u03a8\u3009, this does not apply\nto a quantum system at a finite temperature (e.g. a system in a thermostate). In this\ncase, in principle, all possible states may be observed with a certain probability, i.e.\nthe system is in an ensemble of states or in a \u201cmixed state\u201d. For an ensemble of\npossible many-particle states {|\u03a8i\u3009}, the density operator (which replaces the wave\nfunction in the previous case of a \u201cpure\u201d state) is defined as\n\u03c1\u02c6 =\u2211\ni\nP(|\u03a8i\u3009) |\u03a8i\u3009\u3008\u03a8i| . (73)\n20 T. Schoof, S. Groth and M. Bonitz\nThe sum goes over all states of the ensemble, and P(|\u03a8i\u3009) is the real, positive prob-\nability to observe the state |\u03a8i\u3009. The matrix representation of \u03c1\u02c6 in an arbitrary N-\nparticle basis {|\u03a6i\u3009} is called the density matrix \u3008\u03a6 |\u03c1\u02c6|\u03a6\u3009. Further, it is hermitian,\ni.e. \u03c1\u02c6\u2020 = \u03c1\u02c6 , and positive semi-definite, i.e. \u3008\u03a6i|\u03c1\u02c6|\u03a6i\u3009 \u2265 0 for arbitrary states |\u03a6i\u3009.\nThe probabilities obey the normalization \u2211i P(|\u03a8i\u3009) = 1, which corresponds to\nTr \u03c1\u02c6 =\u2211\ni\n\u3008\u03a6i|\u03c1\u02c6|\u03a6i\u3009= 1 , (74)\nwhere the trace can be evaluated in an arbitrary N-particle basis. The most important\nfeature of the density matrix is that we can compute the expectation value of any\nobservable via\n\u3008O\u02c6\u3009= Tr(O\u02c6\u03c1\u02c6) . (75)\nIt is always Tr \u03c1\u02c62 \u2264 1, and for a mixed ensemble this expression is strictly smaller\nthan 1. For a pure state |\u03a8\u3009, the density operator becomes a projection operator\nwith \u03c1\u02c62 = \u03c1\u02c6 and (75) turns into the standard quantum mechanical average \u3008O\u02c6\u3009 =\n\u3008\u03a8 |O\u02c6|\u03a8\u3009. The entropy of the system can be defined as\nS =\u2212\u3008ln \u03c1\u02c6\u3009 . (76)\nHence, the density operator contains the whole thermodynamic information of the\nsystem.\nIn the canonical ensemble, characterized by the particle number N, the tempera-\nture T and the volume V of the system, the density operator takes the form\n\u03c1\u02c6(N,\u03b2 ,V ) =\n1\nZ(N,\u03b2 ,V )\ne\u2212\u03b2 H\u02c6 , (77)\nwith the inverse temperature \u03b2 = 1T (we use kB = 1). The normalization factor Z is\nthe partition function\nZ(N,\u03b2 ,V ) = Tre\u2212\u03b2 H\u02c6 . (78)\nFor most of the physical quantities, the whole information about the N-particle den-\nsity operator is not required. Instead, it is sufficient to know the partition function.\nAnother crucial quantity of the canonical ensemble is the free energy\nF(N,\u03b2 ,V ) =\u2212T lnZ . (79)\nMost of the physical quantities can also be derived from the free energy, e.g. for the\ntotal energy and the heat capacity at constant volume we have\n\u3008H\u02c6\u3009=\u2212T 2 \u2202\n\u2202T\nF\nT\n\u2223\u2223\u2223\u2223\nN,V\n=\u2212 \u2202\n\u2202\u03b2\nlnZ\n\u2223\u2223\u2223\u2223\nN,V\n, (80)\nIntroduction to Configuration Path Integral Monte Carlo 21\nand\nCV =\n\u2202\n\u2202T\n\u3008H\u02c6\u3009\n\u2223\u2223\u2223\u2223\nV\n. (81)\nFor a system of constant temperature T , chemical potential \u00b5 and volume V , we\nuse the density operator of the grand canonical ensemble\n\u03c1\u02c6(\u03b2 ,\u00b5,V ) =\n1\nZ(\u03b2 ,\u00b5,V )\ne\u2212\u03b2 (H\u02c6\u2212\u00b5N\u02c6), (82)\nwith the grand canonical partition function\nZ(\u03b2 ,\u00b5,V ) = Tre\u2212\u03b2 (H\u02c6\u2212\u00b5N\u02c6) , (83)\nand the grand canonical potential\n\u2126(\u03b2 ,\u00b5,V ) =\u2212T lnZ. (84)\nFor example, the average particle number and the total energy can be computed\naccording to\n\u3008N\u02c6\u3009=\u2212 \u2202\n\u2202\u00b5\n\u2126\n\u2223\u2223\u2223\u2223\n\u03b2 ,V\n, \u3008H\u02c6\u3009= \u2202\n\u2202\u03b2\n\u03b2\u2126\n\u2223\u2223\u2223\u2223\n\u03b2\u00b5,V\n. (85)\nIn second quantization, the one-particle density matrix is of particular importance:\ndi j := \u3008a\u02c6\u2020i a\u02c6 j\u3009= Tr a\u02c6\u2020i a\u02c6 j\u03c1\u02c6 . (86)\nWith the representation of one-particle operators in second quantization (56), we\ncan apparently calculate all one-particle quantities from the knowledge of the one-\nparticle density matrix:\n\u3008O\u02c6\u3009=\n\u221e\n\u2211\ni, j=0\noi j Tr a\u02c6\n\u2020\ni a\u02c6 j\u03c1\u02c6 =\n\u221e\n\u2211\ni, j=0\noi jdi j . (87)\nIn addition, the diagonal elements of the one-particle density matrix are the average\noccupation numbers of the orbitals, i.e. \u3008n\u02c6i\u3009 = dii. For both the canonical and the\ngrand canonical ensembles, the elements of the one-particle density matrix can be\nobtained from the partition function. In the canonical ensemble it is\ndi j =\n1\nZ\nTr a\u02c6\u2020i a\u02c6 j e\n\u2212\u03b2\n(\n\u2211\npq\nhpqa\u02c6\n\u2020\npa\u02c6q+ \u2211\np<qr<s\nw\u2212pqrsa\u02c6\n\u2020\npa\u02c6\n\u2020\nqa\u02c6sa\u02c6r\n)\n=\u2212 1\n\u03b2\n\u2202\n\u2202hi j\nlnZ . (88)\n22 T. Schoof, S. Groth and M. Bonitz\nThis relation also holds in the grand canonical ensemble. Moreover, using the defi-\nnition of the field operators (54), we can compute the average particle density via\nn(r) =\u2211\n\u03c3\n\u3008\u03a8\u02c6 \u2020(x)\u03a8\u02c6(x)\u3009=\u2211\n\u03c3\n\u221e\n\u2211\ni, j=0\n\u03c6i(x)\u2217\u03c6 j(x)di j . (89)\n5 Configuration path integral Monte Carlo in the interaction\nrepresentation\nIn this section, first, an expansion of the partition function suitable for a CPIMC al-\ngorithm shall be derived. Next, we will show how to obtain the estimators of physi-\ncal quantities and explain the used Monte Carlo steps in detail. Finally, some results\nwill be shown for a one-dimensional system of Coulomb-interacting electrons in a\nharmonic trap.\n5.1 Expansion of the partition function\nFrom now on, we will only consider fermions in the canonical ensemble. Hence,\nthe partition function is given by (78). There are many different ways to expand this\nexpression. First, we have to choose a certain basis in which we evaluate the trace,\nand second, there are quite a few possibilities to factorize the density operator. Each\ncombination of basis and factorization will lead to a different, more or less efficient2,\nMonte Carlo algorithm. For example, we could choose coordinate space and use the\nTrotter formula [33], [34]:\ne\u03b2 H\u02c6 = lim\nn\u2192\u221e\n(\ne\n\u03b2\nn H\u02c60e\n\u03b2\nn W\u02c6\n)n\n. (90)\nIn that case, we have to antisymmetrize the density operator which yields the\nDPIMC method [12]. We could also perform the trace in occupation number repre-\nsentation, which will automatically ensure the correct symmetrization. In combina-\ntion with the standard expansion of the exponential function\nex =\n\u221e\n\u2211\nk=0\nxk\nk!\n, (91)\nwe would end up with the method called Stochastic Series Expansion [35].\nHere, we follow a different approach based on the ideas of N.V. Prokof\u2019ev et\nal. [25] and[36]. First, we split the Hamiltonian H\u02c6 into a diagonal part D\u02c6 and an\n2 Efficient with respect to a certain system with fixed parameters to be simulated, i.e. currently,\nthere is no method suitable for all systems.\nIntroduction to Configuration Path Integral Monte Carlo 23\noff-diagonal part Y\u02c6 , i.e. for an arbitrary basis {|\u03b1\u3009} it is\n\u3008\u03b1|H\u02c6|\u03b1 \u2032\u3009=\n{\n\u3008\u03b1|D\u02c6|\u03b1\u3009= D\u03b1,\u03b1 , if \u03b1 = \u03b1 \u2032\n\u3008\u03b1|Y\u02c6 |\u03b1 \u2032\u3009= Y\u03b1,\u03b1 \u2032 , if \u03b1 6= \u03b1 \u2032\n. (92)\nSecond, we switch to the interaction picture in imaginary time with respect to D\u02c6 and\nmake use of the well-known identity3\ne\u2212\u03b2 H\u02c6 \u2261 e\u2212\u03b2 D\u02c6T\u02c6\u03c4 e\u2212\n\u222b \u03b2\n0 Y\u02c6 (\u03c4)d\u03c4 , with Y\u02c6 (\u03c4) = e\u03c4D\u02c6Y\u02c6 e\u2212\u03c4D\u02c6, \u03c4 \u2208 (0,\u03b2 ) , (93)\nwhere the action of the time-ordering operator T\u02c6\u03c4 on two arbitrary operators A\u02c6(\u03c41)\nand B\u02c6(\u03c42) is defined by\nT\u02c6\u03c4 [A\u02c6(\u03c41)B\u02c6(\u03c42)] =\n{\nA\u02c6(\u03c41)B\u02c6(\u03c42) , if \u03c41 > \u03c42\nA\u02c6(\u03c42)B\u02c6(\u03c41) , if \u03c42 > \u03c41\n. (94)\nNext, we expand the exponential function of the off-diagonal operator:\nT\u02c6\u03c4e\u2212\n\u222b \u03b2\n0 Y\u02c6 (\u03c4)d\u03c4 =\n\u221e\n\u2211\nK=0\n\u222b \u03b2\n0\nd\u03c41 . . .\n\u222b \u03b2\n0\nd\u03c4K\n(\u22121)K\nK!\nT\u02c6\u03c4 [Y\u02c6 (\u03c41)Y\u02c6 (\u03c42) \u00b7 . . . \u00b7 Y\u02c6 (\u03c4K)] (95)\n=\n\u221e\n\u2211\nK=0\n\u222b \u03b2\n0\nd\u03c41\n\u222b \u03b2\n\u03c41\nd\u03c42 . . .\n\u222b \u03b2\n\u03c4K\u22121\nd\u03c4K(\u22121)KY\u02c6 (\u03c4K)Y\u02c6 (\u03c4K\u22121) \u00b7 . . . \u00b7 Y\u02c6 (\u03c41) .\nIn the first line, each integral goes from 0 to \u03b2 . Since the time-ordering operator al-\nways arranges those off-diagonal operators with the latest times to the left, for each\nK, there are K! equal terms. Therefore, we can eliminate the time-ordering opera-\ntor by canceling the K!, modifying the integral borders and arranging the operator\nproduct in such a way that it is already time-ordered.\nCombining Eq. (78), (93) and (96) yields\nZ =\n\u221e\n\u2211\nK=0\n\u2211\n{n}\n\u222b \u03b2\n0\nd\u03c41\n\u222b \u03b2\n\u03c41\nd\u03c42 . . .\n\u222b \u03b2\n\u03c4K\u22121\nd\u03c4K\n(\u22121)Ke\u2212\u03b2 D\u02c6{n} \u3008{n}|Y\u02c6 (\u03c4K)Y\u02c6 (\u03c4K\u22121) \u00b7 . . . \u00b7 Y\u02c6 (\u03c41)|{n}\u3009 , (96)\nwhere we chose the occupation number representation to perform the trace, i.e. in\nEq. (92) it is |\u03b1\u3009 = |{n}\u3009. Now we insert K \u2212 1 unit operators of the form 1\u02c6 =\n\u2211{n(i)} |{n(i)}\u3009\u3008{n(i)}| in between the off-diagonal operators. By definition of the\ninteraction picture, cf. Eq. (93), the resulting matrix elements are of the form\n3 In this notation, operators in the interaction and the Schro\u00a8dinger picture differ only concerning\nthe presence of a time argument.\n24 T. Schoof, S. Groth and M. Bonitz\n\u3008{n(i)}|Y\u02c6 (\u03c4K)|{n( j)}\u3009= \u3008{n(i)}|e\u03c4K D\u02c6Y\u02c6 e\u2212\u03c4K D\u02c6|{n( j)}\u3009\n= e\n\u03c4KD{n(i)}Y{n(i)},{n( j)}e\n\u2212\u03c4KD{n( j)} . (97)\nAfter rearranging all factors and taking into account that Y{n(i)},{n(i)} \u2261 0, we finally\nend up with\nZ(N,V,\u03b2 ) =\n\u221e\n\u2211\nK=0,\nK 6=1\n\u2211\n{n},\n={n(0)}={n(K)}\n\u2211\n{n(1)},\n6={n(0)}\n. . . \u2211\n{n(K\u22121)},\n6={n(K\u22122)}6={n(K)}\n\u03b2\u222b\n0\nd\u03c41\n\u03b2\u222b\n\u03c41\nd\u03c42 . . .\n\u03b2\u222b\n\u03c4K\u22121\nd\u03c4K\n(\u22121)K exp\n{\n\u2212\nK\n\u2211\ni=0\nD{n(i)}(\u03c4i+1\u2212 \u03c4i)\n}\nK\u22121\n\u220f\ni=0\nY{n(i)},{n(i+1)} =:\n\u222b\n\u2211\nC\nW (C) ,\n(98)\nwhere the boundary conditions {n} = {n(0)} = {n(K)}, \u03c40 = 0 and \u03c4k+1 = \u03b2 hold.\nFor the CPIMC Monte Carlo algorithm, this representation of the partition function\nis used. Hence, we can identify the introduced weights W and configurations C of\nSec. 2 in the following way. A contribution to the partition function is uniquely\ndefined by the number of kinks K, K kink times \u03c4i and K Slater determinants which\nare realized in between the kinks:\nC = {K,\u03c41,\u03c42, . . . ,\u03c4K ,{n(0)},{n(1)}, . . . ,{n(K\u22121)}} . (99)\nThus, the weights defined by Eq. (98) are given by\nW\n(\nC = {K,\u03c41,\u03c42, . . . ,\u03c4K ,{n(0)},{n(1)}, . . . ,{n(K\u22121)}}\n)\n= (100)\n(\u22121)K exp\n{\n\u2212\nK\n\u2211\ni=0\nD{n(i)}(\u03c4i+1\u2212 \u03c4i)\n}\nK\u22121\n\u220f\ni=0\nY{n(i)},{n(i+1)}.\nSuch configurations can also be visualized as \u03b2\u2212periodic paths in imaginary time.\nAs an example, Fig. 5.1 shows a possible path. Each horizontal line corresponds to a\ndiagonal matrix element in the weight of that configuration [cf. Eq. (100)], whereas\nvertical lines correspond to off-diagonal elements.\nIn addition to the correct statistics included in the occupation number represen-\ntation, this expansion of the partition function yields paths that are continuous in\nimaginary time. This is different to DPIMC, where the corresponding paths are\ndiscrete and one has to ensure the convergence of the discretization by perform-\ning several simulations for the same system parameters but different discretizations\n(different numbers of \u201ctime slices\u201d). For this reason, the presented CPIMC method\nbelongs to the so-called continuous time QMC methods. A different, independent\nderivation of (98), that is based on the Trotter Formula, was given in [23] where the\nnotion configuration PIMC was introduced.\nIntroduction to Configuration Path Integral Monte Carlo 25\nst\nat\ne\n{n\n}(\n\u03c4)\n{n(0)}\n{n(1)}\n{n(2)},{n(4)}\n{n(3)}\n0 \u03c41 \u03c42 \u03c43 \u03c44 \u03c45 \u03b2\nimaginary time \u03c4\nD{n}(0)\nY{n}(3){n}(4)\nFig. 1 Possible path in imaginary time. Horizontal lines correspond to diagonal matrix elements,\nwhereas vertical lines correspond to off-diagonal elements.\nFurther, since we have only expanded the exponential function of the off-\ndiagonal operator [cf. Eq. (96)], this representation of the partition function is noth-\ning but a perturbation expansion with respect to the off-diagonal matrix elements.\nHence, if we choose the ideal basis for the quantization, it is indeed a perturbation\nexpansion with respect to the interaction.\nCombining the Slater-Condon-rules (72) and Eq. (62), the matrix elements of the\ndiagonal and off-diagonal operator are calculated according to4\nD{n(k)} =\n\u221e\n\u2211\ni=1\nbiin\n(k)\ni +\n\u221e\n\u2211\ni=0\n\u221e\n\u2211\nj=i+1\nw\u2212i ji jn\n(k)\ni n\n(k)\nj , (101)\nand\nY{n(k)}{n(l)} =\n\uf8f1\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f2\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f3\n(\nbpq+\n\u221e\n\u2211\ni=0\ni6=p,q\nw\u2212ipiqn\n(k)\ni\n)\n(\u22121)\u2211\nmax(p,q)\u22121\nm=min(p,q)+1 n\n(k)\nm , {n(k)}= {n(l)}pq\nw\u2212pqrs(\u22121)\u2211\nq\u22121\nm=p n\n(k)\nm +\u2211s\u22121m=r n\n(l)\nm , {n(k)}= {n(l)}p<qr<s\n0, else.\n(102)\nObviously, only those configurations (paths) contribute to the partition function (98)\nin which consecutive Slater determinants differ in either two or one orbitals, since\notherwise the off-diagonal matrix elements vanish. Moreover, there are three sources\nof sign changes in the weights meaning that the fermion sign problem (see Sec. 2.2)\nsurvives. First, an increment of the number of kinks changes the sign due to the\nfactor (\u22121)K . Second, we have a phase factor in the off-diagonal matrix elements\n4 Due to the finite number of one-particle states in a practical simulation, the sums will not go up\nto infinity but to NB, the number of orbitals used in the simulation.\n26 T. Schoof, S. Groth and M. Bonitz\n(102) and third, the one and two particle integrals can have positive and negative\nsigns.\n5.2 Estimators for many-particle observables\nThe simplest way to obtain the estimators (cf. Sec. 2) is to use the thermodynamic\nrelations of Sec. 4 between the partition function and the observables. Sometimes\nthose trivial estimators can be numerically unstable, and one has to use different\nestimators, e.g. in DPIMC the virial estimator for the energy [37]. In CPIMC, the\ntrivial estimators are numerically stable.\nStarting with the energy, we have to compute \u3008H\u02c6\u3009 = \u2212 1Z \u2202Z\u2202\u03b2 with the partition\nfunction (98). Since both the integrand and the integral borders in (98) depend on\nthe inverse temperature \u03b2 , we substitute ti = \u03c4i\u03b2 and d\u03c4i = \u03b2dti yielding\nZ(N,V,\u03b2 ) =\n\u221e\n\u2211\nK=0,\nK 6=1\n\u2211\n{n},\n={n(0)}={n(K)}\n\u2211\n{n(1)},\n6={n(0)}\n. . . \u2211\n{n(K\u22121)},\n6={n(K\u22122)}6={n(K)}\n1\u222b\n0\ndt1\n1\u222b\nt1\ndt2 . . .\n1\u222b\ntK\u22121\ndtK\n(\u2212\u03b2 )K exp\n{\n\u2212\u03b2\nK\n\u2211\ni=0\nD{n(i)}(ti+1\u2212 ti)\n}\nK\u22121\n\u220f\ni=0\nY{n(i)},{n(i+1)} .\n(103)\nNow the integral limits are independent of \u03b2 (ti \u2208 [0,1]) and we can easily perform\nthe differentiation:\n\u3008H\u02c6\u3009= 1\nZ\n\u221e\n\u2211\nK=0,\nK 6=1\n\u2211\n{n},\n={n(0)}={n(K)}\n\u2211\n{n(1)},\n6={n(0)}\n. . . \u2211\n{n(K\u22121)},\n6={n(K\u22122)}6={n(K)}\n1\u222b\n0\ndt1\n1\u222b\nt1\ndt2 . . .\n1\u222b\ntK\u22121\ndtK\n[\n\u2212K\u03b2K\u22121+\u03b2K\nK\n\u2211\ni=0\nD{n(i)}(ti+1\u2212 ti)\n]\n\u00d7 (\u22121)K exp\n{\n\u2212\u03b2\nK\n\u2211\ni=0\nD{n(i)}(ti+1\u2212 ti)\n}\nK\u22121\n\u220f\ni=0\nY{n(i)},{n(i+1)} , (104)\nand, after substituting back, we obtain the estimator for the total (internal) energy\nIntroduction to Configuration Path Integral Monte Carlo 27\n\u3008H\u02c6\u3009= 1\nZ\n\u221e\n\u2211\nK=0,\nK 6=1\n\u2211\n{n},\n={n(0)}={n(K)}\n\u2211\n{n(1)},\n6={n(0)}\n. . . \u2211\n{n(K\u22121)},\n6={n(K\u22122)}6={n(K)}\n\u03b2\u222b\n0\nd\u03c41\n\u03b2\u222b\n\u03c41\nd\u03c42 . . .\n\u03b2\u222b\n\u03c4K\u22121\nd\u03c4K\n[\n\u2212K\n\u03b2\n+\nK\n\u2211\ni=0\nD{n(i)}\n(\u03c4i+1\u2212 \u03c4i)\n\u03b2\n]\nW (C). (105)\nThus, the energy of a configuration C= {K,\u03c41,\u03c42, . . . ,\u03c4K ,{n(0)},{n(1)}, . . . ,{n(K\u22121)}}\nis given by\nE(C) =\n[\n\u2212K\n\u03b2\n+\nK\n\u2211\ni=0\nD{n(i)}\n(\u03c4i+1\u2212 \u03c4i)\n\u03b2\n]\n. (106)\nIt is worth mentioning that the contribution of the off-diagonal elements of the\nHamiltonian to the total energy is given only by the number of kinks multiplied by\nthe temperature. On the other hand, the form of the diagonal contribution is reason-\nable as well. It is the sum of all diagonal elements of all realized Slater determinants\nweighted with the relative length.\nAccording to Eq. (81), the estimator for the heat capacity takes the following\nform:\nCV =\n1\nT 2\n1\nZ\n\u221e\n\u2211\nK=0\nK 6=1\n\u2211\n{n}\n={n(0)}={n(K)}\n\u2211\n{n(1)}\n6={n(0)}\n. . . \u2211\n{n(K\u22121)}\n6={n(K\u22122)},6={n(K)}\n\u222b \u03b2\n0\nd\u03c41\n\u222b \u03b2\n\u03c41\nd\u03c42 . . .\n\u222b \u03b2\n\u03c4K\u22121\nd\u03c4K\n[(\n1\n\u03b2\nK\n\u2211\ni=0\nD{n(i)}(\u03c4i+1\u2212 \u03c4i)\u2212\nK\n\u03b2\n\u2212\u3008H\u3009\n)2\n\u2212 K\n\u03b2 2\n]\nW (C) .\n(107)\nOther important quantities are the one-particle density matrix and, in particular, its\ndiagonal elements\u2013the average occupation numbers. Using Eq. (88), one readily\ncomputes the corresponding estimators:\ndpq =\n1\nZ\n\u221e\n\u2211\nK=0\nK 6=1\n\u2211\n{n}\n={n(0)}={n(K)}\n\u2211\n{n(1)}\n6={n(0)}\n. . . \u2211\n{n(K\u22121)}\n6={n(K\u22122)},6={n(K)}\n\u222b \u03b2\n0\nd\u03c41\n\u222b \u03b2\n\u03c41\nd\u03c42 . . .\n\u222b \u03b2\n\u03c4K\u22121\nd\u03c4K\n(\n\u2212 1\n\u03b2\nK\u22121\n\u2211\ni=0\n\u3008{n(i)}|a\u02c6\u2020pa\u02c6q|{n(i+1)}\u3009\nY{n(i)},{n(i+1)}\n)\nW (C)+ \u3008n\u02c6p\u3009\u03b4pq , (108)\n28 T. Schoof, S. Groth and M. Bonitz\n\u3008n\u02c6p\u3009= 1Z\n\u221e\n\u2211\nK=0\nK 6=1\n\u2211\n{n}\n={n(0)}={n(K)}\n\u2211\n{n(1)}\n6={n(0)}\n. . . \u2211\n{n(K\u22121)}\n6={n(K\u22122)},6={n(K)}\n\u222b \u03b2\n0\nd\u03c41\n\u222b \u03b2\n\u03c41\nd\u03c42 . . .\n\u222b \u03b2\n\u03c4K\u22121\nd\u03c4K\n(\n1\n\u03b2\nK\n\u2211\ni=0\nn(i)p (\u03c4i+1\u2212 \u03c4i)\n)\nW (C) . (109)\nThe average occupation of the p\u2212th orbital in the configuration C\nnp(C) =\nK\n\u2211\ni=0\nn(i)p\n(\u03c4i+1\u2212 \u03c4i)\n\u03b2\n, (110)\nis nothing but the average of the occupation of the p\u2212th orbital over realized Slater\ndeterminants, again weighted with the relative length of the path on which the de-\nterminant is realized.\n5.3 CPIMC procedure: Monte Carlo steps\nWhen developing a Monte Carlo algorithm, the most difficult task lies in the con-\nstruction of a good set of Monte Carlo steps that is most efficient while simultane-\nously ensuring the ergodicity. In the program, we start from an initial configuration\nwith zero kinks. Thus, the path consists of only one Slater determinant realized from\n0 to \u03b2 , i.e. it is C0 = {0,{n0}}. If we simulate N particles, then we populate the first\nN one-particle orbitals of |{n(0)}\u3009 while the remaining (NB\u2212N) orbitals are ini-\ntially unoccupied. Now we need a sufficient number of Monte Carlo steps that allow\nfor sampling of the whole configuration space (all possible paths) in an acceptable\namount of computation time. As a consequence of the summation constraint in the\npartition function (98), configurations with only a single kink are forbidden. Hence,\nto reach configurations with more than zero kinks, we will not only need a step in\nwhich a single kink is added but also a step in which two kinks are added at once.\nObviously, we also need a step that changes the occupation of the realized Slater\ndeterminants. One might expect that an implementation of a step that swaps the oc-\ncupation of an occupied and an unoccupied orbital of a determinant (one-particle\nexcitation) is sufficient. Actually, it can be shown that for a fixed number of kinks\nthe configuration space separates into subspaces, and hence, ergodicity is not ful-\nfilled [38]. Meaning, if we only use the one-particle excitation, we will be stuck in\na certain subspace, which results in wrong expectation values. The number of sepa-\nrated subspaces for a fixed number of kinks can be reduced by the implementation\nof a two particle excitation.\nSince the off-diagonal elements vanish if the two determinants differ in more\nthan four orbitals (cf. Eq. (102)), a step in which three particles are excited will in\nmost cases be rejected.\nIntroduction to Configuration Path Integral Monte Carlo 29\nSince we cannot exclude that a separation of the configuration space occurs for\na variable number of kinks (thus destroying ergodicity of our procedure), we assign\na so-called virtual weight to certain forbidden paths. This is achieved by setting\neach off-diagonal matrix element Y{n}{n\u00af} < Ymin = 10\u221210, with {n} = {n\u00af}p<qr<s to a\nfixed virtual weight YV . Thereby, the subspaces of the configuration space become\nconnected via the forbidden configurations. If all forbidden paths are neglected in\nthe calculation of the expectation values, then these will still be correct. During the\nequilibration time of the Markov process, the virtual weight will be determined in\nsuch a way that between 70 to 90% off all configurations in the Markov chain are\nallowed. As a consequence, the runtime of the program increases by up to 30%\nby the use of virtual weights. On the other hand, the autocorrelation time of those\nconfigurations contributing to the measurements is reduced, and so the extended\nruntime is partially compensated.\nA particular step to remove a kink is not needed. Whenever a determinant, after\na one- or two-particle excitation has been applied to it, equals its left or right neigh-\nboring determinant (in imaginary time), the corresponding kink will be removed.\nBesides, a particular step to remove kinks would have a factor in its acceptance\nprobability that decreases with the basis size NB.\nFinally, we need a step to shift the position of a kink (in imaginary time). In fact,\nthis step might not be necessary for the ergodicity, since we can remove a certain\nkink and add it at a different time. However, a particular step in which a kink is\nshifted helps reducing the autocorrelation time.\nIn the following, the Monte Carlo steps shall be explained in detail following\n[38] and [23]. As an illustration, Fig. 2 shows the changes in the path for each step.\nNevertheless, the \u03b2\u2212periodicity has not been taken into account explicitly. Instead\nthere are two intervals [0,\u03c41] and [\u03c4K ,\u03b2 ] which are both assigned to the same Slater\ndeterminant:\n1. Change state:\ni. Randomly select one of the NS states |{n(i)}\u3009 of the path. For a configura-\ntion without kinks (K = 0) it is NS = 1, else NS = K.\nii. Select randomly either a) a one-particle or b) a two-particle excitation\na) Randomly select one of the N occupied and one of the NB\u2212N unoccu-\npied one-particle orbitals. Invert the occupation of both orbitals.\nb) Randomly select two of the N occupied and two of the NB\u2212N unoccu-\npied one-particle orbitals. Invert the occupation of selected orbitals.\niii. If K \u2265 2, check the following two cases:\nA) If for a new many-particle state |{n(i)\u2032}\u3009 |{n(i)\u2032}\u3009= |{n(i\u22121)}\u3009 or |{n(i)\u2032}\u3009=\n|{n(i+1)}\u3009\n=\u21d2 Remove the corresponding kink.\nB) If for a new many-particle state |{n(i)\u2032}\u3009 |{n(i)\u2032}\u3009 = |{n(i\u22121)}\u3009 and\n|{n(i)\u2032}\u3009= |{n(i+1)}\u3009\n=\u21d2 Remove both kinks.\nIf none of the above cases applies or if K = 0, then\nC) the number of kinks remains unchanged.\n30 T. Schoof, S. Groth and M. Bonitz\n\u03c4i \u03c4i+1\n{n(i)}\n{n(i)\u2032}\n{n(i\u22121)}\n{n(i+1)}\nZ\nus\nta\nnd\n{n\n}(\n\u03c4)\na)\n\u03c4i \u03c4i+1\u03c4 \u2032i\n{n(i)}\n{n(i\u22121)}\n{n(i+1)}\nb)\n\u03c4i \u03c4i+1\u03c4a \u03c4b\n{n(i)}\n{n(i)\u2032}\n{n(i+1)}\nZ\nus\nta\nnd\n{n\n}(\n\u03c4)\nImaginre Zeit \u03c4\nc)\n\u03c4i \u03c4i+1\u03c4a\n{n(i)}\n{n(i)\u2032}\n{n(i+1)}\nImaginre Zeit \u03c4\nd)\nFig. 2 Visualization of the Monte Carlo steps. All pictures only show the relevant part of the path\nin continuous imaginary time. Dashed lines indicate the new path after the step has been performed.\nThick lines mark the part of the path that will be removed. a) Step 1: Change state (determinant).\nThe selected state is at |{n(i)}\u3009. b) Step 2: Shift kink. The selected kink is at \u03c4i. Possible new kink\npositions are in between the kinks \u03c4i\u22121 (not shown) and \u03c4i+1. c) Step 3: Add pair of kinks. The\nselected interval is [\u03c4i,\u03c4i+1]. d) Step 4: Add single kink. The added kink is at \u03c4a, and the selected\ninterval is [\u03c4i,\u03c4i+1].\n2. Shift kink\ni. Randomly select one of the K kinks with time \u03c4i.\nii. Randomly select a new kink position \u03c4 \u2032i from the interval [\u03c4i\u22121,\u03c4i+1], where\n\u03c4i\u22121 and \u03c4i+1 are the times of the adjacent kinks. Hence, the ordering of the\nkinks remains unchanged.\n3. Add pair of kinks\ni. Randomly select one of the K+1 intervals [\u03c4i,\u03c4i+1].\nii. Randomly select two new kink positions within the interval \u03c4a < \u03c4b \u2208\n[\u03c4i,\u03c4i+1].\niii. Change the state on the interval [\u03c4a,\u03c4b] as for MC move 1:\nSelect randomly either a) a one-particle or b) a two-particle excitation\na) Randomly select one of the N occupied and one of the NB\u2212N unoccu-\npied one-particle orbitals. Invert the occupation of both orbitals.\nb) Randomly select two of the N occupied and two of the NB\u2212N unoccu-\npied one-particle orbitals. Invert the occupation of the selected orbitals.\n4. Add a kink\nIntroduction to Configuration Path Integral Monte Carlo 31\ni. Randomly select one of the K kinks with time \u03c4i.\nii. Randomly choose the interval [\u03c4i\u22121,\u03c4i] or [\u03c4i,\u03c4i+1] for the new kink to be\nadded.\niii. Randomly select the new kink position \u03c4a in the chosen interval.\niv. Depending on the interval, change the state on the interval [\u03c4a,\u03c4i] or [\u03c4i,\u03c4a]\nas for step 1:\nSelect randomly either a) a one-particle or b) a two particle excitation\na) Randomly select one of the N occupied and one of the NB\u2212N unoccu-\npied one-particle orbitals. Invert the occupation of both orbitals.\nb) Randomly select two of the N occupied and two of the NB\u2212N unoccu-\npied one-particle orbitals. Invert the occupation of selected orbitals.\nThese four steps are selected with a kink-dependent probability. If K = 0, only\nsteps 1 and 3 are selected with the probabilities pcs and padd2, respectively. In all\nother cases also the steps 2 and 4 are possible with the probabilities psk and padd1.\nThen, the probabilities pcs and padd2 are adjusted. In the implementation which was\nused to produce the results of Sec. 6 all currently possible steps are equally selected.\n5.4 Acceptance probabilities of the Monte Carlo steps\nWhen determining the acceptance probabilities from the detailed balance (cf. Eq.\n(3) and (6)), one only has to solve the detailed balance for pairs of Monte Carlo\nsteps that yield the original configuration when performed consecutively. In addi-\ntion, the weight (100) divided by the partition function is a true probability only\nwith respect to the number of kinks and Slater determinants, but with respect to the\nkink times, it is a probability density. Only after multiplying with the infinitesimal\nkink times d\u03c4i, the latter becomes a true probability with respect to the kink times.\nFor steps that change the number of kinks, this would result in an infinitely large or\nvanishing acceptance probability, as some of the d\u03c4i do not cancel in the fraction of\nthe weights. Fortunately, it was shown that one can simply treat the weights divided\nby the partition function as probabilities with respect to the kink times. This leads\nto finite acceptance probabilities while still being mathematically correct, see e.g.\n[36].\nInstead of giving the detailed balance for all steps, we will rather explain how\nto set up and the solve the detailed balance for one specific step, and simplify the\nobtained result of the acceptance probability so that it can actually be implemented.\nWe choose step 3 of Sec. 5.3 (add pair of kinks). The detailed balance for this step\ntakes the following form:\npadd2(C)\n1\nK+1\n2\n(\u03c4i+1\u2212 \u03c4i)2 E|W (C)|A(C\u2192C\n\u2032) = pcs(C\u2032)\n1\nK\u2032\nE|W (C\u2032)|A(C\u2032\u2192C) ,\n(111)\n32 T. Schoof, S. Groth and M. Bonitz\nwhere the weights W (C) are defined by Eq. (100) and A(C\u2192C\u2032) is the acceptance\nprobability of the step that converts the configuration C with K kinks into the con-\nfiguration C\u2032 with K\u2032 = K + 2 kinks. The sampling probability to add two specific\nkinks consists of the product of the probabilities to\n\u2022 select step 3 (padd = 12 , if K = 0 and 14 else): padd2 .\u2022 select one of the K+1 intervals of the configuration C, where the two kinks shall\nbe added: 1K+1 .\u2022 select two new kink times \u03c4a and \u03c4b from the chosen interval [\u03c4i,\u03c4i+1]. Since there\nare two possibilities of the time ordering of the two randomly selected times, and\nsince we will name the smaller one \u03c4a, we have to add an additional factor 2:\n2\n(\u03c4i+1\u2212\u03c4i)2\n\u2022 choose one of the two possible changes of the determinant |{n(i)}\u3009: E. For one-\nparticle excitation it is\nE = E1 =\n1\n2\n1\nN\n1\n(NB\u2212N) , (112)\nwhere the factor 12 is the probability to choose the one-particle excitation and\n1\nN\n1\n(NB\u2212N) , the probability to select one of the occupied and one of the unoccupied\norbitals. Analogously, for the two-particle excitations, it is:\nE = E2 =\n1\n2\n1\nN\n1\n(N\u22121)\n1\n(NB\u2212N)\n1\n(NB\u2212N\u22121) . (113)\nThe sampling probability to propose exactly that change which transfers the con-\nfiguration C\u2032 back to the configuration C consists of the product of the probabilities\nto\n\u2022 select step 1 (change state): pcs, where pcs = 12 if K\u2032 = 0 and 14 else. Since K\u2032 =\nK+2 6= 0, it is pcs(C\u2032)\u2261 14 .\n\u2022 select one of the K\u2032 = K+2 Slater determinants of the configuration C\u2032: 1K\u2032\n\u2022 choose exactly that excitation which transfers |{n(i)\u2032}\u3009 into |{n(i)}\u3009: E\nBy inserting K\u2032 = K+2 and pcs(C\u2032) = 14 into (111), we obtain the acceptance prob-\nability for step 3:\nAadd2(C\u2192C\u2032) = min\n[\n1,\n(K+1)\n(K+2)\n(\u03c4i+1\u2212 \u03c4i)2\n8padd2(C)\n|W (C\u2032)|\n|W (C)|\n]\n. (114)\nIt is highly inefficient to calculate the whole fraction of weights for each Monte\nCarlo step, since this would very much increase the computation time. Therefore,\nthe fraction of the weights has to be simplified as far as possible. For that purpose,\nwe rewrite the weights as follows:\nIntroduction to Configuration Path Integral Monte Carlo 33\nW (C) =(\u22121)Ke\n\u2212\u2211Kj=0,\nj 6=i\nD{n( j)}(\u03c4 j+1\u2212\u03c4 j)\ne\nD{n(i)}(\u03c4i+1\u2212\u03c4i)\nK\u22121\n\u220f\nj=0\nY{n( j)},{n( j+1)} ,\nW (C\u2032) =(\u22121)K\u2032e\n\u2212\u2211Kj=0,\nj 6=i\nD{n( j)}(\u03c4 j+1\u2212\u03c4 j)\ne\nD{n(i)}(\u03c4a\u2212\u03c4i)e\nD{n(i\u2032)}(\u03c4b\u2212\u03c4a)e\nD{n(i)}(\u03c4i+1\u2212\u03c4b)\n\u00d7\nK\u22121\n\u220f\nj=0\nY{n( j)},{n( j+1)}\u00d7Y 2{n(i)},{n(i\u2032)} . (115)\nWhen keeping in mind Fig. 2c), rewriting it in this particular way seems reasonable.\nNow most of the factors cancel in the weight fraction and we end up with\nA(C\u2192C\u2032) = min\n[\n1,\n(K+1)\n(K+2)\n(\u03c4i+1\u2212 \u03c4i)2\n8padd2(C)\ne\n\u2212\n((\nD{n(i)}\u2212D{n(i\u2032)}\n)\n(\u03c4b\u2212\u03c4a)\n)]\n. (116)\nThis is the implemented acceptance probability to add a kink pair in the interval\n[\u03c4i,\u03c4i+1] at the times \u03c4a and \u03c4b. The acceptance probabilities for the remaining three\nsteps can be derived with similar considerations.\n6 Results for Interacting Fermions in a One-Dimensional\nHarmonic Trap\nAs an example for the applicability of the introduced Configuration Path Inte-\ngral Monte Carlo (CPIMC) algorithm, we calculate thermodynamic properties of a\none-dimensional system of spin-polarized, Coulomb-interacting fermions in a har-\nmonic trap. Despite its simplicity, this system is general enough to draw conclu-\nsions about the behavior of the method when simulating more complex systems.\nIn particular, the Hamiltonian contains a pair interaction of the most general form\nW\u02c6 = \u2211i jkl w\u2212i jkl a\u02c6\n\u2020\ni a\u02c6\n\u2020\nj a\u02c6l a\u02c6k. In contrast to earlier applications of the Continuous Time\nPath Integral Monte Carlo method, which usually consider lattice models, we inves-\ntigate a spatially continuous system. At first, the test system will be characterized,\nand the used units will be introduced. In the following section, results for expecta-\ntion values of several thermodynamic observables will be presented and compared\nto results obtained from the exact Configuration Interaction (CI) method, see e.g.\n[32], and from the Direct Path Integral Monte Carlo (DPIMC) method [37], respec-\ntively. Finally, the dependence of the efficiency of the CPIMC and DPIMC methods\non different parameters will be investigated.\n6.1 The System\nThe Hamiltonian of the considered system in natural units is given by\n34 T. Schoof, S. Groth and M. Bonitz\nH\u02c6 =\nN\n\u2211\n\u03b1=1\n( p\u02c62\u03b1\n2m\n+\nm\u03c92r\u02c62\u03b1\n2\n)\n+\nN\n\u2211\n1\u2264\u03b1<\u03b2\ne2\u221a\n|r\u02c6\u03b1 \u2212 r\u02c6\u03b2 +\u03ba2|\n. (117)\nHere, m is the mass of the fermions and\u03c9 the frequency of the trap. The parameter \u03ba\nis necessary in one dimension to prevent the divergence of the two-particle integrals\nof the Coulomb-interaction, cf. (64). Introducing the coupling parameter \u03bb = EC/\u03c9\nwhich denotes the ratio of the Coulomb-energy EC = e2/r0 with r20 = 1/(m\u03c9) and\nthe potential energy of the trap \u03c9 , the Hamiltonian can be written in dimensionless\nunits:\nH\u02c6 =\n1\n2\nN\n\u2211\n\u03b1=1\n(p\u02c62\u03b1 + r\u02c6\n2\n\u03b1)+\nN\n\u2211\n1\u2264\u03b1<\u03b2\n\u03bb\u221a\n|r\u02c6\u03b1 \u2212 r\u02c6\u03b2 +\u03ba2|\n. (118)\nIn these units, the energy is given by E/\u03c9 , the chemical potential by \u00b5/\u03c9 and the\ntemperature by T/\u03c9 and \u03b2 = \u03c9/T , respectively.\nThe eigenfunctions of the one-particle Hamiltonian are the well known eigen-\nfunctions of the quantum mechanical harmonic oscillator. In this basis, the one- and\ntwo-particle integrals can be calculated in advance with high precision5. Further-\nmore the one- and two-particle integrals in the Hartree-Fock (HF) basis will be used\nin the following. They have been calculated for each specific value of the tempera-\nture, the particle number and the coupling strength6.\nThe results in this work have been obtained under the additional assumption of\nspin-polarized fermions, i.e. all particles have the same spin projection remaining\nfixed in the simulation. Such a system is realized e.g. in the presence of a strong\nmagnetic field. It should be noted that this was chosen for simplicity and is not a\nrestriction of the method at hand. Generalizations to systems with arbitrary spin\nconfigurations or even with a spin dependent Hamiltonian are straightforward.\n6.2 Numerical Results\nThe results in this section were obtained with the CPIMC method using 5\u00d7109\nMonte Carlo steps per data point, if not noted otherwise. Samples for the thermody-\nnamic averages were taken every 5000 steps. This large number of steps is necessary\nbecause of the large auto-correlation time. In total, this results in 1\u00d7106 samples\nper observable. The equilibration time was chosen to 5\u00d7107 steps. The runtimes\nfor these calculations were in between 3h and 12h on a single-core CPU depending\non the particle number, temperature and coupling parameter.\nFirst, we will consider the energy per particle, for it is a central and simple ob-\nservable. Fig. 3 shows the results for N = 3 and N = 6 particles obtained with 3\n5 The one- and two-particle integrals used in these calculations have been calculated by K. Balzer\nwith Mathematica [39].\n6 These integrals have been calculated with a program by K. Balzer.\nIntroduction to Configuration Path Integral Monte Carlo 35\n1.6\n2\n2.4\n2.8\n3.2\n0 0.5 1 1.5 2\nN = 3\n\u03b2 = 1\ncoupling parameter \u03bb\nav\ner\nag\ne\nen\ner\ngy\n\u3008H\n\u3009/N\na)\nNB = 14\n\u03b2 = 2\n\u03b2 = 5\nCI\nCPIMC\nHF\n0 0.5 1 1.5\n3\n3.5\n4\n4.5\n5\n5.5\n6\nN = 6\n\u03b2 = 1\ncoupling parameter \u03bb\n\u03b2 = 2\nb)\nNB = 14\n\u03b2 = 5\nCI\nCPIMC\nHF\nFig. 3 Average energy per particle versus coupling parameter for a) N = 3 and b) N = 6 particles\nand different temperatures. Comparison of CPIMC results (dots), CI results (solid lines) and HF\nresults (dashed lines). Temperatures are given by labels and small arrows within the figure. Error\nbars show the statistical error of the CPIMC simulation.\n0\n0.2\n0.4\n0.6\n0.8\n1\n0 2 4 6 8 10 12\norbital index i\nav\ner\nag\ne\noc\ncu\npa\nti\non\nnu\nm\nbe\nrs\n\u3008n\ni\u3009\na)\nCI\nCPIMC\n\u03b2 = 1\n\u03b2 = 2\n\u03b2 = 5\nN = 3 N = 6\n0 2 4 6 8 10 12\norbital index i\nb)\nCI\nCPIMC\n\u03b2 = 1\n\u03b2 = 2\n\u03b2 = 5\nN = 3 N = 6\nFig. 4 Average occupation numbers \u3008n\u02c6i\u3009 of the one-particle orbitals |i\u3009. a) in the HF basis and b)\nin the basis of eigenfunctions of the ideal Hamiltonian. Shown are results obtained from CPIMC\ncalculations (points with error bars) and CI results (lines) for the coupling strength \u03bb = 1 and the\ntemperatures \u03b2 = 1 (dashed dotted lines), \u03b2 = 2 (dotted lines) and \u03b2 = 5 (solid lines). Adapted\nfrom [23].\ndifferent methods: CPIMC, HF and CI7. For HF and CI, the first NB = 14 eigen-\nfunctions of the ideal one-particle Hamiltonian were used as basis functions. For\nCPIMC, the basis functions from the HF calculation were used. The CI results can\nbe considered as reference data, because the only approximation of CI, the usage a\n7 The finite temperature HF and CI programs were written by D. Hochstuhl.\n36 T. Schoof, S. Groth and M. Bonitz\nfinite basis set, is the same for all methods. For all shown coupling strengths and\ntemperatures, the energies from the CI calculation match the energies from the MC\ncalculation within the statistical errors8. For weak and moderate coupling, \u03bb \u2264 1,\nthe statistical error is small and the agreement is very good. For stronger couplings,\nthe statistical error strongly depends on the temperature and on the particle number.\nWhile the precision for N = 3 and \u03b2 = 2 is high enough to distinguish the CPIMC\nresult from the HF result up to \u03bb = 2, this is not the case for \u03b2 = 5 or N = 6. For\n\u03bb = 1.5, N = 6 and \u03b2 = 5, the relative error exceeds 100% and the corresponding\ndata point is not shown.\nA quantity that is much more sensitive to systematical errors is the average occu-\npation number \u3008n\u02c6i\u3009 of each one-particle orbital |i\u3009. The occupation numbers of the\norbitals in the HF and the ideal basis for different temperatures and particle num-\nbers are shown in Fig. 4. In the case of HF orbitals the shape of the curves is similar\nto the Fermi-Dirac distribution of non-interacting fermions in the grand-canonical\nensemble. It should be noted that it is not possible to relate a specific energy to each\norbital as in the case of basis functions that diagonalize the Hamiltonian, e.g. for\nideal systems. Moreover the orbital energies of the HF orbitals have a meaning only\nwithin the HF approximation. Additionally, the HF orbitals with the same index dif-\nfer from each other for different values of the temperature. For small temperatures,\nthe shape of the curves approaches a step functions, but as long as the exact ground\nstate does not equal the HF ground state (which is the general case due to the in-\nteraction), there will be non-zero occupation numbers above the step even in the\nground state at T = 0. There is an excellent agreement between the CPIMC and CI\nresults for all shown parameters.\nConsidering the results for the occupation numbers of the ideal orbitals, the non-\nmonotonic behavior is obvious. This behavior is confirmed by the CI results, which\nagree well within the statistical error. However, the statistical errors in these calcu-\nlations are much larger than in the calculations using the HF orbitals, which will be\ndiscussed later.\nThe final observable, for which we will compare the results between the differ-\nent methods in this chapter, is the one-particle density n(x) where x denotes the\nspatial coordinate. As can be seen from Eq. (89), all matrix elements of the one-\nparticle density matrix contribute to this quantity. Compared to the diagonal ele-\nments dii = \u3008n\u02c6i\u3009 shown before, the off-diagonal elements di j with i 6= j converge\nmuch slower. The one-particle density contains a large statistical error since each\nof the off-diagonal elements can be determined only in certain configurations of the\nMarkov-chain, see (108). Correspondingly, a larger number of MC steps would be\nnecessary for a precise calculation of the whole one-particle density matrix. Never-\ntheless, Fig. 5 shows that for N = 3 particles, a temperature of \u03b2 = 2, and a coupling\nstrength of \u03bb = 0.5 and \u03bb = 1 the agreement of the CPIMC results with the exact\ndensity is better than in the case of the HF results. The relative deviation amounts\nto only a few per cent. This can be explained by the diagonal elements (which can\nbe calculated efficiently, see Fig. 4) dominating the contribution to the density. Ad-\n8 Shown is the standard error, see (15). Within two times the standard error the results can be\nconsidered to coincide.\nIntroduction to Configuration Path Integral Monte Carlo 37\n0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\n0.7\n0.8\nN = 3\n\u03b2 = 2\n\u03bb = 0.5\nn\n(x\n)\na)\nCPIMC\nCI\nHF\nN = 3\n\u03b2 = 2\n\u03bb = 1\nn\n(x\n)\nb)\nCPIMC\nCI\nHF\n\u22124\n0\n4\n\u22124 \u22123 \u22122 \u22121 0 1 2 3 4\nx\nde\nvi\nat\nio\nn/\n%\n\u22124 \u22123 \u22122 \u22121 0 1 2 3 4\nx\nde\nvi\nat\nio\nn/\n%\nFig. 5 One-particle density n(x) for N = 3 particles, \u03b2 = 2 and a) \u03bb = 0.5 and b) \u03bb = 1. Solid\nlines indicate CI results, which are considered to be exact. CPIMC and HF results are indicated by\ndashed dotted and dotted lines, respectively. Below, the relative deviation (n(x)\u2212 nCI(x))/nCI(x)\nis shown.\nditionally, the statistical errors in the off-diagonal elements may partly cancel each\nother in the calculation of the one-particle density.\nFor all thermodynamic quantities presented in this chapter, we could demonstrate\nthe very good agreement within the statistical error between the results obtained\nfrom the CPIMC method and the reference results obtained from the exact diag-\nonalization of the Hamiltonian. For weak and moderate coupling strengths \u03bb \u2264 1\nand moderate temperatures, i.e. \u03b2 = 1 and \u03b2 = 2, results can be obtained with high\nprecision within several hours of runtime on a single CPU.\n6.3 Fermion sign problem\nIn the last section, the focus lay on the exact calculation of thermodynamic aver-\nages of physical observables. In this section, we will investigate the main factor that\ndetermines the efficiency of QMC methods: the fermion sign problem. Taking the\nmodulus of the weights to allow for the MC sampling of configurations with nega-\ntive weights introduces the average sign \u3008s\u3009\u2032 in Eq. (9). For small average sign, the\nstatistical error of MC calculations is approximately inverse proportional to it. For\npath integral Monte Carlo methods in coordinate space, e.g. DPIMC, the average\nsign decreases exponentially with the particle number N and the inverse tempera-\nture \u03b2 . This leads to exponentially growing statistical errors. Alternatively, if results\nwith a fixed precision are targeted, this leads to exponentially growing runtimes, see\nEq. (18).\n38 T. Schoof, S. Groth and M. Bonitz\n10\u22125\n10\u22124\n10\u22123\n10\u22122\n10\u22121\n1\n0.1 1 10\ncoupling parameter \u03bb\nav\ner\nag\ne\nsi\ngn\n\u3008s\n\u3009\na)\nN = 3\n\u03b2 = 2\n\u03b2 = 5\n0.1 1 10\nN = 6\ncoupling parameter \u03bb\nb)\nPIMC\nCPIMC(HF)\nCPIMC(ideal)\n\u03b2 = 5\nFig. 6 Average sign versus coupling parameter for different temperatures and a) N = 3 and b)\nN = 6 particles. Shown are results obtained from CPIMC calculations with the HF basis (solid\nlines) and with the ideal basis (dotted lines). Dashed dotted lines indicate results from DPIMC\ncalculations. Temperatures are given by labels and small arrows within the figure. Error bars show\nthe statistical errors. Note the log scale. Adapted from [23].\nIt turns out that the dependence of the average sign on temperature and parti-\ncle number for CPIMC is essentially the same as for DPIMC, namely exponential.\nThis is as expected since the general behavior is governed by Eq. (18). The depen-\ndence of the average sign on the coupling strength is shown in Fig. 6 for N = 3\nand N = 6 particles and different temperatures. Additionally, the figure shows the\naverage sign of DPIMC calculations for the same parameters9. For large coupling\nstrength, \u03bb \u001d 1, the average sign of DPIMC is close to 1 and therefore, calculations\nwith DPIMC are highly efficient. For decreasing \u03bb , the sign decreases and calcu-\nlations with DPIMC become more demanding. The simulation of the ideal system\nwith \u03bb = 0 is infeasible. The reason for this behavior is the following: For strong\nrepulsive interactions, the overlap of the wave functions of the particles is small and\nthe statistics resemble those of a classical system of point-like particles. The weaker\nthe Coulomb repulsion compared to the strength of the trap, the larger is the overlap\nof the wave functions. With larger overlap, particle exchange, which is the source\nof the alternating sign in DPIMC, becomes more important.\nCPIMC calculations, on the other hand, show a behavior completely opposite to\nthat of DPIMC. While for the ideal system there exists no sign problem at all, the\naverage sign decreases with increasing coupling parameter. This decrease becomes\nvery fast at \u03bb \u2248 1, and calculations for larger coupling parameters become ineffi-\ncient. The value of \u03bb for which this rapid decrease of the average sign starts depends\non the temperature and the particle number. For lower temperature and larger parti-\ncle number, the average sign decreases earlier. Fig. 6 also shows the influence of the\n9 The data was produced by A. Filinov.\nIntroduction to Configuration Path Integral Monte Carlo 39\nchoice of the basis on the average sign. Using HF basis functions, the average sign\nand therefore the efficiency of CPIMC can be increased by several magnitudes.\n7 Summary and Outlook\nIn this chapter, we presented a path integral Monte Carlo method in the Slater de-\nterminant space for the exact calculation of thermodynamic properties of correlated\nfermionic many-particle systems. We introduced the appropriate description of the\nphysical system in terms of second quantization and described the transition from\nthe coordinate representation to the occupation number representation of the path\nintegral in detail. In contrast to the widely used application of the underlying formu-\nlation to lattice models with onsite (or short-range) interaction, such as the Hubbard\nmodel, the method at hand allows for ab initio calculations of spatially continu-\nous systems with arbitrary interaction. We gave a detailed description of the Monte\nCarlo steps including the acceptance probabilities for the exmple of one step. At the\nend we demonstrated the application of this method to a test system of Coulomb-\ninteracting fermions in a one-dimensional harmonic trap. While we have presented\nonly a small selection of thermodynamic quantities, our simulations are able to\nyield all other thermodynamic quantities. Moreover, it was recently demonstrated\nthat also dynamic quantities, including the energy spectrum and collective excita-\ntion spectrum, can be efficiently computed within quantum Monte Carlo simulations\n[40]\nFor the test system, the comparison of the results between the CPIMC and\nDPIMC method revealed a very interesting complementary behavior of the average\nsign, depending on the coupling strength. While the calculation of thermodynamic\nexpectation values with DPIMC is possible for strong coupling and low degener-\nacy, CPIMC allows to calculate these quantities for weakly to moderately coupled\nand highly degenerate many-body systems, which are not accessible with DPIMC.\nTherefore the presented method helps to extend the parameter range for which ab\ninitio QMC simulations are feasible. Furthermore, as mentioned in the introduc-\ntion, strongly degenerate weakly coupled electrons are of key importance for many\nmodern plasma applications, so here CPIMC is expected to be very valuable.\nDespite the promising results shown in this chapter, further work has to be done\nto improve the efficiency of the method. The exponential dependence of the average\nsign on the temperature and particle number still exists, which opens an increas-\ning gap in the ranges of coupling parameters for which either CPIMC or DPIMC\nmethods are efficient. This gap can, at the moment, be bridged only by additional\napproximations. Approaches to this problem can be assigned to two classes. The\nfirst class contains improvements to the algorithm that increase the effective num-\nber of MC samples per time, e.g. by optimizing the acceptance probability of the\nsteps and by decreasing the auto-correlation time. The so-called heat bath idea is\nsuch an approach. By choosing the sampling probability to be proportional to the\ntransition probability, the acceptance probability becomes unity. This is possible if\n40 T. Schoof, S. Groth and M. Bonitz\nthe normalization for the transition can be calculated efficiently, e.g. for choosing\nthe time of the kinks in the MC steps. Another promising approach in this class is\nthe so-called worm algorithm [25] which also allows for more efficient sampling\nof off-diagonal quantities related to the Matsubara Green function, including the\none-particle density. Other approaches aim at reducing the sign problem directly.\nOne method in this class is the so-called blocking, which tries to analytically com-\nbine configurations of opposite sign into groups with a much lower modulus of the\nweight than the single configurations.\nTo achieve even higher efficiency additional approximations can be used. The\nsimilarities of the CPIMC method to MC on a lattice (such as the Hubbard model)\nas well as to CI methods, give access to a large variety of approximations devel-\noped for these latter methods. As an example we mention the restricted active space\n(RAS) approach well known in quantum chemistry, see [41]. Special cases are the\n\u201cCI-Singles\u201d and \u201cCI-Doubles\u201d approximations. The main idea is to restrict the oc-\ncupation number of the orbitals in different energy (or spatial) regions. For example,\none can require that the n orbitals within the lowest energy interval must be occu-\npied by at least n\u22121 particles, the m orbitals within the next-higher energy interval\nbe occupied by at least m\u2212 2 particles and so on, until the orbitals with the high-\nest energy are occupied at most by one particle. These restrictions are arbitrary but\ncan be motivated by physical insights. This approach strongly decreases the size of\nthe configuration space and consequently the sign problem. The advantage of this\napproximation is that it is easy to control and to fine-tune. Calculations with grad-\nually reduced restrictions allow one to estimate the introduced systematical error.\nWith these improvements applications of CPIMC to larger particle numbers and,\neventually, to macroscopic quantum plasmas seem to be possible.\nAcknowledgements\nWe are grateful to K. Balzer, A. Filinov and D. Hochstuhl for providing supplemen-\ntary data shown in this chapter. We acknowledge financial support by the Deutsche\nForschungsgemeinschaft via grant BO1366-10 and a grant for CPU time at the\nHLRN.\nIntroduction to Configuration Path Integral Monte Carlo 41\nReferences\n1. Proceedings of the conference \u201cStrongly Coupled Coulomb systems\u201d, J. Phys. A 42 No. 21\n(2009)\n2. M. Bonitz, C. Henning, D. Block, Complex plasmas: a laboratory for strong correlations,\nRep. Prog. Phys. 73(6), 066501 (2010)\n3. H. Haberland, M. Bonitz, D. Kremp, Harmonics generation in electron-ion collisions in a\nshort laser pulse, Phys. Rev. E 64(2), 026405 (2001)\n4. R. Redmer, G. Ro\u00a8pke, Progress in the Theory of Dense Strongly Coupled Plasmas, Contrib.\nPlasma Phys. 50(10), 970 (2010)\n5. B. Holst, M. French, R. Redmer, Electronic transport coefficients from ab initio simulations\nand application to dense liquid hydrogen, Phys. Rev. B 83(23), 235120 (2011)\n6. M. Bonitz, A. Filinov, J. Bo\u00a8ning, J.W. Dufty, in Introduction to Complex Plasmas, vol. 59, ed.\nby M. Bonitz, N. Horing, P. Ludwig (Springer, Berlin, Heidelberg, 2010), pp. 41\u201377\n7. J.S. Tse, Ab initio molecular dynamics with density functional theory, Annu. Rev. Phys. Chem.\n53(1), 249 (2002)\n8. D. Kremp, M. Schlanges, W. Kraeft, T. Bornath, Quantum Statistics of Nonideal Plasmas, 1st\nedn. (Springer, Berlin, Heidelberg, 2005)\n9. M. Bonitz, Quantum Kinetic Theory (B G Teubner, Stuttgart, Leipzig, 1998)\n10. K. Balzer, M. Bonitz, Nonequilibrium Green\u2019s functions approach to inhomogeneous systems\n(Springer, Heidelberg, New York, 2013)\n11. R. Feynman, Quantum mechanics and path integrals (McGraw-Hill, New York, 1965)\n12. D.M. Ceperley, Path integrals in the theory of condensed helium, Rev. Mod. Phys. 67(2), 279\n(1995)\n13. A. Filinov, N.V. Prokof\u2019ev, M. Bonitz, Berezinskii-Kosterlitz-Thouless Transition in Two-\nDimensional Dipole Systems, Phys. Rev. Lett. 105(7), 070401 (2010)\n14. D. Ceperley, in Monte Carlo and Molecular Dynamics of Condensed Matter Systems (Editrice\nCompositori, Bologna, Italy, 1996)\n15. M. Troyer, U. Wiese, Computational Complexity and Fundamental Limitations to Fermionic\nQuantum Monte Carlo Simulations, Phys. Rev. Lett. 94(17), 170201 (2005)\n16. D.M. Ceperley, Path-integral calculations of normal liquid 3He, Phys. Rev. Lett. 69(2), 331\n(1992)\n17. K.P. Driver, B. Militzer, All-Electron Path Integral Monte Carlo Simulations of Warm Dense\nMatter: Application to Water and Carbon Plasmas, Phys. Rev. Lett. 108(11), 115502 (2012)\n18. C. Pierleoni, D. Ceperley, in Computer Simulations in Condensed Matter Systems: From Ma-\nterials to Chemical Biology Volume 1, vol. 703, ed. by M. Ferrario, G. Ciccotti, K. Binder\n(Springer, Berlin, Heidelberg, 2006), pp. 641\u2013683\n19. M.A. Morales, C. Pierleoni, D.M. Ceperley, Equation of state of metallic hydrogen from cou-\npled electron-ion Monte Carlo simulations, Phys. Rev. E 81(2), 021202 (2010)\n20. R. Egger, W. Ha\u00a8usler, C.H. Mak, H. Grabert, Crossover from Fermi Liquid to Wigner Molecule\nBehavior in Quantum Dots, Phys. Rev. Lett. 82(16), 3320 (1999)\n21. V.S. Filinov, M. Bonitz, W. Ebeling, V.E. Fortov, Thermodynamics of hot dense H-plasmas:\npath integral Monte Carlo simulations and analytical approximations, Plasma Phys. and Con-\ntrolled Fusion 43(6), 743 (2001)\n22. A.V. Filinov, M. Bonitz, Y.E. Lozovik, Wigner Crystallization in Mesoscopic 2D Electron\nSystems, Phys. Rev. Lett. 86(17), 3851 (2001)\n23. T. Schoof, M. Bonitz, A. Filinov, D. Hochstuhl, J.W. Dufty, Configuration Path Integral Monte\nCarlo, Contrib. Plasma Phys. 51(8), 687 (2011)\n24. N.V. Prokof\u2019ev, B.V. Svistunov, I.S. Tupitsyn, Exact quantum Monte Carlo process for the\nstatistics of discrete systems, J. Exp. Theor. Phys. Lett. 64(12), 911 (1996)\n25. N.V. Prokof\u2019ev, B.V. Svistunov, I.S. Tupitsyn, Exact, complete, and universal continuous-time\nworldline Monte Carlo approach to the statistics of discrete quantum systems, J. Exp. Theor.\nPhys. 87(2), 310 (1998)\n42 T. Schoof, S. Groth and M. Bonitz\n26. M. Troyer, F. Alet, S. Trebst, S. Wessel, Non-local updates for quantum Monte Carlo simula-\ntions, AIP Conf. Proc. 690, 156 (2003)\n27. E. Gull, A.J. Millis, A.I. Lichtenstein, A.N. Rubtsov, M. Troyer, P. Werner, Continuous-time\nMonte Carlo methods for quantum impurity models, Rev. Mod. Phys. 83, 349 (2011)\n28. N. Metropolis, A.W. Rosenbluth, M.N. Rosenbluth, A.H. Teller, E. Teller, Equation of State\nCalculations by Fast Computing Machines, J. Chem. Phys. 21(6), 1087 (1953)\n29. W. Janke, in Quantum Simulations of Complex Many-Body Systems: From Theory to Algo-\nrithms, edited by J. Grotendorst, D. Marx and A. Muramatsu, John von Neumann Institute for\nComputing (NIC, Ju\u00a8lich, 2002)\n30. T. Nakamura, Vanishing of the negative-sign problem of quantum Monte Carlo simulations in\none-dimensional frustrated spin systems, Phys. Rev. B 57(6), R3197 (1998)\n31. A.P. Lyubartsev, Simulation of excited states and the sign problem in the path integral Monte\nCarlo method, J. Phys. A 38(30), 6659 (2005)\n32. T. Helgaker, P. Jorgensen, J. Olsen, Molecular Electronic-Structure Theory, 1st edn. (Wiley,\nChichester, Hoboken, 2000)\n33. H.F. Trotter, On the Product of Semi-Groups of Operators, Proc. Amer. Math. Soc. 10(4), 545\n(1959)\n34. M. Suzuki, Generalized Trotter\u2019s formula and systematic approximants of exponential opera-\ntors and inner derivations with applications to many-body problems, Commun. Math. Phys.\n51(2), 183 (1976)\n35. A.W. Sandvik, J. Kurkijrvi, Quantum Monte Carlo simulation method for spin systems, Phys.\nRev. B 43(5950) (1991)\n36. N. V. Prokof\u2019ev, Worm algorithm for classical and quantum statistical models, Lecture notes\nat \u201cAdvanced School on Quantum Monte Carlo Methods in Physics and Chemistry\u201d, 2008,\nTrieste, online at http://mcwa.csi.cuny.edu/umass/lectures.html\n37. M. Bonitz, D. Semkat (eds.), Introduction to Computational Methods in Many Body Physics\n(Rinton Press Inc, Paramus, 2006)\n38. T. Schoof, Thermodynamische Eigenschaften entarteter, korrelierte Fermionen, Diplomarbeit\n(in German). (Kiel University, 2011)\n39. Wolfram Research, Inc., Mathematica. Version 7.0 (Wolfram Research, Inc., Champaign,\nIllinois, 2008)\n40. A. Filinov, M. Bonitz, Collective and single-particle excitations in two-dimensional dipolar\nBose gases, Phys. Rev. A 86(4), 043628 (2012)\n41. D. Hochstuhl, M. Bonitz, Time-dependent restricted-active-space configuration-interaction\nmethod for the photoionization of many-electron atoms, Phys. Rev. A 86, 053424 (2012)\n",
      "id": 17214198,
      "identifiers": [
        {
          "identifier": "2097940107",
          "type": "MAG_ID"
        },
        {
          "identifier": "25049400",
          "type": "CORE_ID"
        },
        {
          "identifier": "oai:arxiv.org:1408.2011",
          "type": "OAI_ID"
        },
        {
          "identifier": "1408.2011",
          "type": "ARXIV_ID"
        },
        {
          "identifier": "186972495",
          "type": "CORE_ID"
        },
        {
          "identifier": "10.1007/978-3-319-05437-7_5",
          "type": "DOI"
        }
      ],
      "title": "Introduction to Configuration Path Integral Monte Carlo",
      "language": {
        "code": "en",
        "name": "English"
      },
      "magId": "2097940107",
      "oaiIds": [
        "oai:arxiv.org:1408.2011"
      ],
      "publishedDate": "2014-08-08T00:00:00",
      "publisher": "",
      "pubmedId": null,
      "references": [],
      "sourceFulltextUrls": [
        "http://arxiv.org/abs/1408.2011"
      ],
      "updatedDate": "2021-07-22T16:10:02",
      "yearPublished": 2014,
      "journals": [
        {
          "title": null,
          "identifiers": [
            "1615-5653"
          ]
        }
      ],
      "links": [
        {
          "type": "download",
          "url": "http://arxiv.org/abs/1408.2011"
        },
        {
          "type": "display",
          "url": "https://core.ac.uk/works/17214198"
        }
      ]
    },
    {
      "acceptedDate": "2010-06-18T00:00:00",
      "arxivId": "0911.2816",
      "authors": [
        {
          "name": "Emil Prodan"
        },
        {
          "name": "Murakami S"
        },
        {
          "name": "Prodan E"
        },
        {
          "name": "Prodan E"
        },
        {
          "name": "Prodan E"
        },
        {
          "name": "Volovik G E"
        }
      ],
      "citationCount": 0,
      "contributors": [
        ""
      ],
      "outputs": [
        "https://api.core.ac.uk/v3/outputs/242873713"
      ],
      "createdDate": "2012-04-13T14:17:33",
      "dataProviders": [
        {
          "id": 144,
          "name": "",
          "url": "https://api.core.ac.uk/v3/data-providers/144",
          "logo": "https://api.core.ac.uk/data-providers/144/logo"
        },
        {
          "id": 4786,
          "name": "",
          "url": "https://api.core.ac.uk/v3/data-providers/4786",
          "logo": "https://api.core.ac.uk/data-providers/4786/logo"
        }
      ],
      "depositedDate": "2010-06-17T00:00:00",
      "abstract": "This paper reviews several analytic tools for the field of topological\ninsulators, developed with the aid of non-commutative calculus and geometry.\nThe set of tools includes bulk topological invariants defined directly in the\nthermodynamic limit and in the presence of disorder, whose robustness is shown\nto have non-trivial physical consequences for the bulk states. The set of tools\nalso includes a general relation between the current of an observable and its\nedge index, relation that can be used to investigate the robustness of the edge\nstates against disorder. The paper focuses on the motivations behind creating\nsuch tools and on how to use them.Comment: Final version (some arguments were corrected",
      "documentType": "research",
      "doi": "10.1088/1367-2630/12/6/065003",
      "downloadUrl": "http://arxiv.org/abs/0911.2816",
      "fieldOfStudy": null,
      "fullText": "ar\nX\niv\n:0\n91\n1.\n28\n16\nv4\n  [\nco\nnd\n-m\nat.\nsta\nt-m\nec\nh]\n  1\n5 D\nec\n 20\n09 Non-Commutative Tools for Topological Insulators\nEmil Prodan\nDepartment of Physics, Yeshiva University, New York, NY 10016\nAbstract. This paper reviews several analytic tools for the field of topological\ninsulators, developed with the aid of non-commutative calculus and geometry.\nThe set of tools includes bulk topological invariants defined directly in the\nthermodynamic limit and in the presence of disorder, whose robustness is shown\nto have non-trivial physical consequences for the bulk states. The set of tools\nalso includes a general relation between the current of an observable and its edge\nindex, relation that can be used to investigate the robustness of the edge states\nagainst disorder. The paper focuses on the motivations behind creating such tools\nand on how to use them.\nPACS numbers: 73.43.-f, 72.25.Hg, 73.61.Wp, 85.75.-d\nNon-Commutative Tools for Topological Insulators 2\n1. Introduction\nThe topological insulating state represents an entirely novel manifestation of the\nordinary matter, characterized by the existence of metallic edge states despite the\npresence of strong disorder or strong deformations of the materials. We will argue\nhere that the topological insulating state is also characterized by the existence of\nbulk states that resist localization. These are intrinsic properties of the topological\ninsulators and no external magnetic field is need to trigger this peculiar behavior [1].\nFervent theoretical activity around the topological insulators resulted in a variety\nof characterizations, some based on very original ideas [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,\n13, 14, 15, 16, 17, 18]. For example, the Z2 invariant introduced by Kane and Mele\n[2] was new to the physics and mathematics communities. Same can be said about\nthe Spin-Chern number introduced by Sheng et al [10] or about the recent results on\n3D topological insulators. We also want to mention that several topological invariants\nappeared long before the field of topological insulators was defined, in the context of\n3He-A like topologically ordered systems [19].\nMost of the analytic works were completed within the framework of translational\ninvariant bulk systems and homogeneous edges, where one can build topological\ninvariants on the Brillouin torus and the edge states can be computed explicitely.\nThe topological properties in the presence of disorder were mostly investigated by\ncomputational means [20, 21, 22, 23, 9, 10, 14, 24]. The present contribution to this\nspecial issue on \u201dTopological Insulators\u201d gives a short overview of the author\u2019s recent\nworks [25, 26, 27, 28], which provide a set of analytic tools to diagnose the effect of\ndisorder on the bulk and on the edge states of the topological insulators.\nThe topic of the present paper is how to define topological invariants directly in\nthe thermodynamic limit and in the presence of disorder and what kind of information\ncan be extracted from their invariant properties. The discussion excludes technical\narguments, which can be found in the author\u2019s published work, but includes a careful\npresentation of the assumptions and the limits in which the results are valid. The\nconnection to other works, especially to the existing numerical studies, is emphasized.\nThe paper also pays special attention to the motivation behind these works and how\nto use the emerging analytic tools. The author also shares some of his current personal\nbeliefs that crystalized during this work.\n2. Tools for the bulk states\nWe start the discussion from the classical Chern invariant. For any smooth family of\nprojectors {P\u03b8}\u03b8\u2208M indexed by \u03b8, who lives on a two dimensional smooth and closed\nmanifold M , one can compute the Berry curvature\ndF = (2\u03c0i)\u22121Tr{P\u03b8[\u2202\u03b81P\u03b8, \u2202\u03b82P\u03b8]}d\u03b81 \u2227 d\u03b82 (1)\nand then integrate the curvature overM to obtain the Chern number, an integer that\nis invariant to smooth deformations of the family of projectors. We want to emphasize\nfrom the beginning that the Chern number can be defined only if P\u03b8 is at least first\norder differentiable in \u03b8, for all \u03b8 of the manifold M . The Chern number can change\nits value if P\u03b8 seize to be a global smooth function of \u03b8.\nThe last two observations are quite relevant because many invariants for\ntopological insulators were linked to the Chern numbers of families of projectors Pk,\nbuilt through various procedures, without any check on the global smoothness of Pk\nNon-Commutative Tools for Topological Insulators 3\nwith respect to k (the Bloch wave-vector). Without such check, the constructions\nremain formal and incomplete. The issue should not be treated lightly since proving\nglobal smoothness of various objects on the Brillouin torus represents an outstanding\nproblem in the band theory. Physicists as well as mathematicians bumped into it\nwhen trying to extend Kohn\u2019s results on the analytic structure of Bloch functions\nfrom one to higher dimensions [29, 30, 31, 32, 33]. What usually happens is the\nfollowing: the objects are easily seen to be locally smooth on k and, starting from a\nsmall region of the Brillouin torus, the objects can be smoothly extrapolated to larger\nand larger regions. But when it is to cover the entire torus, point singularities in the\nfirst derivatives can develop that cannot be removed by any gauge transformation.\nProving the absence of such singularities is almost always a formidable task [30].\nThe construction of the spin-Chern number given in Ref. [28] includes a check of\nthe global smoothness of the projectors involved in the construction. Let us repeat the\nconstruction of Ref. [28], this time emphasizing this check. We will use the concrete\nmodel of electrons in graphene [34, 2]:\nH0 = \u2212t\n\u2211\n\u3008mn\u3009,\u03c3\n|m, \u03c3\u3009\u3008n, \u03c3|\n+i\u03bbSO\n\u2211\n\u3008\u3008mn\u3009\u3009,\u03c3\u03c3\u2032\n[s \u00b7 (dkm \u00d7 dnk)]\u03c3,\u03c3\u2032 |m, \u03c3\u3009\u3008n, \u03c3\n\u2032|\n+i\u03bbR\n\u2211\n\u3008mn\u3009,\u03c3\u03c3\u2032\n[z\u02c6 \u00b7 (s\u00d7 dmn)]\u03c3,\u03c3\u2032 |n, \u03c3\u3009\u3008n, \u03c3\n\u2032|.\n(2)\nHere, s is the spin operator,m and n denote the sites of the honeycomb lattice and \u03c3\nand \u03c3\u2032 the electron spin degrees of freedom, taking the values \u00b11. The Hamiltonian\nacts on the Hilbert space H spanned by the orthonormal basis |n, \u03c3\u3009. The simple\nangular brackets in Eq. 2 denote the nearest neighbors and the double angular brackets\ndenote the second nearest neighbours. Inside the second sum, k represents the unique\ncommon nearest-neighbor ofm and n. Also, dmn is the displacement from the sitem\nto the site n, with the units chosen so that the distance between nearest neighbors is\nunity. The electrons are considered non-interacting. The three terms in Eq. 2 are the\nusual nearest neighbor hopping term, the intrinsic spin-orbit coupling preserving the\nlattice symmetries and the Rashba potential induced by the substrate supporting the\ngraphene sheet. We assume that the parameters in the Hamiltonian are chosen so that\nwe are in the Spin-Hall zone of the phase diagram. At some point in the paper, we will\nview the honeycomb lattice as a triangular lattice of unit cells containing two C atoms.\nWhen we do so, we will use the notation |i, \u03b1, \u03c3\u3009 for the elementary quantum states,\nwhere i represents the position of a unit cell in the triangular lattice and \u03b1 = 1, 2 is\na label for the two atoms inside each unit cell.\nThere are two sites per unit cell and two spin states per site, therefore the model\nhas 4 states per unit cell. For the beginning, we will stay with the translational\ninvariant case, where we can use the Bloch fibration, i.e., the unitary transformation\nfrom the Hilbert space of the infinite sample into a continuum direct sum of 4\ndimensional complex spaces:\nU : H \u2192\n\u2295\nk\u2208T C\n4, (U\u03a8)(k) = 12\u03c0\n\u2211\nj e\n\u2212ik\u00b7j\u03a8(j), (3)\nwhere k lives on the Brillouin torus T = [0, 2\u03c0]\u00d7[0, 2\u03c0]. U transforms the original\nHamiltonian in a direct sum of Bloch Hamiltonians: UH0U\n\u22121 =\n\u2295\nk\u2208T H0(k), which\ndisplay two upper and two lower bands separated by an insulating gap. Let P denote\nthe spectral projector onto the states below the insulating gap of H0. Under the\nNon-Commutative Tools for Topological Insulators 4\nBloch fibration, this projector becomes: UPU\u22121=\n\u2295\nk\u2208T P (k) and the Chern number\nassociated with the family of projectors P (k) is zero, as it will generically be for any\ntime reversal invariant band model. According to Ref. [32], the fiber bundle of the\noccupied states is topologically equivalent to the trivial fiber bundle T \u00d7C2.\nIt is clear that, in order to obtain non-trivial Chern numbers, we need to split the\nprojector P (k)=P\u2212(k)\u2295P+(k) and hope that P\u00b1(k) have non-trivial Chern numbers.\nDue to the time-reversal invariance and the half-integer value of the spin, one can\nalways split P (k) like this and there are in fact an infinite way of doing the splitting\nat each k. This observation was used, for example, in Refs. [17] and [18] to give\nalternative methods of calculus for the Z2 invariant. But the big question is: Among\nthis infinite ways of splitting, is there at least one that leads to P\u00b1(k) that are globally\nsmooth over the entire Brillouin torus?\nIt appears to us that, for the model of Eq. 2, the only way to construct such\nsplitting is to use the s\u02c6z operator (s\u02c6z |i, \u03b1, \u03c3\u3009 =\n1\n2\u03c3|i, \u03b1, \u03c3\u3009). The key idea is to\nuse the spectral properties of the operator P s\u02c6zP . Indeed, after the Bloch fibration,\nUP s\u02c6zPU\n\u22121 becomes\n\u2295\nk\u2208T P (k)s\u02c6zP (k) and we can diagonalize each of the operators\nP (k)s\u02c6zP (k). If the Rashba term doesn\u2019t exceed a threshold value, the spectrum of\nP (k)s\u02c6zP (k) consists of two isolated eigenvalues, positioned symmetrically and away\nfrom the origin, for all the k\u2019s of the Brillouin torus. The spectral projectors P\u00b1(k)\nonto the positive/negative eigenvalues are smooth of k and can be used to achieve the\ndecomposition P (k) = P\u2212(k) \u2295 P+(k). At this point we can can define the Chern\nnumbers C\u00b1 for the families of projectors P\u00b1(k) and define the spin-Chern number\nas Cs=\n1\n2 (C+\u2212C\u2212). For the model of Eq. 2, Cs=1 (assuming \u03bbSO positive).\nThe smoothness of P\u00b1(k) follows from a direct computation for the particular\nmodel of Eq. 2, but a more general, model independent, proof was achieved in Ref. [28]\nbased on the fact that global smoothness of P\u00b1(k) implies exponential decay of the\nreal space kernel P\u00b1(i, j) with the separation |i\u2212j|, and viceversa, exponential decay\nimplies global smoothness. The exponential decay of P\u00b1(i, j) can be established using\ntraditional methods [35].\nBesides allowing for an explicit check of the global smoothness, the above\nconstruction also allows one to write the spin-Chern number without using the\nBrillouin torus, something that is absolutely necessary when dealing with disorder.\nIndeed, the Chern numbers C\u00b1 can be computed in real space using the following\nformula, which is completely equivalent to the k space formula:\nC\u00b1 = 2\u03c0i tr{P\u00b1 [[x\u02c61, P\u00b1], [x\u02c62, P\u00b1]]}, (4)\nwhere \u201ctr\u201d refers to the trace over the four quantum states of the first unit cell, [, ]\ndenotes the usual commutator and x\u02c6 is the position operator: x\u02c6|i, \u03b1, \u03c3\u3009 = i|i, \u03b1, \u03c3\u3009.\nP\u00b1 are the spectral projectors onto the positive and negative parts of the spectrum\nof P \u03c3\u02c6zP , respectively. This formula can be used to define the Chern numbers for the\ndisordered case. Indeed, if we add a random potential V\u03c9 to H0, one can compute\nthe projector P\u03c9 onto the occupied states of H\u03c9=H0+V\u03c9 and then investigate the\neigenvalue spectrum of P\u03c9\u03c3\u02c6zP\u03c9. For \u03bbR not exceeding a threshold value, one will\nfind that the spectrum segregates into two isolated islands, one above and one below\nzero. Therefore, one can define the spectral projectors P\u00b1\u03c9 onto the upper/lower\nislands of spectrum of P\u03c9\u03c3\u02c6zP\u03c9 and compute C\u00b1 using Eq. 4. A fundamental result in\nnoncommutative geometry [36] states the following:\nProposition 1. Let \u03a0\u03c9 be a family of projectors depending on the random variable\n\u03c9. If the matrix element \u3008i|\u03a0\u03c9|j\u3009 decays sufficiently fast with the separation |i \u2212 j|\nNon-Commutative Tools for Topological Insulators 5\n(see the following discussion) and if \u03a0\u03c9\u2019s satisfy un\u03a0\u03c9u\n\u22121\nn = \u03a0tn\u03c9 , with un being the\nlattice translation by an arbitrary n and tn a flow in the space of the random variable,\nthen:\nC = 2\u03c0i \u3008tr{\u03a0\u03c9[[x\u02c61,\u03a0\u03c9], [x\u02c62,\u03a0\u03c9]]}\u3009\u03c9 , (\u3008 \u3009\u03c9 = disorder average) (5)\nis an integer that is invariant to smooth deformations of \u03a0\u03c9\u2019s as long as they remain\nlocalized.\nRef. [28] showed that, if P\u03c9 is exponentially localized and the gap of P\u03c9 s\u02c6zP\u03c9\nremains open, then P\u00b1\u03c9 are exponentially localized. The gap of P\u03c9 s\u02c6zP\u03c9 was shown to\nremain open as long as \u03bbR is smaller than a threshold value and the disorder is not very\nstrong. Moreover, since the spin operator commutes with translations, the relation\nunP\n\u00b1\n\u03c9 u\n\u22121\nn = P\n\u00b1\ntn\u03c9 is automatically satisfied, therefore P\n\u00b1\n\u03c9 satisfy the conditions of\nProposition 1 and consequently C\u00b1 and Cs are topologically invariant integers as long\nas P\u03c9 is exponentially localized and the gap of P\u03c9 s\u02c6zP\u03c9 remains open.\n2.1. Physical consequences\nThe spin-Chern number can be used for topological classification but it will be equally\nimportant to extract non-trivial physical consequences from its remarkable properties,\nin particular, to say something about the localization of the bulk states in the presence\nof disorder. For the model defined by Eq. 2, we can establish the following fact: a\nnon-zero spin-Chern number implies existence of energy regions where the localization\nlength of the bulk states diverges, at least for small \u03bbR. In other words, there are bulk\nstates that resist localization in the presence of disorder.\nIndeed, let us imagine a numerical experiment in which we lower the Fermi level\ncontinuously, from the mid-gap all the way to \u2212\u221e, and try to repeat the construction\nof the spin-Chern number, this time starting from P\u03c9(EF )\u03c3zP\u03c9(EF ) [P\u03c9(EF ) = the\nprojector onto the energy spectrum below EF ]. When the Fermi level enters the bulk\nenergy spectrum, the spectrum of P\u03c9(EF )\u03c3zP\u03c9(EF ) can rapidly spread within the\nentire [\u2212 12 ,\n1\n2 ] interval, engulfing the origin. Even though, according to the general\nresults of Ref. [36], the Chern numbers for projectors P\u00b1\u03c9 (EF ) remain well defined\nand invariant of EF as long as the spectrum of P\u03c9(EF )\u03c3zP\u03c9(EF ) remains localized\nnear the origin, more precisely as long as:\u2329\nTr{\u03c00P\n\u00b1\n\u03c9 (EF )x\n2P\u00b1\u03c9 (EF )\u03c00}\n\u232a\n\u03c9\n<\u221e, (6)\nwhere \u03c00 is the projector onto the four states of the first unit cell. This condition says\nthat the kernel\nP\u00b1\u03c9,EF (0, \u03b1, \u03c3; i, \u03b1\n\u2032, \u03c3\u2032) = \u30080, \u03b1, \u03c3|P\u00b1\u03c9 (EF )|i, \u03b1\n\u2032, \u03c3\u2032\u3009 (7)\ndecays fast enough so that:\n\u039b\u00b1(EF ) =\n\uf8ee\n\uf8f0\u2211\ni\n|i|2\n\u2211\n\u03b1,\u03c3\n\u2211\n\u03b1\u2032,\u03c3\u2032\n|P\u00b1\u03c9,EF (0, \u03b1, \u03c3; i, \u03b1\n\u2032, \u03c3\u2032)|2\n\uf8f9\n\uf8fb\n1/2\n(8)\nis finite. The quantity inside the square root is precisely the left side of Eq. 6. \u039b\u00b1(EF )\ncan be viewed as (polarized-) localization lengths.\nOur real interest is in the true localization length:\n\u039b(EF ) =\n[\u2329\nTr{\u03c00P\u03c9(EF )x\n2P\u03c9(EF )\u03c00}\n\u232a\n\u03c9\n]1/2\n. (9)\nNon-Commutative Tools for Topological Insulators 6\nThe connection between the true and the polarized localization lengths is given by the\nfollowing relation:\n\u039b(EF )\n2 = \u039b+(EF )\n2 + \u039b\u2212(EF )\n2\n+\n\u2329\nTr{\u03c00P\n+\n\u03c9 (EF )x\n2P\u2212\u03c9 (EF )\u03c00}\n\u232a\n\u03c9\n+\n\u2329\nTr{\u03c00P\n\u2212\n\u03c9 (EF )x\n2P+\u03c9 (EF )\u03c00}\n\u232a\n\u03c9\n.\n(10)\nBut the last two lines are null when \u03bbR=0, and they remain small relative to the terms\nappearing in the first line, for small \u03bbR.\nNow as we move the Fermi level to \u2212\u221e, the Cern numbers C\u00b1 become zero,\ntherefore they must jump at some point from \u00b11 to zero. This can happen only\nif \u039b\u00b1(EF ) diverge as EF crosses certain energy regions. According to Eq. 10, this\nimplies that the true localization length \u039b(EF ) also diverges when EF crosses these\nenergy regions, at least for small \u03bbR.\n2.2. Discussion\nWe would like first to relate our findings to the numerical studies of Refs. [10, 24]. In\nthe following, if not otherwise specified, the Fermi level is considered in the middle\nof the bulk gap. The first observation is that the original construction in Ref. [28]\nconsidered same type of disorder as in these references, a white noise with amplitude\nbetween [\u2212W/2,W/2] (to keep the notation of Refs. [10, 24]]). For the model of\nEq. 1, by direct computation in the clean limit, we have verified that the gap of\nP\u03c9 s\u02c6zP\u03c9 remains open when \u03bbR is increased, all the way until the gap of H0 closes.\nThis tells us that Cs is a robust topological invariant, for the entire domain of QSH\nphase, in total agreement with the numerical observations of [10]. In Ref. [28], the\namplitude W was assumed small so that a gap remains open in the spectrum of H\u03c9,\nso this work established the robustness of Cs only in the presence of relatively small\ndisorder. The study by Sheng and her collaborators went beyond the small disorder\ncase and established that Cs remains well defined even if the insulating gap is filled\nwith localized spectrum.\nSwitching to the second numerical study [24], we would like to specify that the\ndiscussion of Ref. [28] was limited to the range W \u2264 3 of Ref. [24]. In this case, the\nexponential localization of P\u03c9 and of P\n\u00b1\n\u03c9 can be explicitly proven; therefore, according\nto our arguments, one should observe bulk states that resist localization, in line with\nthe numerical findings of Ref. [24]. Beyond W = 3, the spin-Chern number remains\na topological invariant only if the Fermi level can be placed in a region of localized\nstates, as it was already discussed above. Referring to Fig. 1 of Ref. [24], this is the\ncase for panels (a-1), (b-1) and (c-1), which correspond to W = 5 and different values\nof \u03bbR, but not for panels (a-2), (b-2) and (c-2) which correspond to W=7. Cs can be\ndefined again for panels (a-3), (b-3) and (c-3), correspoinding to W=8, but this time\nit takes a trivial value. It is interesting to notice that the evolution of the de-localized\nspectral regions with the increase of W seen in these numerical experiments can be\nactually predicted using the following arguments. As long as the Fermi level can be\nplaced in a region of localized spectrum, the spin-Chern number remain non-trivial,\ntherefore we should observe de-localized states below and above EF . It is known [37],\nhowever, that for very large values of W , all the states localize, therefore at some\npoint there should be no alternative, but to place EF in a de-localized region of the\nspectrum. But EF can be always placed in a region of localized spectrum unless the\nNon-Commutative Tools for Topological Insulators 7\nde-localized spectral regions below and above EF move towards each other and at\nsome point \u201dscissor\u201d the Fermi level. This is precisely what was observed in Ref. [24].\nSecondly, we would like to discuss some predictions. The Z2 topological invariant\ncan be computed as Cs(mod2). According to our arguments, there should be bulk\nstates that resist localization not only for odd but also for even spin-Chern numbers,\nthat is, for trivial Z2 invariants. This, for example, must be the case for the model of\nEq. 2 with spin 32 , which has |Cs|=2. Therefore, it will be very interesting to see the\ncalculations of Ref. [24] repeated for this system.\nAnother observation is that the spin-Chern number can be defined even in the\nabsence of time-reversal symmetry. Ref. [24] presented a calculation that included\na Zeeman term in the x direction, of strength hx. The results for relatively large\nmagnetic field indicate that the bulk states are entirely localized (although the\ngraph corresponding to the weaker disorder is not very conclusive in our opinion).\nUnfortunately, Ref. [24] does not discuss what happens at weaker magnetic fields,\ni.e. when the time reversal symmetry is only weakly broken. In this regime, the last\ntwo lines of Eq. 10 remain small and a divergence of \u039b\u00b1(EF ) implies a divergence of\n\u039b(EF ). In other words, we predict that, for small values of hx, there are bulk states\nthat resist localization in the presence of disorder.\nOur final remark for the section is that the present construction of the spin-Chern\nnumber can be repeated for other operators, let us call them w\u02c6, instead of s\u02c6z. If the\neigenvalue spectrum of Pw\u02c6P consists of two or more isolated islands, one can compute\nthe Chern numbers of the spectral projectors for each island and generate w\u02c6-Chern\nnumbers. A non-zero w\u02c6-Chern number is a signal of topological properties, leading to\na possible w\u02c6-Hall insulator. We hope that this observation will lead to more efficient\nsearch and discovery paths for new classes of topological insulators.\n3. Tools for the edge states\nIn 2004, the following result appeared [38]. Consider the Landau Hamiltonian H\u03c9\ndescribing free electrons in the semiplane z=0 and x>0 (therefore with an edge along\ny axis), moving in a periodic potential, a uniform magnetic field along the z axis (no\nrational flux required) and a random potential V\u03c9. Then the following is true:\u2329\ntr0\n{\n\u03c1(H\u03c9)\ndy\u02c6\ndt\n}\u232a\n\u03c9\n=\n1\n2\u03c0\nInd{\u03c7+e\n\u22122\u03c0iF (H\u03c9)\u03c7+} (11)\nwhere \u03c1(\u01eb) is any arbitrary distribution with support in a bulk energy gap of H\u03c9 and\nsuch that\n\u222b\n\u03c1(\u01eb)d\u01eb=1, the function F is defined by F (\u01eb)=\n\u222b\u221e\n\u01eb\n\u03c1(s)ds and \u03c7+(x, y) is\nthe characteristic function for the semi-plane y>0. The trace tr0 is taken over the\nstates with support in the plane y=0.\nThis is a remarkable result since it contains the first explicit proof that the\nedge states of the Landau Hamiltonian resist localization in the presence of disorder.\nIndeed, let us read again Eq. 11. The left hand side is the total charge current of the\nedge states inside a bulk energy gap of H\u03c9, weighted with the distribution \u03c1. This\ncurrent will be zero if the edge states localize. Therefore, if one can show that the right\nhand side is non-zero, he has an explicit proof that the edge states resist localization.\nBut the right hand side is the index of an operator (to be discussed shortly), which can\nbe computed explicitly and for the Landau Hamiltonian it turns out to be a non-zero\ninteger number. One can see then how Eq. 11 becomes a very effective tool for the\nstudy of the edge physics.\nNon-Commutative Tools for Topological Insulators 8\nThe above result is relevant for Landau Hamiltonians and for Chern insulators\n[26], but unfortunately is not relevant for time-reversal invariant topological insulators\nbecause their edge charge current is zero. Therefore, we need to look at the currents\nof other observables (spin, etc.). This was the main motivation behind the work of\nRef. [25]. Using non-commutative calculus, the author established a general result\nstating when and why is the current of a general observable X quantized. The result\ncan be summarized as follow. Assume:\na) Existence of a family of self-adjoint Hamiltonians H\u03c9 on H, with \u03c9 \u2208 \u2126.\nb) Existence of a 1-parameter unitary group ua such that uaXu\n\u22121\na = X + a.\nc) Existence of an ergodic flow ta on \u2126 such that uaH\u03c9u\n\u22121\na = Hta\u03c9 for all \u03c9 \u2208 \u2126.\nProposition 2. If \u03c0+ denotes the projector onto the positive eigenvalue spectrum of\nX , \u03c1(\u01eb) is a statistical distribution of the quantum states such that\n\u222b\n\u03c1(\u01eb)d\u01eb=1 and\nF (\u01eb)=\n\u222b\u221e\n\u01eb\n\u03c1(\u01eb)d\u01eb, then: [below, X\u03c9(t) = e\nitH\u03c9Xe\u2212itH\u03c9 ]\n\u2329\ntr0\n{\n\u03c1(H\u03c9)\ndX\u03c9(t)\ndt\n}\u232a\n=\n1\n2\u03c0\nIndex\n{\n\u03c0+e\n\u22122\u03c0iF (H\u03c9)\u03c0+\n}\n, (12)\nprovided the kernel of e\u22122\u03c0iF (H\u03c9) has certain localization properties.\nThe index of an operator is equal to the difference between the number of zero modes\nof that operator and the number of zero modes of its conjugate. It is an integer\nnumber, invariant to continuous deformations of the operator. The index on the right\nhand side of Eq. 12 is now called the edge index of observable X , and can be explicitly\ncomputed by deforming the Hamiltonian into simple, exactly solvable models. During\nsuch deformations, one has to make sure that the technical conditions are not violated,\nthat is, the localization of e\u22122\u03c0iF (H\u03c9).\nEq 12 can be a very useful tool for the analysis of the edge spectrum. Note\nthat the left side of Eq. 12 is zero if the spectrum of H\u03c9 is completely localized.\nTherefore, a non-zero value of the right side of Eq. 12 assures that H\u03c9 has absolutely\ncontinuum spectrum, even in the presence of disorder. It becomes clear then that\nEq. 12 establishes a very general method to demonstrate the robustness of the edge\nspectrum against disorder, which amounts to a search of an observable X for which\nthe index of the right hand side of Eq. 12 is non-zero.\nFor Quantum Spin-Hall insulators, this observable was defined in Ref. [27].\nThe construction of the observable X was based on the fact that for spin 12\nparticles and time-reversal invariant Hamiltonians, the Hilbert space can be split\ninto two sectors H=H\u2212\u2295H+ such that each of the sectors are left invariant by the\nHamiltonian and \u03c4H\u00b1=H\u2213 (\u03c4 = time-reversal operation). The observableX is simply\nX=P+yP+\u2212P\u2212yP\u2212, where P\u00b1 are the projectors onto the sectors H\u00b1 and y is the\ncoordinate along the edge. For the model of Eq. 2 with an edge and random potential,\nthe edge index of this observable is equal to spin-Chern number. In other words,\nusing the above tools, we now have an explicit proof that the edge states of Quantum\nSpin-Hall insulators resist localization when disorder is present.\nThe original and now most popular argument [34] for the robustness of the edge\nstates is based on the observation that the scattering between the right and left moving\nedge bands cannot occur in time-reversal invariant insulators. In author\u2019s opinion, this\nargument is not enough. The reason is because, although we are concerned with the\nquasi-one dimensional edge states, we are still dealing with a 2D systems. In such\nsystems, a band can scatter into an infinite number of analytically continued bands\nNon-Commutative Tools for Topological Insulators 9\nas detailed in Refs. [30] and [39]. In other words, if one takes an energy \u01eb in the\nbulk insulating gap and \u01ebn,k denotes the band energies of the model with an edge,\nthe equation \u01eb=\u01ebn,k has an infinite number of solutions, thought many of them will\noccur at complex k. Nevertheless, the incoming edge state \u03c8in will scatter into these\ncomplex k states, which are the analytic continuation of the bulk states, and time-\nreversal invariance cannot prevent this. For these reasons, it appears to the author\nthat the edge bands can backscatter through the bulk.\n4. Outlook and concluding remarks\nWe hope that the present paper makes more clear the motivation behind the somewhat\nabstract tools developed with the aid of non-commutative calculus and geometry.\nThey allow one to define robust topological invariants directly in the thermodynamic\nlimit and in the presence of disorder. Their robustness can have direct physical\nimplications and the non-commutative methods can lead to precise statements about\nthe localization of the bulk and the edge states. The list of known topological insulators\nis expected to increase in the following years and the generalization of the spin-Chern\nnumber to the w\u02c6-Chern number could aid the search and discovery of new classes\nof topological insulators. The edges of these new topological insulators could cary\ncurrents of new observables, therefore the generality of the tools developed for the\nedge physics may become more useful in the future.\nOne of the interesting and important things left unsolved is how to define the Z2\nbulk topological number without involving the Brillouin torus and how to construct\nits non-commutative theory? What are the physical implications of its robustness\nagainst disorder for the bulk states? In the author\u2019s view, these are the most pressing\nquestions in the field of topological insulators.\nAs one can see, the discussion of the paper did not touch the three dimensional\ncase at all. Unfortunately, the applications of non-commutative geometry to 3D\nsystems are very scarce. It is author\u2019s hope that the discovery of the 3D topological\ninsulators and the recent and exciting theoretical work on these systems will renew\nthe interest of non-commutative geometers and new applications will come soon.\n[1] Murakami S, Nagaosa N and Zhang S 2004 Phys. Rev. Lett. 93 156804\n[2] Kane C and Mele E 2005 Phys. Rev. Lett. 95 146802\n[3] Fu L and Kane C L 2006 Phys. Rev. B 74 195312\n[4] Murakami S 2006 Phys. Rev. Lett. 97 236805\n[5] Sugimoto N, Onoda S, Murakami S and Nagaosa N 2006 Phys. Rev. B 73 113305\n[6] Fu L, Kane C L and Mele E J 2007 Phys. Rev. Lett. 98 106803\n[7] Fu L and Kane C L 2007 Phys. Rev. B 76 045302\n[8] Teo J C Y, Fu L and Kane C L 2008 Phys. Rev. B 78 045426\n[9] Sheng D, Sheng L and Weng Z 2006 Phys. Rev. B 73 233406\n[10] Sheng D N, Weng Z Y, Sheng L and Haldane F D M 2006 Phys. Rev. Lett. 97 036808\n[11] Moore J E and Balents L 2007 Phys. Rev. B 75 121306\n[12] Murakami S, Iso S, Avishai Y, Onoda M and Nagaosa N 2007 Phys. Rev. B 76 205304\n[13] Murakami S 2007 New J. Phys. 9 356\n[14] Essin A M and Moore J E 2007 Phys. Rev. B 76 165307\n[15] Qi X L, Hughes T L and Zhang S C 2008 Phys. Rev. B 78 195424\n[16] Moore J E, Ran Y and Wen X G 2008 Phys. Rev. Lett. 101 186805\n[17] Roy R 2009 Phys. Rev. B 79 195321\n[18] Roy R 2009 Phys. Rev. B 79 195322\n[19] Volovik G E and Yakovenko V M 1989 J. Phys.: Condens. Matter 1 5263\u20135274\n[20] Sheng L, Sheng D and Ting C 2005 Phys. Rev. Lett. 94 016602\n[21] Chen W, Weng Z and Sheng D 2005 Phys. Rev. Lett. 95 086605\n[22] Sheng L, Sheng D, Ting C and Haldane F 2005 Phys. Rev. Lett. 95 136602\nNon-Commutative Tools for Topological Insulators 10\n[23] Sheng D, Sheng L, Weng Z and Haldane F 2005 Phys. Rev. B 72 153307\n[24] Onoda M, Avishai Y and Nagaosa N 2007 Phys. Rev. Lett. 98 076802\n[25] Prodan E 2009 J. Phys. A.: Math. Theor. 42 065207\n[26] Prodan E 2009 J. Math. Phys. 50 083517\n[27] Prodan E 2009 J. Phys. A.: Math. Theor. 42 082001\n[28] Prodan E 2009 Phys. Rev. B 80 125327\n[29] Nenciu G 1991 Rev. of Mod. Phys. 63 91\u2013128\n[30] Prodan E 2006 Phys. Rev. B 73 035128\n[31] Brouder C, Panati G, Calandra M, Mourougane C and Marzari N 2007 Phys. Rev. Lett. 98\n046402\n[32] Panati G 2007 Ann. Henri Poincare 8 995\u20131011\n[33] Thonhauser T and Vanderbilt D 2006 Phys. Rev. B 74 23511\n[34] Kane C and Mele E 2005 Phys. Rev. Lett. 95 226801\n[35] Prodan E, Garcia S and Putinar M 2006 J. Phys. A.: Math. Theor. 39 389\u2013400\n[36] Bellissard J, Vanelst A and Schulz-Baldes H 1994 J. Math. Phys. 35 5373\u20135451\n[37] Aizenman M and Malchanov S 1993 Commun. Math. Phys. 157 245\n[38] Kellendonk J and Schulz-Baldes H 2004 J. Func. Analysis 209 388\u2013413\n[39] Prodan E and Car R 2009 Phys. Rev. B 80 035124\n",
      "id": 673719,
      "identifiers": [
        {
          "identifier": "0911.2816",
          "type": "ARXIV_ID"
        },
        {
          "identifier": "242873713",
          "type": "CORE_ID"
        },
        {
          "identifier": "2090150",
          "type": "CORE_ID"
        },
        {
          "identifier": "10.1088/1367-2630/12/6/065003",
          "type": "DOI"
        },
        {
          "identifier": "1995333262",
          "type": "MAG_ID"
        },
        {
          "identifier": "oai:arxiv.org:0911.2816",
          "type": "OAI_ID"
        }
      ],
      "title": "Non-Commutative Tools for Topological Insulators",
      "language": {
        "code": "en",
        "name": "English"
      },
      "magId": null,
      "oaiIds": [
        "oai:arxiv.org:0911.2816"
      ],
      "publishedDate": "2009-12-15T00:00:00",
      "publisher": "'IOP Publishing'",
      "pubmedId": null,
      "references": [],
      "sourceFulltextUrls": [
        "http://arxiv.org/abs/0911.2816"
      ],
      "updatedDate": "2021-04-22T11:36:54",
      "yearPublished": 2009,
      "journals": [
        {
          "title": "New Journal of Physics",
          "identifiers": [
            "1367-2630"
          ]
        }
      ],
      "links": [
        {
          "type": "download",
          "url": "http://arxiv.org/abs/0911.2816"
        },
        {
          "type": "display",
          "url": "https://core.ac.uk/works/673719"
        }
      ]
    },
    {
      "acceptedDate": "2016-06-25T00:00:00",
      "arxivId": null,
      "authors": [
        {
          "name": "Askarian, Mahdieh"
        },
        {
          "name": "Ben\u00edtez Iglesias, Ra\u00fal"
        },
        {
          "name": "Graells Sobr\u00e9, Mois\u00e8s"
        },
        {
          "name": "Zarghami, Reza"
        }
      ],
      "citationCount": 0,
      "contributors": [
        "Universitat Polit\u00e8cnica de Catalunya. Departament d'Enginyeria de Sistemes, Autom\u00e0tica i Inform\u00e0tica Industrial",
        "Universitat Polit\u00e8cnica de Catalunya. Departament d'Enginyeria Qu\u00edmica",
        "Universitat Polit\u00e8cnica de Catalunya. SISBIO - Senyals i Sistemes Biom\u00e8dics",
        "Universitat Polit\u00e8cnica de Catalunya. CEPIMA - Center for Process and Environment Engineering"
      ],
      "outputs": [
        "https://api.core.ac.uk/v3/outputs/644307504",
        "https://api.core.ac.uk/v3/outputs/187425481",
        "https://api.core.ac.uk/v3/outputs/81571354"
      ],
      "createdDate": "2017-05-01T02:09:26",
      "dataProviders": [
        {
          "id": 4786,
          "name": "",
          "url": "https://api.core.ac.uk/v3/data-providers/4786",
          "logo": "https://api.core.ac.uk/data-providers/4786/logo"
        },
        {
          "id": 1011,
          "name": "",
          "url": "https://api.core.ac.uk/v3/data-providers/1011",
          "logo": "https://api.core.ac.uk/data-providers/1011/logo"
        },
        {
          "id": 3228,
          "name": "",
          "url": "https://api.core.ac.uk/v3/data-providers/3228",
          "logo": "https://api.core.ac.uk/data-providers/3228/logo"
        }
      ],
      "depositedDate": "2016-11-01T00:00:00",
      "abstract": "Developing data-driven fault detection systems for chemical plants requires managing uncertain data labels and dynamic attributes due to operator-process interactions. Mislabeled data is a known problem in computer science that has received scarce attention from the process systems community. This work introduces and examines the effects of operator actions in records and labels, and the consequences in the development of detection models. Using a state space model, this work proposes an iterative relabeling scheme for retraining classifiers that continuously refines dynamic attributes and labels. Three case studies are presented: a reactor as a motivating example, flooding in a simulated de-Butanizer column, as a complex case, and foaming in an absorber as an industrial challenge. For the first case, detection accuracy is shown to increase by 14% while operating costs are reduced by 20%. Moreover, regarding the de-Butanizer column, the performance of the proposed strategy is shown to be 10% higher than the filtering strategy. Promising results are finally reported in regard of efficient strategies to deal with the presented problemPeer ReviewedPostprint (author's final draft",
      "documentType": "research",
      "doi": "10.1016/j.eswa.2016.06.040",
      "downloadUrl": "https://core.ac.uk/download/81571354.pdf",
      "fieldOfStudy": "computer science",
      "fullText": "1  Data-Based Fault Detection in Chemical Processes: Managing Records with Operator Intervention and Uncertain Labels Mahdieh Askariana,c, Raul Ben\u00edtezb, Moises Graellsc*, Reza Zarghamia a School of Chemical Engineering. College of Engineering, University of Tehran. PO Box 11155-4563, Tehran, Iran  b Automatic Control Department. Universitat Polit\u00e8cnica de Catalunya. EUETIB, Comte d\u2019Urgell 187, 08028-Barcelona, Spain  c Chemical Engineering Department. Universitat Polit\u00e8cnica de Catalunya. EUETIB, Comte d\u2019Urgell 187, 08028-Barcelona, Spain  ABSTRACT  Developing data-driven fault detection systems for chemical plants requires managing uncertain data labels and dynamic attributes due to operator-process interactions. Mislabeled data is a known problem in computer science that has received scarce attention from the process systems community. This work introduces and examines the effects of operator actions in records and labels, and the consequences in the development of detection models. Using a state space model, this work proposes an iterative relabeling scheme for retraining classifiers that continuously refines dynamic attributes and labels. Three case studies are presented: a reactor as a motivating example, flooding in a simulated de-Butanizer column, as a complex case, and foaming in an absorber as an industrial challenge. For the first case, detection accuracy is shown to increase by 14% while operating costs are reduced by 20%. Moreover, regarding the de-Butanizer column, the performance of the proposed strategy is shown to be 10% higher than the filtering strategy. Promising results are finally reported in regard of efficient strategies to deal with the presented problem.  KEYWORDS: fault detection, mislabeling, label noise, underlying states, operational intelligence, interactive learning.                                                             * Corresponding author. Tel.: +34 93 413 72 75. Emails: mahdiehaskarian@ut.ac.ir (M. Askarian), raul.benitez@upc.edu (R. Benitez), moises.graells@upc.edu (M.   Graells), rzarghami@ut.ac.ir (R. Zarghami) 2  1. INTRODUCTION Monitoring of chemical processes, as many other activities, is required for determining the need for corrective actions and subsequent efficient operation. Indeed, abnormal situation management (ASM) is an essential task for loss prevention and safe operation of chemical plants. To achieve this aim, multiple protection layers (Fig. 1) are applied in industrial plants as per the international standard IEC61511 (2003), each one consisting of equipment and/or administrative controls coordinated with other protection layers (Isermann, 1994). Most automatic protection layers are triggered by actuators, while sensors\u2019 readings indicate the violation of limiting thresholds. Despite all the progress in automatic risk reduction systems (hardware and software), the operator supervision and the corrective action in ASM is still indispensable. Indeed, the operator and the automatic controls, together, constitute operational intelligence (Rajaram & Jaikumar, 2000).   The fault detection (FD) system is a core component of ASM that has attracted a lot of attention recently. Moreover, it is expected to be explicitly included in the standard IEC61511 in the near future. In fact, a fault consists of an unpermitted deviation of at least one property or parameter of a system from its acceptable, usual or standard condition (Isermann & Balle, 1997). FD methods are categorized in three main groups: quantitative model-based methods, qualitative model-based methods and data-driven methods (Venkatasubramanian, Rengaswamy, Yin, & Kavuri, 2003). Qualitative model-based FD methods are not often deployed for complex chemical process, because the corresponding analytical description is rarely available. In addition, quantitative model-based FD methods, so-called inference methods, are developed based on explicit structural knowledge and causalities (Korbicz, Koscielny, Kowalczuk, & Cholewa, 2012). These methods, which rely on experts\u2019 knowledge in a specific domain, are often costly and time-intensive to obtain. Thus, FD is commonly addressed by process history based methods, since for operating plants a large amount of historical process data is available (MacGregor & Cinar, 2012; Qin, 2012).  Data-driven FD systems early developed based on multivariable statistical analysis e.g. principal component analysis (PCA) (Lu, Yao, Gao, & Wang, 2005), partial least squares (PLS) (Chiang, Braatz, & Russell, 2001). Recently, FD has been considered as a classification problem as well, and Machine Learning provides various tools for classification, which are categorized below (Isermann, 2006): 3  \uf0b7 Geometric classifier. e.g. k-nearest neighbourhood (kNN) (Pandya, Upadhyay, & Harsha, 2013);  \uf0b7 Probabilistic classifier. e.g. Gaussian na\u00efve Bayes (GNB) (Askarian, et al., 2015; S\u00e1ez-Atienzar, et al., 2015) and the hidden Markov model (HMM) (Li, Fang, & Huang, 2015); \uf0b7 Approximation classifier. e.g. polynomial support vector machines (SVM) (Danenas & Garsva, 2015; Namdari & JazayeriRad, 2014); \uf0b7 Soft computing techniques. e.g. fuzzy classifier (Serdio, Lughofer, Pichler, Buchegger, & Efendic, 2014) and artificial neural networks (Duda, Hart, & Stork, 2001). The main advantage of FD using classification methods is the ability at dealing with unstructured information and implicit knowledge. However, each method poses some limitations that are discussed in detail by Isermann (2006). The major weak point of classifiers is vulnerability to mislabeling, which is the issue explored in this work.    In Machine Learning, the standard approach consists in training a classifier from a labeled dataset to predict the class of new samples accordingly. Usually, labels are considered given and the labeling process is assumed to be reliable (Bootkrajang & Kab\u00e1n, 2012). However, in industrial practice and process plants, assigning labels to training data may need attention and careful examination. Indeed, true labels corresponding to the state of system are usually unavailable. Mislabeling may occur for several reasons including expert errors, lack of information or data labeling by non-experts (de Fran\u00e7a & Coelho, 2015). Label uncertainty is an important issue in classification, because most classifiers are built on the hypothesis of a perfectly labeled training set. Some Machine Learning literature exist regarding effects of uncertain labels, which shows that mislabeling may detrimentally affect the classification performance and the reliability of the learned models (Brodley & Friedl, 1999; Fr\u00e9nay, de Lannoy, & Verleysen, 2011). Numerous methods have been proposed to deal with label noise. Filter approaches aim at identifying and removing any mislabeled instances (Brodley & Friedl, 1999; Zhang, Li, Yang, & Yong, 2014). A residual-based fault detection is developed which solely relies on sensor\u2019s data; and labels required for pattern recognition of fault is not demanded 4  (Serdio, Lughofer, Pichler, Buchegger, Pichler, et al., 2014). Some algorithms are naturally robust to label noise (Teng, 2005). Some methods have been modified to take label noise into account in an embedded fashion or to model the process of label corruption as part of modeling the data (Swartz, Haitovsky, Vexler, & Yang, 2004). The current literature on learning with label noise is a lively mixture of theoretical and experimental studies that clearly demonstrate both the complexity and the importance of the problem. Fr\u00e9nay and Verleysen (2014) comprehensively discussed different families of algorithms that have been proposed to deal with label noise.  A particular case of mislabeled training data occurs while operator-process interactions are involved in industrial practice. In case of abnormal events in chemical plants, operators take preventive actions as early as possible. On the one hand, one of such actions could be taken as an indication of the fault and used for training an automatic fault detection system. On the other hand, human error and lack of information about the underlying state of the system can mislead the operator, so that an unnecessary action is taken. Furthermore, the operator recognition (normal, symptom, fault\u2026) strongly depends on his or her personal characteristics and preferences (conservative / risky, experienced / untrained etc.). Although the operator is the ultimate decision maker regarding ASM, it is an actor interfering the process history, as well. Such a case is of special complexity and it is referred as mislabeling, label uncertainty and label noise, as addressed in the Machine Learning literature. In addition, the dynamic response of a chemical process following a fault and/or an operator action increases the complexity of situation (Si, Hu, Yang, & Zhang, 2011). Unnecessary actions alter process history and have adverse impacts on attributes of faulty and normal situations. Of course, plant decision makers are trading-off the cost of the action and the expected loss, and experimenting seems not an option. Nevertheless, incorrect interpretation of the system state by the operator causes mislabeling, and his or her unnecessary action impacts on the attributes.  It is worth to mention that most computer science literature dealing with label noise interprets noise as an outlier (Fr\u00e9nay & Verleysen, 2014). In other words, mislabeling is considered for each instance of attributes. This strategy is appropriate for static problems such as image processing. However, fault detection in process systems requires a 5  different approach due to its dynamic behavior. This important aspect has received scarce attention in chemical engineering, and it deserves more investigation.  These challenges motivate the development of a robust strategy for efficiently using the training datasets with uncertain labels produced in operating plants by human intervention. This strategy should be regarded as a part of a general operators\u2019 decision support framework for FD and ASM. Since the main objective is aiding the operator to make better decisions, operator actions cannot be readily identified as true faulty labels. This will lead to a model of the operator preferences that could anticipate the operator actions, not the real process faults. Conversely, questioning the actions and the labels is the starting point of the strategy proposed in this work.   This study mainly discusses about impact of human intervention on FD of a dynamic system, which is an unattended topic in the chemical engineering literature, and contributes a novel strategy to deal with this situation. The proposed FD approach includes a loop for fault detection via three parties -classifier, state space model and operator- which successively leads to evolution. The underlying state of the system is estimated using a state space model, which takes the advantage of sequential data analysis of time series. Then, the deviation from the normal state is characterized by the Mahalanobis distance, which eventually allows relabeling attributes. Iterative training of the Gaussian na\u00efve Bayes classifier is proposed to improve the operator perception and refine attributes. The solution approach provides useful tools for the plant operator to assess the need of preventive actions respect to faults. Next, this strategy is validated and discussed in three case studies, a reactor, as an illustrative example; the de-Butanizer column, as a complex example; and an industrial sweetening unit in a gas refinery as a real challenge.   2. ILLUSTRATIVE EXAMPLE  A continuous stirred tank reactor (CSTR) is a most basic unit operation in chemical engineering which is a tank equipped with an impeller. Reactants and products are continuously added and withdrawn to the tank where reaction takes place. Mixing with impeller is required to achieve uniform composition. A fault and the subsequent operator action are simulated in a jacketed, non-adiabatic, and perfectly mixed tank reactor. A 6  single first-order exothermic and reversible reaction of two components, A\u2194B, takes place. A scheme of the equipment module is shown in a Figure 2, as well as input and output variables. Volume is assumed to be constant, and inlet and outlet flowrates are equal. Density, specific heat and heat of reaction are also assumed constant. Based on the mass and energy balances, equations in appendix A.1 are derived for simulation. The change of the feed stream concentration or temperature (input variables u1t or u2t, respectively) causes the change of the outlet composition and temperature. In order to keep the reactor temperature under a specified threshold (320 \u00baC) the operator can decrease the jacket temperature u3t. Although, this problem can be easily solved by using a proportional-integral-derivative (PID) controller, a manual control by the operator is discussed to illustrate the problems associated to human decision-making in industrial processes. In other words, operator-process interactions are required in open loop systems.  The input variables are assumed unobservable to the operator; the only information that can be monitored and recorded is that of the output variables. Furthermore, the process model is assumed unavailable to the operator, who can only rely on the measurement of the reactor temperature to keep it below the limit. Scenario 1: CAf has a step change that is considered a fault in the operation. If the operator is unaware of the state of system, the reactor temperature will exceed the limit (Fig. 3 red line). Therefore, when T increases too fast (> 0.2 \u00baC/s ), the operator decreases Tj, so that T is kept under 320\u02daC (Fig. 3 blue line). Scenario 2: A minor step change in CAf  also increases T too fast, but it remains under the specified threshold (Fig. 4 red line). Therefore, it is called pseudo-fault. Since CAf is not observable, the conservative operator takes an action based on his or her intuition (experience of Scenario 1), although this time it is unnecessary. This is an overuse of cooling utility and extra cost. On the other hand, the operator labels the process data of this time interval as faulty. In addition, the preventive action changes the trend of attributes (Fig. 4 blue line).  Hence, a robust FD system is expected to reveal pseudo-fault as normal in order to prevent unnecessary and expensive action. It is clear that using this raw information for designing a classifier will lead to a low FD performance. This performance is quantified 7  in Section 4.1. Although various scenarios can be defined, the scope of this illustrative example is limited to decision making by a conservative operator. The presented case study leads to a twofold problem: \uf0b7 Avoiding bad decisions in case of pseudo-fault produced the extra cost of unnecessary preventive actions; \uf0b7 Avoiding uncertain labels and attributes that will mislead the automatic diagnosis system.  3. METHODOLOGY  The initial FD system, which is designed based on basic information (namely attributes labeled by the operator), infers the state of the system in a way very similar to operator intuition. In other words, careless use of this information leads to model the pattern of operator behavior and preferences. Thus, this cannot support successful decision in regard of the optimization of the costs corresponding to unnecessary preventive actions or potential accidents. An improved strategy is required to deal with mislabeling and the subsequent impact of operator actions on attributes (system outputs). In order to improve FD performance, retraining with a refined dataset including reliable labels and attributes is inevitable. In general, improving operator perception is required to provide a chance of producing new datasets. In hindsight and without operator actions, it is often much clearer whether the state of system is a pseudo-fault or a risky fault. However, the operator is not aware of the underlying state of system, and taking no action is risky when perceiving a potential fault. Indeed, taking no action allows further learning, but may lead to an accident. On the other hand, the performance of the initial FD system is not reliable enough to make decisions based on its prediction. Thus, a gradual improvement of the FD system can be achieved by an interactive and iterative learning procedure with an acceptable risk at each phase.  Figure 5 illustrates the interactive strategy proposed for training a classifier, which can provide a promising decision support system. It consists of three main parts shown by dashed bounding boxes: initializing, re-training, and validating. Rectangular and elliptical blocks represent available data and operations on data, respectively. The dotted elliptical blocks are flexible and can accept different tools. A grey block represents that it may be unavailable in some cases. In following sub-sections, the fundamentals of the most 8  significant blocks involved in this work are explained. They are included the dynamic linear model (DLM) to estimate the underlying state; Mahalanobis distance to characterize deviations from normal state, Gaussian na\u00efve Bayes (GNB) to classify, a validation confusion matrix to evaluate performance, and an interaction index to forward to next interactive learning phases. Then, input-output information of these tools is demonstrated. Finally, the rules and interaction of these tools are described in the general strategy.  3.1. Description of tools 3.1.1. State space models This work proposes to take advantage of the state space model to analyze time series and estimate the underlying states of a dynamic system. Given m observations, Yt=(y1t, y2t, \u2026, ymt), the n unobservable state variables, \u03b8t =(\u03b81t, \u03b82t, \u2026, \u03b8nt), are recursively computed using a state space model. Figure 6 represents the information flow of the state space model, which satisfies the following assumptions: \uf0b7 \u03b8t is a Markov chain. In other words, \u03b8t and (\u03b80:t\u22122, Y1:t\u22121) are conditionally independent given \u03b8t-1; \uf0b7 Yt\u2019s are independent conditioned on \u03b8t; and Yt depends on \u03b8t only (Petris, Petrone, & Campagnoli, 2009). The dynamic linear model (DLM) is a special case of a general state space model, being linear and Gaussian. A DLM is specified by a pair of observation equation and state equation: \uf03d \uf02bt t t tY F v\u03b8  ~ (0, )t m tv N V                 1mtY R\uf0b4\uf0ce        m ntF R\uf0b4\uf0ce      1mtv R\uf0b4\uf0ce        m mtV R\uf0b4\uf0ce  (1) 1\uf02d\uf03d \uf02bt t t tG w\u03b8 \u03b8  ~ (0, )t n tw N W  1nt R\uf0b4\uf0ce\u03b8         n ntG R\uf0b4\uf0ce      1ntw R\uf0b4\uf0ce       n ntW R\uf0b4\uf0ce  (2) where Gt and Ft are system identification matrices and vt and wt are two independent sequences of independent Gaussian random vectors with mean zero and variance matrices Vt and Wt, respectively. Maximum likelihood estimation (MLE) is a common approach for parameter identification of the model (Petris, et al., 2009).  9  The current value of the state variables can be recursively estimated based on the attributes up to time t. In a DLM, the Kalman filter allows updating the current inference on the state variables as new data become available (Lendek, Babu\u0161ka, & De Schutter, 2008). Passing from the filtering density \u03c0(\u03b8t|Y1:t) to \u03c0(\u03b8t+1|Y1:t+1) is fully detailed described in appendix A.2.   3.1.2. Mahalanobis distance The Mahalanobis distance, DM, of a vector \u03b8t =(\u03b81t, \u03b82t, \u2026, \u03b8nt)T from another group of state variables, with mean \u00b5=( \u00b51, \u00b52\u2026 \u00b5n)T  and covariance matrix, \u03a3, is defined as (Yu, 2013): 1( ) ( ) ( )TM t\uf02d\uf03d \uf02d \uf053 \uf02dt t\u03b8 \u03b8 \u03bc \u03b8 \u03bcD  (3)  3.1.3. Gaussian na\u00efve Bayes classifier Gaussian na\u00efve Bayes (GNB) classifier is a supervised learning method based on Bayes\u2019 theorem that can be applied for fault detection. The probability of each fault as a class can be determined regarding attributes as below (Mehranbod, Soroush, Piovoso, & Ogunnaike, 2003): \uf028 \uf029\uf028 \uf029 \uf028 \uf029\uf028 \uf029tt ttY F FF YY\uf070 \uf070\uf070\uf070\uf03d  (4) where \u03c0(Yt|F) is the probability of attributes conditioned on the fault F and \u03c0(F) is the a priori probability, which gives the probability of the class before measuring any attributes. The divisor \u03c0(Yt) is merely a scaling factor to assure that a posteriori probabilities are normalized.  3.1.4. Key performance indicators  The performance of classifiers is evaluated by comparing predicted faults and true faults. In this order, FD outcomes are arranged in a validation confusion matrix (Monroy, Villez, Graells, & Venkatasubramanian, 2012) presented in Table 1.   10  Table 1: Validation confusion matrix    True label   F \u00acF Predicted label F a b \u00acF c d where a is the number of samples corresponding to faulty situations and diagnosed as such (true positive); b is the number of samples diagnosed as faulty but were not (false positive); c is the number of samples  corresponding to faulty but not diagnosed situations (false negative) and d is the number of samples not happened and not diagnosed (true negative). Then, performance indexes including accuracy, F1, and true positive rate (TPR) are calculated as follows: Accuracya da b c d\uf03d\uf02b\uf02b \uf02b \uf02b   (5)                                                             122Faa b c\uf03d\uf02b \uf02b  (6) TPR \uf03d\uf02baa c (7)  3.1.5. Interaction index Due to the unavailability of true labels in real practice, labels estimated by an operator and a classifier play some roles in interactive learning of the FD system described in the subsequent sections. As such, a comparison of classifier prediction and labels assigned by the operator based on his or her intuition is made by an interaction confusion matrix in Table 2.  Table 2: Interaction confusion matrix    Operator label   F \u00acF Predicted label F a\u2019 b\u2019 \u00acF c\u2019 d\u2019  where a\u2019 is the number of samples to which the operator and the classifier assign fault labels to the state of a system; b\u2019 is the number of samples diagnosed as faulty in contrast with operator opinion; c\u2019 is the number of samples corresponding to faulty but not 11  diagnosed situations; and d\u2019 is the number of samples for which both the operator and the classifier agree that no fault happens.  It is generally agreed that the operator and the automatic FD system are complementary for ASM (Sheridan & Johannsen, 1976). However, it is required to take into account the conflict between operator labels and classifier predictions to manage uncertain records. For instance, a conservative operator hastily assigns a fault to the system regarding any minor disturbance or so called pseudo-fault. While the classifier predicts this situation as the normal state, it is reflected in c\u2019. On the other hand, a risky operator may not react to a faulty situation which is diagnosed as such and is categorized as b\u2019. The main idea is to gradually encourage an operator to provide a chance of generating more informative dataset, i.e. new trends of attributes in subsequent learning phases. It is required to determine to which extent the operator takes no action in potentially faulty situations at each phase. Thus, an interaction index is introduced in Eq. 8, which quantifies the conflict. ( )( )interactiond aI Accuracy ARLb d c a\uf0a2 \uf0a2\uf03d \uf02d \uf0b4\uf0a2 \uf0a2 \uf0a2 \uf0a2\uf02b \uf02b (8) where the first and second terms reflect extremes of risky and conservative operators conflicts with a classifier prediction, respectively; and a correction factor consists of accuracy of a classifier and ARL corresponding to acceptable risk level of a chemical plant. Indeed, the risk level is defined as multiplication of probability and consequence of a faulty situation (Bao, Khan, Iqbal, & Chang, 2011). An acceptable risk level depends on the type of chemical plants and the policy of owners.  Moreover, note that the various classifiers facing ideal datasets (certain labels) have different performance levels. Designing an FD system with a high performance classifier, the conflict (i.e. c\u2019 and b\u2019) reflects in an interaction confusion matrix is mainly due to wrong human perception. Thus, accuracy of classifier is a correction factor of Iinteraction.  Based on the proposed procedure in Section 3.2, higher Iinteraction encourages more change in attributes of datasets in the next learning phase. In fact, this index is the extent of changes between learning phases. For example, involving a conservative operator leads to higher c\u2019; and higher Iinteraction subsequently. If the classifier has high performance, the available interaction confusion matrix is more reliable, and keeps Iinteraction high. On the other hand while the chemical process deals with high risk, ARL is low. As such, Iinteraction 12  is adjusted accordingly to specify the acceptable change ratio in the next learning phase. In general, Iinteraction is a dynamic index which is updated in any learning phase, and specifies speed of learning.  Finally, a general scheme of these significant blocks and their input-output information is represented in Figure 7. Parameters involved in each block as a part of a data-based FD system are fitted based on subsets of a typical dataset.    3.2. Iterative and interactive procedure The operator continuously needs to make decisions, as well as the training data set can be continuously refined. However, in order to make a quantitative assessment, the proposed strategy (Fig. 5) is evaluated in different discrete phases in an offline manner. The dataset at each phase, Dp, includes attributes of the process system, 1:rpTY , and paired labels, 1:rpTF , as below: \uf07b \uf07d1: 1:( , ) | 1:\uf03d \uf03drp rpp T TD Y F r R  p=0,1,2,\u2026,  P (9) where T is the time horizon of the rth run; and R is the number of runs included in the pth phase. Total number of phases, P, depends on the required iterations. Each phase of data is spilt into training and testing subsets.  Step 1: The initial dataset, Di|i=0, is a collection of R runs paired with operator labels. Note that in the initial learning phase, the only information source regarding labels is operator. After training the classifier, the predicted labels of the testing subset are compared with operator labels (Table 2). In addition, based on the comparison of predicted labels with true labels (Table 1), the key performance indicators (KPIs) (Eqs. 5-6) are evaluated. It should be noted that 1:rpTY  and paired true labels of the illustrative case study (CSTR) are originated from the process model. Since it is not generally applicable, the process model block in Figure 5 is in grey.  Step 2: The conflict between operator labels and GNB prediction is reflected in Iinteraction index (Eq. 8). In the next phase, operator action is taken or not in regard of this ratio, so that there is a chance to produce a new dataset at the expense of an acceptable risk level. In other words, Di|i=1 includes R\u00d7Iinteraction runs without action and R\u00d7(1-Iinteraction) runs with action when potential faulty situations are faced.  13  Step 3: Parameters of the state model, DLM, are identified using MLE. In fact, DLM identification is based on the normal samples predicted by GNB, which is trained in the previous learning phase. Then, each attribute sample of Di|i=1, rptY , is recursively projected to \u03b8trp =(\u03b81t, \u03b82t, \u03b83t) using the trained state model to explore the underlying state of the system.  Step 4: Mahalanobis distance, DM, of each sample of the three dimensional state trajectories from the predicted normal subset is evaluated. The points beyond a specified threshold (median of all points) are labeled as faulty and others are labeled as normal. Step 5: After retraining the classifier based on Di|i=0,1, the labels predicted for the testing subset.  Step 6: Gradual refining of Di is achieved by iteratively repeating steps 2-5. Finally, it is worth to note that various strategies dealing with mislabeling (Fr\u00e9nay & Verleysen, 2014) may be investigated and compared. However, this framework only focuses on the impact of human intervention on FD of a dynamic system, which is a new topic in the chemical engineering literature. In addition, fault prognostic is beyond the scope of this work.  4. RESULTS AND DISCUSSION  4.1. CSTR In Section 2, the CSTR case study has been introduced to illustrate some problems posed to FD by the operator-process interaction. In this section, the proposed data-driven algorithm is validated on the database generated by the CSTR model. The time horizon of each run is considered 400 s, while the step change (fault and pseudo-fault) happened at t=200 s for both scenarios (Figs. 3-4). In the simulation, random noise (in range of \u00b12%) was added to the input variables and propagated to the output variables. In addition, the conservative operator takes preventive actions while symptoms of a potential fault appear. Thus, operator labels of samples after action are all considered faulty.  The initial dataset of the CSTR case study is a set of runs as defined below: \uf07b \uf07d0 00 1:400 1:400( , ) | 1: 200\uf03d \uf03dr rD Y F r  (10) 14  D0 is spilt into 70:30 ratio for training and testing the classifier. It is notable that true labels of samples after action regarding Scenario 1 are faulty, while regarding Scenario 2 are normal.  The performance of the trained GNB classifier regarding D0 is assessed in terms of F1 and accuracy. The result reveals that the initial training phase seems inefficient for FD due to low discrimination performance (Table 3). Since the underlying state of system is hidden, operator-process interaction is under uncertain condition. Therefore, unnecessary preventive actions lead to mislabeling and masked attributes. In addition, based on the validation confusion matrix, the extra cost of utility consumption is proportional with the false positive rate (FPR) as follows:   FPR \uf03d\uf02bbb d  (11)                                                             which means that the operator wrongly distinguishes the situation as faulty and unnecessarily reacts. In fact, this initial FD system is not useful for reducing the excess cost. The main reason is that GNB emulates the operator behavior, but not the process at this iteration.  Table 3: FD performance using iterative procedure  Learning phase Initial 1st  2nd 3rd 4th  Iinteraction % 0 5 13 21 32 F1 Normal 0.82 0.89 0.92 0.93 0.94 Fault 0.68 0.77 0.81 0.84 0.85 Accuracy 0.77 0.86 0.89 0.90 0.91 TPR % 99.16 98.58 98.81 98.95 99.07 FPR % \uf0b5  Unnecessary utility consumption  30.26 17.79 13.17 11.46 9.51 FNR % \uf0b5  Accident  0.84 1.42 1.19 1.05 0.93  In order to improve FD performance, it is essential to provide a successive refinement of the datasets, including reliable labels and comprehensive attributes. First, the datasets are gradually enriched by generating new trends of attributes. Then, labels are automatically assigned to skip human error. This goal is achieved by following steps 2-4 of the proposed procedure (Section 3.2). Thus, the operator behavior toward the process is systematically changed by considering Iinteraction. Because it is assumed that the operator is conservative, b\u2019 is equal to zero; and the conflict of the operator and the classifier is 15  limited to c\u2019 (Table 2). Moreover, for sake of simplicity, the correction factor in Eq. 8 is considered as one herein. Note complementary scenarios, investigation the effects of ARL and classifier accuracy, can be explored in further works; and it is not in line with the main goal of the present study. Here, operational intelligence intends to improve process operation in terms of reducing unnecessary actions. In this case study, for the first phase of retraining, 11:400rY consists of 190 random runs with action and 10 random runs without action (95:5 ratio based on Iinteraction). The normal subset is separated by GNB which is trained in the initial phase. Then, this subset is used for identification of DLM by MLE in the first learning phase. Relabeling the new dataset is accomplished by exploring the underlying state of the system. In other words, each sample, 1 3 1rtY R\uf0b4\uf0ce , is projected to 1 3 1rt R\uf0b4\uf0ce\u03b8 . After projecting 11:400rY to three-dimensional state trajectories, DM is calculated for each sample. Most potential faulty samples of Scenarios 1 and 2 can be discriminated by a median threshold (Fig. 8). Therefore, 11:400rF consists of fault label for each sample that exceeds the threshold and normal label for others.  The GNB classifier is retrained and tested by 70:30 of available information, {D0, D1} respectively. Table 3 shows that significant improvement in terms of F1 and accuracy is achieved via the first learning phase, which leads to a reduction of utility consumption as well. On the other hand, the accident rate is proportional with the false negative rate (FNR) as follows: FNR \uf03d\uf02bca c  (12)                                                             The accident rate increases, because the operator takes a risk by not responding to some potential faulty situations. Indeed, a cost for providing comprehensive information and learning is quite reasonable; this is reflected in the accident probability in this case study.  It is notable that the conflict between the operator and the classifier increases in this retraining phase in which Iinteraction is equal to 13%. Indeed, the proposed FD algorithm is successful in deviating from the prior operator perception and increasing the accuracy of prediction simultaneously. In other words, the FD system classifies the pseudo-fault as the normal state, despite the operator idea at the initial phase. It is mainly due to reflection the process state rather than the pattern of operator behavior.  16  There is a promotion of iteratively continuing this procedure to refine datasets and improve FD performance. In general, using two automatic discrimination tools in parallel (DLM and GNB) is complementary, since it reduces misclassification and results more reliable for the operator. In fact, the proposed methodology consists in a loop for assigning labels via three parties (classifier, state space model and operator), which leads to evolutionary improvement of the main learning elements: the data-based models and the understanding of the operator. As such, the operator perception regarding the state of system is more realistic after this interactive learning process. Table 3 represents the accuracy of discrimination of fault by FD system increases in 2nd to 4th retraining phases. In other words, the sole classifier is not efficient (note the initial accuracy), and the proposed strategy improves FD accuracy. In addition, unnecessary utility consumption has decreasing trend, which reveals that the last FD system successfully supports the operator in making decisions that are more profitable. In addition, the negative accident rate in the 2nd to 4th retraining phases is a promising result. Although the first retraining phase is more vulnerable to accidents, it provides a chance to take more information about the response of the system. In fact, the chance of more wrong decisions in the initial learning phase is possible. Thereafter, this prior information is useful for the discrimination of faults and the prevention of accidents (or any unwanted situation).   4.2. Detection of Flooding in a Column  4.2.1. Flooding in de-Butanizer column  The goal of this part is to evaluate the FD system by addressing a common reported fault of the chemical industry in a simulation environment. Distillation is a widespread unit operation, which is used to separate some components in a feed stream. Figure 9 illustrates the basic components of a distillation system i.e. De-Butanizer.  The vapor from the reboiler flows up the column, countercurrent to the liquid flowing down the column. The components in the feed stream (No. 1-2 in Fig. 9) are separated according to their relative volatilities. Butane is the most volatile component and tends to concentrate in the vapor flowing up the column. Components with lower volatility tend to concentrate in the liquid flowing down the column. Eventually, the vapor enriched in Butane exits from the top of the distillation column, and after passing the condenser is 17  collected in the reflux drum. A portion of the condensed liquid is fed back into the column. The rest of the liquid exits the process as the top product (Ludwig, 1997).  Flooding is a common abnormal process condition that leads to poor separation and off specification products (Kister, 2006). In runaway flooding, the liquid level continues to rise, and if it is not stopped, the column can actually overflow. Furthermore, flooding causes overpressure in the column, which potentially leads to burst of the rupture disc and to have process downtime. Less frequently, vapor slugging through the liquid also cause trays uplift and damage.  Flooding may happen due to an excess of hydraulic traffic across the column which is represented in Figure 10. Usually, one cause of flooding is too much reflux rate which interrupts mass balance. Since reflux is assumed as a heat sink, excess reflux also interrupts energy balance and disrupts temperature profile. Consequently, it leads to condense of vapor and increase of liquid level in a tray which makes flooding worse. An operator usually recognizes flooding through an increase of deferential pressure of the column. Thereafter, inevitable flaring of the off-specification products results in economic loss. Meanwhile, in order to recover the normal state, the manual corrective action is reconfiguration of controllers (Fig. 10). In other words, an operator moderates the fault by changing set points and retuning control loops which is assumed as a supervision control.  Another cause of potential flooding is an increase of the relative vapor velocity (Fig. 10). Excess reboiler heat duty causes too much vapor to be boiled up, which increases the vapor flow up the column. This abnormal hydraulic traffic leads to an increase of the differential pressure, which is monitored by an operator. Although, a temporary perturbation via this pseudo-fault happens, flaring and corrective actions by an operator are not required in most of the cases. Since excess vapor in the column increase temperature of trays, a temperature controller automatically decreased the reboiler duty (Fig. 10). Thus, the state of column is automatically recovered to normal state in a short time. Generally, operator interaction with process in this case is sort of mislabeling the FD dataset.    18  4.2.2. Relabeling strategy   The dataset required for developing the FD system is provided by a simulation of the de-Butanizer in the Dynamic Aspen-Plus environment. This complex case study includes 5 closed control loops (Fig. 9). In order to resemble data streaming, the occurrence time of the fault is unknown. In other words, either the fault or the pseudo-fault is randomly triggered on unfixed time in each simulation run.  Records of 30 process variables are collected in the initial dataset: \uf07b \uf07d0 00 1:3000 1:3000( , ) | 1:100\uf03d \uf03dr rD Y F r  (13) The initial trained GNB classifier based on D0 is evaluated in terms of F1 and accuracy. In this order, the true labels are determined by the Kister-Hass factor (Kister, 1992) based on the hydraulic state of the de-Butanizer column. Then, the iterative procedure of FD is implemented. The results (Table 4) reveal that the final FD system produces higher accuracy than the sole classifier in the initialization. The rates of fault impacts, i.e. flaring and runaway flooding, are also decreased. Therefore, the proposed strategy promises a successive refinement of the datasets, and consequently an efficient diagnosis system. Regardless of the classifier types and the state space model, this positive trend is expected, because the strategy is focused on the refinement of attributes and labels.  Table 4: Diagnosis performance of flooding using iterative procedure  Learning phase Initial 1st  2nd 3rd 4th 5th  6th   Iinteraction % 0 3 9 13 16 18 20 F1 Normal 0.83 0.85 0.87 0.89 0.91 0.92 0.93 Fault 0.65 0.72 0.78 0.82 0.86 0.88 0.90 Accuracy 0.70 0.76 0.81 0.85 0.88 0.90 0.92 TPR% 99.62 99.48 99.43 99.46 99.48 99.49 99.60 FPR %\uf0b5  Unnecessary flaring  31.03 20.69 18.17 15.98 13.51 11.02 9.58 FNR %\uf0b5  Runaway flooding  0.38 0.52 0.47 0.44 0.42 0.41 0.40  It is worth to consider that the control loops in the process make it robust with regards to small perturbations due to a pseudo-fault. This robustness is a kind of passive fault-tolerance (Patton, 2015). In this way, the interaction of an operator with the process is less demanded, which leads to lower potential human error. Consequently, the change of Iinteraction in sequential learning stages is smoother for closed loop systems rather than for 19  open loop ones. However, for a severe process fault exceeding this tolerance, the control system cannot compensate the fault. Thus, an active fault-tolerant system requires fault-detection methods and a reconfiguration mechanism. Moreover, the correction factor of Iinteraction (Eq. 8) is a controller of the speed of learning. The less the plant can tolerate unwanted situations, the more the ARL and Iinteraction is reduced. In addition, an inaccurate classifier adversely impacts on the confidence of the FD system. Consequently, Iinteraction adjusts the extent of changes and the chance of wrong decisions. In general, learning from the experience improves operator understanding, and enhances the FD system. Certainly, there is a trade-off between the cost of learning (the cost of the risk, depending on the situation and the process) and the reward from learning (the better FD and flaring reduction, in this particular case). Optimization of this problem is beyond the scope of this work and deserves further research.  4.2.3. Filtering strategy  There are various strategies dealing with mislabeling (Fr\u00e9nay & Verleysen, 2014). The aim of this subsection is the comparison of the proposed approach with a filtering approach. In order to improve the quality of the training data, the samples with uncertain labels can be removed following the procedure described in Section 3.2 except Stages 3-4. Alternatively, any sample inconsistently labelled by the operator and the classifier is omitted from the database. The idea is to refine the training data via selecting reliable samples; and to develop a more efficient classifier.  The filtering strategy is iteratively implemented on the de-Butanizer dataset. Figure 11 shows its performance in terms of accuracy, and it is compared with the proposed strategy. Despite the increasing trend of accuracy in sequential learning stages of the filtering strategy, but it is not as efficient as relabeling strategy. The main reason is that the relabeling strategy tries to consider the pseudo-fault as the normal state, despite the operator idea at the initial phase. Indeed, it is important to include the pseudo-fault subset into normal subsets, which leads to the improvement of the discrimination boundary. This strategy shows to have higher performance than discarding the pseudo-fault subset. As such, the FD system upgrades to distinguish pseudo-faults from risky faults.    20  4.3. Industrial Challenge  The real nature of the problem is next illustrated in an industrial challenge, for which the methods and tools proposed are applied in a limited way. The problem is first described and next it is analysed in regard of the available information and the data processing produced for the first learning stage.  Implementing the iterative strategy proposed in an industrial plant, and accordingly obtaining new data from it, is beyond the scope of this study since the necessary feedback cannot be afforded in the short term. Therefore, the results obtained reveal the opportunities to improve the operator decision-making, and indicate the course for further action. The removal of sour gas components from gas streams, using chemical solvents such as amines, is a requirement in most gas processing plants. The acid gas constituents (H2S and CO2) react with an aqueous solvent in a high-pressure absorber which is a column equipped with trays (Fig. 12). Subsequently, the solvent is directed to a regenerator and stripped from the acid gas in at elevated temperature to reuse it.  One of the most frequent problems in a gas-sweetening unit is amine foaming in the absorber, which results in loss of proper vapor-liquid contact, solution hold up and poor solution distribution. The adverse consequences include off-specification product, excessive amine loss, reduced gas-treating capacity, and energy loss. For resolving the problem, antifoam is injected into the amine recirculation system at several sensitive points. Antifoams are chemicals formulated to allow expansion of liquid film of amine bubbles and formation of thin spots, which subsequently lead to rupture of bubbles (Sheilan, Spooner, Street, & van Hoorn, 2005). In practice, the operator monitors online data to estimate the state of the system. The following symptoms are usually helpful to the operator for foaming detection: \uf0b7 Fluctuating pressure drop in the absorber  \uf0b7 Increase of flash gas  \uf0b7 Amine carryover from absorber or flash tank \uf0b7 Swinging liquid levels in any vessel \uf0b7 Decrease in H2S removal with increase in CO2 removal \uf0b7 Off-specification treated gas 21  Furthermore, it is possible to get samples of the amine solution to check foaming potential using the shake test. However, this offline test is not common due to delay in getting results and hazard of sour gas in the amine solution. On the other hand, developing an accurate first principle model of this industrial process is impracticable. As such, achieving true labels regarding the dataset is almost challenging. Therefore, online monitoring and state estimation typically is preferred to redundant shake test, which is herein required for validation.  In case of severe foaming, the operator can inject fast and massive antifoam by a centrifugal pump. Indeed, an online foaming sensor and a close control loop are not available in the plant. On the other hand, the operator may be misled by temporary pressure fluctuation of the absorber column due to vortex of liquid in the bottom of the column (a pseudo- fault). Then, unnecessary antifoam injection by an operator can lead to long-term process drawbacks, such as the reduction of amine filter efficiency or the formation of heat stable salts. Wrong decision-making leads to extra costs, direct and indirect, including antifoam consumption, more frequent filter maintenance, and corrosion due to salts. Therefore, it is required that the operator makes right decisions regarding the convenience of antifoam injection (Kister, 2006; Sheilan, et al., 2005).  An efficient FD system can aid the operator to deal with this dilemma. First, records of 26 in-situ sensors of pressure, level, flow and temperature in significant parts of the gas-sweetening unit of a real plant are provided. An initial dataset including observations and operator labels is as follows: \uf07b \uf07d0 00 1:4000 1:4000( , ) | 1: 24\uf03d \uf03dr rD Y F r  (14) The GNB classifier is fitted based on the training subset of D0.  In order to evaluate performance, the 3-folded cross-validation is implemented. The cross validation is important to check the classification robustness against the particular choice for the training and testing datasets. The predicted labels of the testing subset are compared with the true labels, which have been achieved according to the shake tests (Table 5). Thereafter, the conflict between operator labels and FD predictions is investigated. Iinteraction reveals the existence of unnecessary actions and indicates a promising opportunity for improving FD in further refining phases. In addition, the low standard 22  deviation values (\uf073) of the 3-folded validation (Table 5) show the stability of the classifier in prediction.  Table 5: The initial learning phase of the foaming detection system  Iinteraction Accuracy 1st fold 0.8382  0.6246 2nd fold 0.8322 0.6218 3rd fold 0.8384 0.6291 3-folded Validation [\u00b5,\uf073] [ 0.8332,0.0031] [0.6251,0.0052]  In order to improve the performance of the initial FD system, its implementation in the industrial plant is required, so that new datasets can be generated. However, this is highly resource consuming and getting more information from industrial practice, this is beyond the scope of the work presented. On the other hand, this case study highlights the industrial challenges of operator-process interaction on FD, and the significance of this problem, which clearly needs more attention and further investigation.   5. CONCLUSIONS This work addresses efficient data-driven FD for complex chemical processes in the framework of operational intelligence, for which the effect of the inevitable operator-process interaction on process history records needs to be taken into account.  On the one hand, prior operator knowledge is required, as well as operator preventive actions, which are in turn considered true indications of faulty situations. However, some historical records in the database may be mislabeled due to human error. This has an adverse impact on the performance of an automatic FD system based on such data and such labels. On the other hand, the operator actions, necessary or not, alter the system dynamics and may interrupt the recording of process data (dynamic attributes) corresponding to a true fault. Results of the illustrative CSTR case study showed that the GNB classifier trained based on the initial dataset just provides a model of operator preferences. Furthermore, it also showed that this policy incurred in unnecessary utility consumption. Thus, there was a motivation to provide refined datasets by managing label uncertainty and dynamic attributes of the system.  23  In order to resolve mentioned FD challenge, an iterative framework was proposed. Relabeling was done based on the estimation of the underlying state and a discrimination criteria defined as median of Mahalanobis distance. In addition, operator behavior toward the system was also shown to improve by considering the interaction index and an acceptable risk level. Indeed, this procedure provided the chance of generating new attributes at each training phase.  The FD system was developed and tested for a CSTR and flooding of a simulated de-Butanizer column. Iterative retraining of the GNB classifier through successive refined datasets led to higher detection performance in terms of accuracy and F1. The proposed FD system aided the operator to make better decisions in regard of the extra cost connected to unnecessary actions. Furthermore, the results revealed that the proposed FD strategy is more efficient than the filtering strategy. Nevertheless, collecting new information on the system response in the absence of operator actions was shown to be at expense of increased accident rate in the early phases of learning, as should be expected in regard of natural learning. Thereafter, this information was shown to be useful for more efficient discrimination in further learning phases, which leaded to decreasing rate of accidents (or unwanted situations). The cost of learning, and the trade-off with the associated risks and losses, suggests a challenging optimization problem and further research lines including incremental learning can be envisaged from this work. Thus, more parameters need to be involved; e.g. fault intensity and its consequences. Furthermore, a foaming case study in a gas refinery introduces an industrial challenge which reveals that FD under operator-process interaction is an important open research problem. However, the cost of obtaining data from true faulty situations in industrial practice is difficult. Finally, the main issue in this work was fault detection, which is a binary classification (normal - abnormal). A limitation of the proposed scheme is the incapacity of dealing with multiple faults, which needs more general discrimination boundaries. In fact, the bottleneck is the criteria based on Mahalanobis distance which is binary. In addition, for fault prognosis, it is required to include additional modules into the proposed framework in a further work.   24  NOMENCLATURE a  number of true positive samples a\u2019   number of faulty samples by the operator and the classifier  b  number of false positive samples  b\u2019  number of samples diagnosed as faulty in contrast with operator  opinion  c  number of false negative samples c\u2019  number of samples labeled faulty by operator but not diagnosed  CA  concentration of A in the outlet stream CAf  concentration of A in the feed stream CB  concentration of B in the outlet stream d  number of true negative samples  d\u2019 number of samples which both the operator and the classifier have agreement on no fault happened. DM  Mahalanobis distance Dp   dataset at each phase F   fault  Ft  identification matrices of observation equation Gt  identification matrices of state equation Iinteraction interaction index m   number of attributes pth   counter of phase R   number of runs rth   counter of runs T   temperature of the reactor t   time  T  time horizon Tf  temperature of the inlet stream Tj  temperature of the jacket   vt  Gaussian random vectors of observation equation Vt  variance matrices of observation equation wt  Gaussian random vectors of state equation   Wt  variance matrices of state equation Yt  attributes 25  Greek symbol \u03b8t  state variables \u03a3  covariance matrix \u00b5   mean  \uf073  standard deviation  \u03c0  probability  Acronyms ASM   abnormal situation management  ARL  acceptable risk level CSTR  continuous stirred tank reactor DLM  dynamic linear model FD  fault detection  FDA   Fisher discriminant analysis  FPR  false positive rate FNR  false negative rate GNB  Gaussian na\u00efve Bayes HMM   hidden Markov model  KPI  key performance indicator MLE   maximum likelihood estimation PCA   principal component analysis  PID  proportional, integral and derivative  PLS   partial least squares  SVM  support vector machines  TPR  true positive rate  ACKNOWLEDGEMENTS Special thanks are directed to Mr. Amin Hasani and Mr. Ahmed Shokry for helpful discussion. Financial support from the Iranian Pars Oil and Gas Company is acknowledged. Also, this work has been partially funded by the Spanish Ministry of Economy and Competitivity (MINECO) through the Project ECOCIS (Ref. DPI2013-48243-C2-1-R).  26  REFERENCE: Askarian, M., Escudero, G., Graells, M., Zarghami, R., Jalali-Farahani, F., & Mostoufi, N. (2015). Fault Diagnosis of Chemical Processes with Incomplete Observations: A Comparative Study. Computers & Chemical Engineering, 84, 104-116. Bao, H., Khan, F., Iqbal, T., & Chang, Y. (2011). Risk\u2010based fault diagnosis and safety management for process systems. Process Safety Progress, 30, 6-17. Bootkrajang, J., & Kab\u00e1n, A. (2012). Label-noise robust logistic regression and its applications. In P. A. Flach, T. D. Bie & N. Cristianini (Eds.), Machine learning and knowledge discovery in databases (pp. 143-158). Berlin Heidelberg: Springer. Brodley, C. E., & Friedl, M. A. (1999). Identifying mislabeled training data. Journal of Artificial Intelligence Research, 11, 131-167. Chiang, L. H., Braatz, R. D., & Russell, E. L. (2001). Fault detection and diagnosis in industrial system. London: Springer. Danenas, P., & Garsva, G. (2015). Selection of support vector machines based classifiers for credit risk domain. Expert Systems with Applications, 42, 3194-3204. de Fran\u00e7a, F. O., & Coelho, A. L. (2015). A biclustering approach for classification with mislabeled data. Expert Systems with Applications, 42, 5065-5075. Duda, R. O., Hart, P. E., & Stork, D. G. (2001). Pattern classification (2nd ed.). New York: John Wiley & Sons. Fr\u00e9nay, B., de Lannoy, G., & Verleysen, M. (2011). Label noise-tolerant hidden Markov models for segmentation: application to ECGs. In  Machine learning and knowledge discovery in databases (pp. 455-470). Belgium: Springer. Fr\u00e9nay, B., & Verleysen, M. (2014). Classification in the presence of label noise: a survey. IEEE Transactions on Neural Networks and Learning Systems, 25, 845-869. IEC61511. (2003). Functional Safety: Safety instrumented systems for the process industry sector. Geneva, Switzerland: International Electrotechnical Commission. Isermann, R. (1994). On the applicability of model-based fault detection for technical processes. control engineering practice, 2, 439-450. Isermann, R. (2006). Fault-diagnosis systems: an introduction from fault detection to fault tolerance: Springer Science & Business Media. Isermann, R., & Balle, P. (1997). Trends in the application of model-based fault detection and diagnosis of technical processes. control engineering practice, 5, 709-719. Kister, H. Z. (1992). Distillation design : McGraw-Hill New York. Kister, H. Z. (2006). Distillation troubleshooting: John Wiley & Sons  Korbicz, J., Koscielny, J. M., Kowalczuk, Z., & Cholewa, W. (2012). Fault diagnosis: models, artificial intelligence, applications: Springer Science & Business Media. Lendek, Z., Babu\u0161ka, R., & De Schutter, B. (2008). Distributed Kalman filtering for cascaded systems. Engineering Applications of Artificial Intelligence, 21, 457-469. Li, Z., Fang, H., & Huang, M. (2015). Diversified learning for continuous hidden Markov models with application to fault diagnosis. Expert Systems with Applications, 42, 9165-9173. Lu, N., Yao, Y., Gao, F., & Wang, F. (2005). Two\u2010dimensional dynamic PCA for batch process monitoring. AIChE Journal, 51, 3300-3304. Ludwig, E. E. (1997). Applied process design for chemical and petrochemical plants (Vol. 2): Gulf Professional Publishing. MacGregor, J., & Cinar, A. (2012). Monitoring, fault diagnosis, fault-tolerant control and optimization: Data driven methods. Computers & Chemical Engineering, 47, 111-120. Mehranbod, N., Soroush, M., Piovoso, M., & Ogunnaike, B. A. (2003). Probabilistic model for sensor fault detection and identification. AIChE Journal, 49, 1787-1802. Monroy, I., Villez, K., Graells, M., & Venkatasubramanian, V. (2012). Fault diagnosis of a benchmark fermentation process: a comparative study of feature extraction and classification techniques. Bioprocess and Biosystems Engineering, 35, 689-704. 27  Namdari, M., & JazayeriRad, H. (2014). Incipient fault diagnosis using support vector machines based on monitoring continuous decision functions. Engineering Applications of Artificial Intelligence, 28, 22-35. Pandya, D., Upadhyay, S., & Harsha, S. (2013). Fault diagnosis of rolling element bearing with intrinsic mode function of acoustic emission data using APF-KNN. Expert Systems with Applications, 40, 4137-4145. Patton, R. J. (2015). Fault-tolerant control. Encyclopedia of Systems and Control, 422-428. Petris, G., Petrone, S., & Campagnoli, P. (2009). Dynamic linear models with R. New York: Springer. Qin, S. J. (2012). Survey on data-driven industrial process monitoring and diagnosis. Annual reviews in control, 36, 220-234. Rajaram, K., & Jaikumar, R. (2000). Incorporating operator\u2013process interactions in process control: A framework and an application to glucose refining. International Journal of Production Economics, 63, 19-31. S\u00e1ez-Atienzar, S., Mart\u00ednez-G\u00f3mez, J., Alonso-Barba, J. I., Puerta, J. M., Galindo, M. F., Jord\u00e1n, J., & de la Ossa, L. (2015). Automatic quantification of the subcellular localization of chimeric GFP protein supported by a two-level Naive Bayes classifier. Expert Systems with Applications, 42, 1531-1537. Serdio, F., Lughofer, E., Pichler, K., Buchegger, T., & Efendic, H. (2014). Residual-based fault detection using soft computing techniques for condition monitoring at rolling mills. Information Sciences, 259, 304-320. Serdio, F., Lughofer, E., Pichler, K., Buchegger, T., Pichler, M., & Efendic, H. (2014). Fault detection in multi-sensor networks based on multivariate time-series models and orthogonal transformations. Information Fusion, 20, 272-291. Sheilan, M. H., Spooner, B. H., Street, D. E., & van Hoorn, E. (2005). Amine treating and sour water stripping. Netherlands: Amine Experts. Sheridan, T. B., & Johannsen, G. (1976). Monitoring behavior and supervisory control: Perseus Publishing. Si, X. S., Hu, C. H., Yang, J. B., & Zhang, Q. (2011). On the dynamic evidential reasoning algorithm for fault prediction. Expert Systems with Applications, 38, 5061-5080. Swartz, T. B., Haitovsky, Y., Vexler, A., & Yang, T. Y. (2004). Bayesian identifiability and misclassification in multinomial data. Canadian Journal of Statistics, 32, 285-302. Teng, C. M. (2005). Dealing with data corruption in remote sensing. In A. F. Famili, J. N. Kok, J. M. Pena, A. Siebes & A. Feelders (Eds.), Advances in Intelligent Data Analysis VI (pp. 452-463). Berlin Heidelberg: Springer. Venkatasubramanian, V., Rengaswamy, R., Yin, K., & Kavuri, S. N. (2003). A review of process fault detection and diagnosis: Part I: Quantitative model-based methods. Computers & Chemical Engineering, 27, 293-311. Yu, J. (2013). A new fault diagnosis method of multimode processes using Bayesian inference based Gaussian mixture contribution decomposition. Engineering Applications of Artificial Intelligence, 26, 456\u2013466. Zhang, C., Li, D., Yang, J., & Yong, A. (2014). Human cognitive paradigm and its application in semi-supervised learning. Optik-International Journal for Light and Electron Optics, 125, 1178-1184.         28  APPENDIX A.1. Energy and mass balances equation of the CSTR ( ) ( ) ( )f A r Br t k C t k C t\uf03d \uf02d  (11) . ( )0.\uf02d\uf03dfER T tf fk k e  (12) . ( )0.\uf02d\uf03drER T tr rk k e  (13) ( ).( ( ) ( )) ( )A AF AdC t FC t C t r tdt V\uf03d \uf02d \uf02d  (14) ( ) ( ) ( )B Af AC t C t C t\uf03d \uf02d  (15) ( ) ..( ( ) ( )) . ( ) .( ( ) ( )). .F jp pdT t F H U AT t T t r t T t T tdt V C C\uf072 \uf072\uf03d \uf02d \uf02d \uf02d \uf02d  (16) Table 6: CSTR model parameters Volumetric flowrate (m3/s) F=1 Forward activation energy (J/mol) Ef=49614 Volume of CSTR (m3) V = 150 Reverse activation energy (J/mol) Er=50242 Density of A-B mixture (kg/m3) \u03c1 =833  Forward  pre-exponential factor (1/s) kf0= 3.4\u00b7107 Specific heat of A-B mixture (J/kg\u00b7K) Cp = 0.12 Reverse pre-exponential factor (1/s) kr0 =2\u00b7107  Heat of reaction (J/mol) H=-5960 Overall heat transfer coefficient (W/m2\u00b7K) U=7 Universal gas constant (J/mol\u00b7K) R=8.31451  Area (m2) A=100 A.2. Recursive Kalman filter of DLM Consider the DLM specified by: \uf03d \uf02bt t t tY F v\u03b8  ~ (0, )t m tv N V  (17) 1\uf02d\uf03d \uf02bt t t tG w\u03b8 \u03b8  ~ (0, )t n tw N W                     (18) 29  Let consider: 1 1: 1 1 1| ~ ( , )\uf02d \uf02d \uf02d \uf02dt t t tY N m C\u03b8   (19) Then the following statements hold. (i) The one-step-ahead predictive distribution of \u03b8t given Y1:t-1 is Gaussian, with parameters 1: 1 1( | )\uf02d \uf02d\uf03d \uf03dt t t t ta E Y G m\u03b8   (20) 1: 1 1( | )\uf02d \uf02d \uf0a2\uf03d \uf03d \uf02bt t t t t t tR Var Y G C G W\u03b8   (21) (ii) The one-step-ahead predictive distribution of Yt given Y1:t-1 is Gaussian, with parameters 1: 1( | )\uf02d\uf03d \uf03dt t t t tf E Y Y Fa   (22) 1: 1( | )\uf02d \uf0a2\uf03d \uf03d \uf02bt t t t t t tQ Var Y Y F R F V   (23) (iii) The filtering distribution of \u03b8t given Y1:t is Gaussian, with parameters 11: 1( | )\uf02d\uf02d\uf0a2\uf03d \uf03d \uf02bt t t t t t t tm E Y a R FQ e\u03b8  (24) 11:( | )\uf02d\uf0a2\uf03d \uf03d \uf02dt t t t t t t t tC Var Y R R FQ F R\u03b8  (25) where et=Yt-ft is the forecast error.  B. Supplementary data Datasets associated with this article including CSTR and gas-sweetening unit measurements can be found, in the online version.    30  LIST OF TABLES: Table 1: Validation confusion matrix Table 2: Interaction confusion matrix  Table 3: FD performance using iterative procedure Table 4: Diagnosis performance of flooding using iterative procedure Table 5: The initial learning phase of the foaming detection system Table 6: CSTR model parameters  LIST OF FIGURES: Figure 1: Protection layers in process industries (IEC61511, 2003). Figure 2: Scheme of the non-adiabatic CSTR.  Figure 3: Input and output variables of Scenario 1 (faulty) without the operator action (red lines) and with the operator action (blue lines). Figure 4: Input and output variables of Scenario 2 (pseudo-faulty) without the operator action (red lines) and with incorrect operator action (blue lines). Figure 5: Iterative procedure of developing an FD system for enhancing operator supervision. Figure 6: Dependence structure for a state space model (Petris, et al., 2009). Figure 7: Inputs, outputs and functional blocks of the proposed approach. Figure 8: Mahalanobis distance of state trajectories for 50 runs of Scenario 1 and 50 runs of Scenario 2. Figure 9: Process flowsheet of the de-Butanizer column.  Figure 10: Causes of flooding and corresponding controls.  Figure 11: Comparison of relabeling and filtering strategies dealing with uncertain labels.  Figure 12: Process flowsheet of the sweetening unit of the gas refinery.  ",
      "id": 40830425,
      "identifiers": [
        {
          "identifier": "10.1016/j.eswa.2016.06.040",
          "type": "DOI"
        },
        {
          "identifier": "187425481",
          "type": "CORE_ID"
        },
        {
          "identifier": "oai:upcommons.upc.edu:2117/97335",
          "type": "OAI_ID"
        },
        {
          "identifier": "644307504",
          "type": "CORE_ID"
        },
        {
          "identifier": "2464205837",
          "type": "MAG_ID"
        },
        {
          "identifier": "info:doi/10.1016%2fj.eswa.2016.06.040",
          "type": "OAI_ID"
        },
        {
          "identifier": "81571354",
          "type": "CORE_ID"
        }
      ],
      "title": "Data-based fault detection in chemical processes: Managing records with operator intervention and uncertain labels",
      "language": {
        "code": "en",
        "name": "English"
      },
      "magId": "2464205837",
      "oaiIds": [
        "info:doi/10.1016%2fj.eswa.2016.06.040",
        "oai:upcommons.upc.edu:2117/97335"
      ],
      "publishedDate": "2016-06-23T00:00:00",
      "publisher": "'Elsevier BV'",
      "pubmedId": null,
      "references": [],
      "sourceFulltextUrls": [
        "https://upcommons.upc.edu/bitstream/2117/97335/1/FD%20operator%20intervention%20rev18_v2.pdf"
      ],
      "updatedDate": "2025-02-28T17:54:10",
      "yearPublished": 2016,
      "journals": [
        {
          "title": "Expert Systems with Applications",
          "identifiers": [
            "0957-4174",
            "issn:0957-4174"
          ]
        }
      ],
      "links": [
        {
          "type": "download",
          "url": "https://core.ac.uk/download/81571354.pdf"
        },
        {
          "type": "reader",
          "url": "https://core.ac.uk/reader/81571354"
        },
        {
          "type": "thumbnail_m",
          "url": "https://core.ac.uk/image/81571354/large"
        },
        {
          "type": "thumbnail_l",
          "url": "https://core.ac.uk/image/81571354/large"
        },
        {
          "type": "display",
          "url": "https://core.ac.uk/works/40830425"
        }
      ]
    }
  ],
  "searchId": "14e5f2c84815c76eab9d55be93d28c1c"
}


---

Page 1

---

IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
1023
Fast Coordination of Distributed Energy
Resources Over Time-Varying
Communication Networks
Madi Zholbaryssov
, Christoforos N. Hadjicostis
, Fellow, IEEE,
and Alejandro D. Domínguez-García
, Senior Member, IEEE
Abstract—In this article, we consider the problem of op-
timally coordinating the response of a group of distributed
energy resources (DERs) controlled by distributed agents
so they collectively meet the electric power demanded by
a collection of loads while minimizing the total generation
cost and respecting the DER capacity limits. This problem
can be cast as a convex optimization problem, where the
global objective is to minimize a sum of convex functions
corresponding to individual DER generation cost while
satisfying 1) linear inequality constraints corresponding to
the DER capacity limits and 2) a linear equality constraint
corresponding to the total power generated by the DERs
being equal to the total power demand. We develop
distributed algorithms to solve the DER coordination
problem over time-varying communication networks with
either bidirectional or unidirectional communication links.
The proposed algorithms can be seen as distributed
versions of a centralized primal–dual algorithm. One of
the
algorithms
proposed
for
directed
communication
graphs has a geometric convergence rate even when
communication out-degrees are unknown to agents. We
showcase the proposed algorithms using the standard
IEEE 39-bus test system and compare their performance
against other ones proposed in the literature.
Index Terms—Consensus control, directed graphs, dis-
tributed algorithms, distributed power generation.
I. INTRODUCTION
I
T IS envisioned that present-day power grids, which are
dependent on centralized power generation stations, will
Manuscript received 28 January 2021; revised 25 May 2021, 26
November 2021, 16 April 2022, and 29 August 2022; accepted 2 Oc-
tober 2022. Date of publication 11 October 2022; date of current ver-
sion 30 January 2023. The work of A. D. Domínguez-García and M.
Zholbaryssov was supported in part by the U.S. Department of En-
ergy’s Ofﬁce of Energy Efﬁciency and Renewable Energy (EERE) under
Solar Energy Technologies Ofﬁce (SETO) under Agreement Number
EE0009025 and in part by the U.S. Department of Defense’s Envi-
ronmental Security Technology Certiﬁcation Program (ESTCP) under
Contract Number W912HQ-20-C-0039. Recommended by Associate
Editor S.-i. Azuma. (Corresponding author: Christoforos N. Hadjicostis.)
Madi Zholbaryssov and Alejandro D. Domínguez-García are with the
ECE Department, University of Illinois at Urbana-Champaign, Urbana,
IL 61801 USA (e-mail: madikaz@gmail.com; aledan@illinois.edu).
Christoforos N. Hadjicostis is with the ECE Department, University of
Illinois at Urbana-Champaign, Urbana, IL 61801 USA, and also with the
ECE Department, University of Cyprus, 1678 Nicosia, Cyprus (e-mail:
chadjic@ucy.ac.cy).
Color versions of one or more ﬁgures in this article are available at
https://doi.org/10.1109/TAC.2022.3213626.
Digital Object Identiﬁer 10.1109/TAC.2022.3213626
transition toward more decentralized power generation mostly
based on distributed energy resources (DERs). One of the ob-
stacles in making this shift happen is to ﬁnd effective control
strategies for coordinating DERs. In this regard, and partly due
to high variability introduced by renewable-based generation
resources, DERs will need to more frequently adjust their set-
points, which entails the development of fast control strategies.
Also, because of the communication overhead, it may not be
feasible to use a centralized approach to coordinate a large
number of DERs over a large geographic area. This necessitates
DER coordination using distributed control strategies that scale
well to power networks of large size.
Inthiswork,weconsideragroupofDERsandelectricalloads,
which are interconnected by an electric power network, and can
exchange information among themselves via some communica-
tion network. Each DER is endowed with a power generation
cost function, which is unknown to other DERs, and its power
output is upper- and lower-limited by some (possibly time-
varying) capacity constraints. A computing device, referred to
as an agent, attached to each DER is able to communicate with
the computing devices (agents) of other DERs located within
its communication range. Then, the objective is to determine,
in a distributed manner, DER optimal power outputs so as to
satisfy total electric power demand while minimizing the total
generation cost and respecting DER capacity limits. This DER
coordination problem can be cast as a convex optimization
problem (see, e.g., [1], [2], [3], [4], [5], [6], [7]), where the
global objective is to minimize a sum of convex functions corre-
sponding to the costs of generating power from the DERs while
satisfying linear inequality constraints on the power produced by
each DER, and a linear equality constraint corresponding to the
total generated power being equal to the total power consumed
by the electrical loads.
We consider two types of communication networks described
by either an undirected or directed graph based on various modes
of communication between communication devices: simplex
mode, half-duplex mode, and full-duplex mode (see, e.g., [8,
Ch. 11]). In simplex mode, transmission occurs only in one
direction. In half-duplex mode, transmission occurs in both
directions, but only in one direction at a time. In full-duplex
mode, the end communication devices transmit and receive
information simultaneously. In our work, undirected graphs are
used to represent networks where communication devices oper-
ate in full-duplex mode allowing us to use a signiﬁcantly simpler
distributed algorithm than the one proposed for directed graphs.
Directed graphs are used to represent a more general class of
networks where communication devices operate in any of the
This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see http://creativecommons.org/licenses/by/4.0/


---

Page 2

---

1024
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
three aforementioned modes but require a more complicated
algorithm to coordinate DERs.
As packets of data transmitted by communication devices
are not guaranteed to reach their destination, communication
links of the corresponding communication graph will only be
present with some probability making the communication graph
time-varying. Typical causes of packet losses are a link conges-
tion due to limited bandwidth, interference from other signals,
hardware faults, and, in the case of wireless communication
networks, weak wireless signal, and a receiver being able to
receive and process only one signal at a time [8]. Not handling
unreliable communication in a proper way will prevent us from
ﬁnding an optimal solution to the DER coordination problem.
This serves as a motivation for designing algorithms that solve
the DER coordination problem by properly handling unreliable
communication.
To this end, we focus on the challenges that arise due to the
time-varying nature of the underlying communication network
and address the DER coordination problem via distributed algo-
rithms that are capable of operating over time-varying commu-
nication graphs with either 1) bidirectional or 2) unidirectional
communication links. These algorithms also have a geometric
convergence rate, which is a desirable feature for ensuring
fast performance. We believe that the proposed algorithms can
be extended to solve more complex DER coordination prob-
lems with additional constraints, e.g., line ﬂow constraints,
voltage constraints, or reactive power balance constraints, as
long as these are linear or have a separable structure, i.e.,
each constraint is local or involves only a pair of neighboring
agents.
A vast body of work has focused on solving the DER coor-
dination problem in a distributed way (see, e.g., [1], [2], [3],
[4], [5], [6], [7], [9], [10], [11], [12]). Earlier works focused
on time-invariant communication networks (see, e.g., [1], [2],
[9], [10]). In one of the earliest works, Zhang and Chow [1]
proposed a distributed approach in which agents’ local estimates
aredriventotheoptimal incremental cost viatheleader–follower
consensus algorithm. Domínguez-García et al. [2] utilize the
so-called ratio-consensus algorithm (see, e.g., [13], [14]) to
distributively compute the solution to the dual formulation of
the DER coordination problem. Later works focused on time-
varyingcommunicationnetworks(see,e.g.,[3],[4],[5],[6],[7]).
For example, in [3], assuming that generation cost functions are
quadratic, Kar and Hug propose a distributed algorithm that uses
a consensus term to converge to a common incremental cost, and
a subgradient term to satisfy the total load demand. In [7], Wu
et al. propose a robustiﬁed version of the so-called subgradient-
push method (see, e.g., [15]) that utilizes the so-called push-sum
protocol (see, e.g., [16], [17], [18]) to converge to a consensual
solution over time-varying directed communication networks.
However, the convergence of the algorithms proposed in [3]
and [7] is not guaranteed to be geometrically fast and might be
slow due to the fact that the algorithms use a diminishing step-
size. In [11] and [12], the authors propose distributed algorithms
based on the dual-ascent method that have a geometric conver-
gence rate but require the agents to know their communication
out-degrees.
Our starting point in the design of our algorithms is a primal–
dual algorithm (ﬁrst-order Lagrangian method), where the dual
variable associated with the power balance constraint depends
on the total power imbalance (supply–demand mismatch). We
then develop distributed versions of this primal–dual algorithm
by having DER agents closely emulate the iterations of the
primal–dual algorithm. To this end, each agent maintains an
estimate of the dual variable and updates it using a local es-
timate of the total power imbalance and the neighbors’ esti-
mates of the total power imbalance. The update of the total
power imbalance estimate is based on the gradient tracking idea
that appeared in [19]. To enable agents to operate over time-
varying directed communication graphs when their communi-
cation out-degrees are unknown to them, we propose a robust
distributed primal–dual algorithm that converges geometrically
fast.
Each proposed algorithm is viewed as a feedback intercon-
nection of the (centralized) primal–dual algorithm representing
the nominal system and the error dynamics due to the nature
of the distributed implementation. The key ingredient for estab-
lishing the convergence results is to show that both systems are
ﬁnite-gain stable, which then allows us to use the small-gain
theorem (see, e.g., [20]) to establish the convergence of the
feedback interconnected system. The small-gain-theorem-based
analysis ﬁrst appeared in [19] in the context of distributed
algorithms for solving an unconstrained consensus optimization
problem.
Contributions: We note that the distributed algorithms in [19],
which were proposed to solve an unconstrained distributed
optimization problem, cannot be easily applied to solve the DER
coordination problem because of the additional inequality and
equality constraints that appear in our problem formulation. The
presence of these inequality and equality constraints poses major
challenges in establishing the convergence of the distributed
algorithms we propose and in quantifying an upper bound for
stepsizes where this convergence occurs. Showing the ﬁnite-gain
stability of the two systems, the nominal system and the error
dynamics, which comprise the distributed algorithm, requires a
nontrivial analysis. Although the distributed algorithms in [11]
and [12] can be used to solve the DER coordination problem over
directed graphs, they require each agent to know its communica-
tion out-degree, i.e., the number of neighbors who received its
information, at every iteration. Obtaining such information at
every iteration is a very challenging task when communication
links are directed and not reliable. To overcome these issues,
we propose a distributed algorithm, which attains a geometric
convergence rate and where each agent is only required to know
its nominal out-degree, i.e., the number of neighbors who can
receive its information, which can be learned or precomputed
before executing the proposed algorithm.
Additionally, we propose a different algorithm for undirected
graphs used to represent the communication networks where
communication devices operate in the so-called full-duplex
mode (see, e.g., [8, Ch. 11]) that allows communication de-
vices to transmit and receive information simultaneously. This
distributed algorithm is signiﬁcantly simpler than the one pro-
posed for directed graphs and does not require any additional
information about the nominal out-degrees. We also show that
other variants of the primal–dual algorithm (see, e.g., [21],
[22]) can be leveraged as a base for designing the distributed
counterparts as long as these variants under additive disturbance
are ﬁnite-gain stable maps from the disturbance to their out-
put, and the outputs of the individual systems in the feedback
system representation enter as additive disturbances to each
other.


---

Page 3

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1025
II. PRELIMINARIES
In this section, we formulate the DER coordination problem
and give an overview of the small-gain theorem for discrete-time
systems.
A. DER Coordination Problem
We consider a collection of DERs and electrical loads inter-
connected by a power network. Let pi denote the power output of
the DER at bus i, 1 ≤i ≤n. Let ℓi denote the amount of power
to be consumed by the load at bus i, 1 ≤i ≤n, which is locally
measured and known to the DER at the same bus, and assumed
to be ﬁxed while the DER coordination problem is solved. Let
pi and pi denote the lower and upper limits, respectively, on the
power that the DER at bus i can generate. Also, let fi(·) denote
the cost function associated with the electric power generated
by the DER at bus i. Then, our main objective is to determine
the power that needs to be generated by the DERs in order to
collectively satisfy the total electric power demand, n
i=1 ℓi,
while minimizing the total generation cost, n
i=1 fi(pi).
More formally, we consider the following DER coordination
problem that has been studied in [1], [2], [3], [4], [6], and [7]:
minimize
p∈Rn
n

i=1
fi(pi)
(1a)
subject to 1⊤p = 1⊤ℓ
(1b)
p ≤p ≤p
(1c)
where p = [p1, . . . , pn]⊤, ℓ= [ℓ1, . . . , ℓn]⊤, p = [p1, . . . , pn]⊤,
p = [p1, . . . , pn]⊤, and 1 is the all-ones vector (its size should
be clear from the context). We assume that 1⊤p ≤1⊤ℓ≤1⊤p,
which makes (1) feasible. A widely used function for represent-
ing the generation cost of electric power generator units is a
quadratic function (see, e.g., [23, Ch. 11], [24, Ch. 5]), which
belongs to the class of twice differentiable and strongly convex
functions as stated in the following assumption.
Assumption 1: Each cost function fi(·) is twice differentiable
and strongly convex with parameter m > 0, i.e., f ′′
i (x) ≥m,
∀x ∈[pi, pi], ∀i ∈V.
Let A(x) denote the set of active inequality constraints for a
feasible point x ∈Rn given by
A(x) := {j | xj = pj or xj = pj}.
Let ej denote an n-dimensional vector whose jth entry is equal
to 1 and all other entries are equal to zero. We make the
following standard regularity assumption on the solution of (1)
(see, e.g., [25, Ch. 3.3]).
Assumption 2: The optimal solution of (1), denoted by p⋆,
is regular, namely, the equality constraint gradient, given by
1, and the active inequality constraint gradients, given by ej,
j ∈A(p⋆), are linearly independent.
The main objective of our work in this article is to design
a distributed algorithm for solving (1) geometrically fast over
time-varying communication networks.
B. Small-Gain Theorem
In the following, we give a brief overview of the main analysis
tool used in later developments—the small-gain theorem (see,
e.g.,[20,Th.5.6])fordiscrete-timesystems.Fortheforthcoming
developments, we adopt the appropriate metric for measuring
the energy content of signals of interest. For a given sequence
of iterates, {x[k]}∞
k=0, where x[k] ∈Rn, consider the following
norm (previously used in [19]):
∥x∥a,K
2
:= max
0≤k≤K a−k∥x[k]∥2
for some a ∈(0, 1), where ∥· ∥2 is the Euclidean norm. If
∥x∥a,K
2
is bounded for all K ≥0, then, a−k∥x[k]∥2 is bounded
for all k ≥0, and, thus, it follows that x[k] converges to zero at
a geometric rate O(ak).
Now, consider a feedback connection of two discrete-time
systems, H1 and H2, such that
e2[k + 1] = H1(e1[k])
e1[k + 1] = H2(e2[k]).
We assume that H1 and H2 are ﬁnite-gain stable in the sense of
the norm ∥· ∥a,K
2
, namely, the following relations hold:
∥e2∥a,K
2
≤γ1∥e1∥a,K
2
+ β1
(2a)
∥e1∥a,K
2
≤γ2∥e2∥a,K
2
+ β2
(2b)
for some nonnegative constants β1, β2, γ1, and γ2. From (1), we
have that
∥e2∥a,K
2
≤γ1∥e1∥a,K
2
+ β1 ≤γ1γ2∥e2∥a,K
2
+ γ1β2 + β1
which by rearranging yields ∥e2∥a,K
2
≤γ1β2+β1
1−γ1γ2 . Similarly,
∥e1∥a,K
2
≤γ2β1+β2
1−γ1γ2 . Then, if γ1γ2 < 1, ∥e1∥a,K
2
and ∥e2∥a,K
2
are bounded, and e1[k] and e2[k] converge to zero at a geometric
rate O(ak).
III. DER COORDINATION OVER TIME-VARYING UNDIRECTED
GRAPHS
In this section, we present a distributed algorithm for solving
the DER coordination problem (1) over time-varying undirected
communication graphs.
A. Communication Network Model
Here, we introduce the model describing the communication
network that enables the bidirectional exchange of information
between DER agents. Let G(0) = (V, E(0)) denote an undirected
graph, where each agent in the vertex set V := {1, 2, . . . , n} cor-
responds to a DER, and {i, j} ∈E(0) if there is a communication
link between DER agents i and j that allows them to exchange
information. It is assumed that G(0) does not contain self-loops.
During any bounded time interval (tk, tk+1), successful data
transmissions among the DER agents can be captured by the
undirected graph G(c)[k] = (V, E(c)[k]), where E(c)[k] ⊆E(0)
is the set of active communication links, with {i, j} ∈E(c)[k]
if agents i and j simultaneously (and successfully) exchange
information with each other during time interval (tk, tk+1). Let
Ni := {j ∈V : {i, j} ∈E(0)} denote the set of nominal neigh-
bors of agent i, and deﬁne its nominal degree, which includes
itself, as d+
i := |N +
i | + 1. Let Ni[k] denote the set of neighbors
of agent i during time interval (tk, tk+1), i.e., Ni[k] := {j ∈V :
{i, j} ∈E(c)[k]}. We make the following standard assumption
regarding the connectivity of the network (see, e.g., [15], [19]).


---

Page 4

---

1026
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
Assumption 3: There exists some positive integer B such that
the graph with vertex set V and edge set (k+1)B−1
l=kB
E(c)[l] is
connected for k = 0, 1, . . . .
To satisfy Assumption 3, active communication links are not
required to form a connected graph during every time interval
(tk, tk+1), k = 1, 2, . . . , but only during some longer time in-
tervals of bounded length. Note that Assumption 3 necessarily
implies that the nominal graph G(0) is connected.
B. Distributed Primal–Dual Algorithm
Our starting point to solve (1) is the following primal–dual
algorithm [25, Ch. 4.4] with the additional projection:
pi[k + 1] =

pi[k] −sf ′
i(pi[k]) + sξλ[k]
pi
pi
(3a)
λ[k + 1] = λ[k] −s1⊤(p[k] −ℓ)
(3b)
where p[k] = [p1[k], . . . , pn[k]]⊤, [·]pi
pi denotes the projection
onto the interval [pi, pi], i.e.,
[x]pi
pi =
⎧
⎨
⎩
pi
if x < pi
x
if x ∈[pi, pi]
pi
if x > pi
s > 0 is a constant stepsize, ξ > 0 is a constant parameter,
and λ[k] is the estimate of the Lagrange multiplier at time
k associated with the power balance constraint, 1⊤p = 1⊤ℓ.
Algorithm (3) does not conform to the general communication
model described in Section III-A because in order to execute it,
the total power imbalance, 1⊤(p[k] −ℓ), at time k is needed to
update λ[k].
To design a distributed version of (3), each agent i needs
to have a local estimate of λ[k], denoted by λi[k]. To update
λi[k], it should also have an estimate of 1⊤(p[k] −ℓ). One such
estimate that can be constructed purely based on the local power
imbalance is ˆn(pi[k] −ℓi), where ˆn is some estimate of n that
every agent has,1 e.g., ˆn can be one, which leads us to the
following distributed algorithm:
pi[k + 1] = [pi[k] −sf ′
i(pi[k]) + sξλi[k]]pi
pi
(4a)
λi[k + 1] =
⎛
⎝1 −

j
wij[k]
⎞
⎠λi[k] +

j
wij[k]λj[k]
−sˆn(pi[k] −ℓi)
(4b)
where wij[k] = wji[k] ≥η if {i, j} ∈E(c)[k], wij[k] = 0 if
{i, j} /∈E(c)[k], and the constant η > 0 is chosen so that
1 −
j wij[k] ≥η. Even if ˆn is an accurate estimate of n,
ˆn(pi[k] −ℓi) is a very crude estimate of 1⊤(p[k] −ℓ), and
results in poor performance as will be demonstrated later via
numerical simulations.
A better approach is to let each agent estimate the total power
imbalance by using its local power imbalance and the estimates
of its neighbors. To elaborate on this further, we let yi denote
1We note that ˆn must be precomputed before running the distributed algo-
rithms we propose. The problem of estimating distributively the number of
nodes in various types of networks has been extensively discussed and tackled
in a number of works (see, e.g., [26], [27], [28] and references therein) under
various assumptions on the underlying communication graph.
agent i’s estimate of the total power imbalance. Then, one way
to update yi is as follows:
yi[k + 1] =
⎛
⎝1 −

j
wij[k]
⎞
⎠yi[k] +

j
wij[k]yj[k]
+ ˆn(pi[k + 1] −pi[k])
(5)
where yi[0] = ˆn(pi[0] −ℓi). In (5), agent i ﬁrst computes the
average of its estimate and the estimates of its neighbors,
and then adds ˆn(pi[k + 1] −pi[k]) to ensure that the aver-
age of all total power imbalance estimates is always equal to
(ˆn/n)1⊤(p[k] −ℓ), which is equal to the total power imbalance,
1⊤(p[k] −ℓ) if ˆn = n. This second step allows local estimates
to remain close to the total power imbalance. In the following,
we provide the complete update formulae for the primal and dual
variables:
pi[k + 1] = [pi[k] −sf ′
i(pi[k]) + sξλi[k]]pi
pi
(6a)
λi[k + 1] =
⎛
⎝1 −

j
wij[k]
⎞
⎠λi[k] +

j
wij[k]λj[k]
−syi[k]
(6b)
yi[k + 1] =
⎛
⎝1 −

j
wij[k]
⎞
⎠yi[k] +

j
wij[k]yj[k]
+ ˆn(pi[k + 1] −pi[k]).
(6c)
Note that in (6b), agent i computes the (weighted) average of its
estimate and the estimates of its neighbors, which yields a good
estimate of λ. The iterations in (6) are initialized with λi[0] = 0,
and yi[0] = ˆn(pi[0] −ℓi).
C. Feedback Interconnection Representation of the
Distributed Primal–Dual Algorithm
In the following, we represent (6) as a feedback interconnec-
tion of a nominal system, denoted by H1, and a disturbance
system, denoted by H2, which allows us to utilize the small-
gain theorem for convergence analysis purposes. To this end,
let e[k] := λ[k] −( 1
n1⊤λ[k])1, λ[k] = [λ1[k], . . . , λn[k]]⊤, and
ˆλ[k] := (1/ˆn)1⊤λ[k]; then, we deﬁne the nominal system, H1,
as follows:
H1 :
⎧
⎪
⎨
⎪
⎩
p[k + 1] =

p[k] −s∇f(p[k]) + sξ ˆn
n1ˆλ[k]
+sξe[k]
p
p
(7a)
ˆλ[k + 1] = ˆλ[k] −s1⊤(p[k] −ℓ)
(7b)
where ∇f(p[k]) = [f ′
1(p1[k]), f ′
2(p2[k]), . . . , f ′
n(pn[k])]⊤, and
[·]p
p denotes the componentwise projection onto the box [p, p],
i.e., [x]p
p = [[x1]p1
p1, [x2]p2
p2, . . . , [xn]pn
pn]⊤. Note that in order to
obtain (7a), we substituted e[k] + (ˆn/n)1ˆλ[k] for λ[k] in (6a),
and summed (6b) over all i and divided the result by ˆn to
obtain (7b). We note that e[k] is the vector of deviations of the
local estimates of the Lagrange multiplier from their average at
time instant k; without e[k], the nominal system H1 has almost
the same form as (3). Now, we deﬁne the disturbance system,


---

Page 5

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1027
Fig. 1.
Algorithm (2) as a feedback system.
H2, as follows:
H2 :
⎧
⎨
⎩
y[k + 1] = W[k]y[k] + ˆn(p[k + 1] −p[k])
(8a)
λ[k + 1] = W[k]λ[k] −sy[k]
(8b)
e[k] = λ[k] −(ˆn/n)1ˆλ[k]
(8c)
where W[k] = [wij[k]] ∈Rn×n is a weight matrix at time in-
stant k. Then, as illustrated in Fig. 1, algorithm (6) can be viewed
as a feedback interconnection of H1 and H2, where (p∗, λ∗) is
the equilibrium of (7) when e[k] ≡0, for all k ≥0. Finding the
relationship between the loop gain of the feedback system and
the stepsize s allows us to quantify the effect of the feedback
system on the convergence error in terms of the stepsize. We
later show that the loop gain can be decreased by decreasing s.
As a matter of fact, if the loop gain is sufﬁciently small, then, the
feedback loop does not amplify the energy of the convergence
error, and, on the contrary, the error eventually decays to zero,
which follows from the small-gain theorem.
Remark 1: We note that the feedback system representation
in Fig. 1 allows one to decouple the convergence analysis of the
distributed algorithm into two separate parts. In the ﬁrst part,
we analyze the convergence properties of the basic primal–dual
algorithm (1) under disturbance, whereas in the second part, we
analyze the convergence properties of the underlying consen-
sus algorithm under disturbance. Then, the small-gain theorem
merges these two parts to show the convergence properties of
the entire system.
D. Convergence Analysis
In order to invoke the small-gain theorem, we must ﬁrst
show that the following relations between the energy of the
convergence error and that of the disturbance hold:
R1. ∥z∥a,K
2
≤α1∥e∥a,K
2
+ β1 for some positive α1 and β1
R2. ∥e∥a,K
2
≤sα2∥z∥a,K
2
+ β2 for some positive α2 and
β2
for some a ∈(0, 1), small enough s > 0, and ∀ξ > 0, where
z[k] :=
p[k] −p∗
ˆλ[k] −λ∗

denotes the convergence error. The results R1 and R2 are equiv-
alent to ensuring that the systems H1 and H2 in Fig. 1 are
ﬁnite-gain stable. From R1 and R2, it can be determined that
the loop gain is sα1α2. Noticing that the gain sα1α2 becomes
strictly smaller than 1 for sufﬁciently small s, we later show that
∥z∥a,K
2
becomes bounded for all K > 0, and that z[k] converges
to zero at a geometric rate O(ak). In the following, we show that
the relations R1 and R2 hold and present the convergence results
for algorithm (6).
We ﬁrst establish that p∗= p⋆, namely, p∗is the solution of
(1); its proof can be found in the Appendix.
Lemma 1: Consider (p∗, λ∗), namely, the equilibrium of the
nominal system H1 with e[k] ≡0, ∀k. Then, p∗is the solution
of (1).
To provide an upper bound on the stepsize s, we introduce
some notation. It follows from the proof of [19, Lemma 3.10]
that ∥e[k]∥2 is always bounded, i.e., ∥e[k]∥2 ≤M, for some
M > 0. Deﬁne ψ := max(1⊤(ℓ−p), 1⊤(p −ℓ))/√ξˆn
Δϕmax
i
:= max

max
j∈V

pj −pj + f ′
j(pj)/

ξˆn

+ 2

ξˆn/nψ −f ′
i(pi)/

ξˆn + 2M

ξ/ˆn
f ′
i(pi)/

ξˆn + 2M

ξ/ˆn + 2

ξˆn/nψ
−min
j∈V

pj −pj + f ′
j(pj)/

ξˆn
 
(9)
ζi := min(pi −p∗
i, p∗
i −pi)/Δϕmax
i
(10)
and let constants a1, a2, and δ be such that a1 > 0, and
δ := (ξˆn/n)2
n

i=1
a1s2
1 + s2 + 2ζi
(11)
a2 := (ξˆn/n)a1 + (ξˆn/n)2s2a1n + (ξˆn/n)a1s2 −δ.
(12)
Note that since p∗is regular, there exists l such that pl < p∗
l <
pl, yielding ζl > 0. Let E := 11⊤, D ∈Rn×n and D ∈Rn×n
denote diagonal matrices with Dii = minpi≤pi≤pi f ′′
i (pi) and
Dii = maxpi≤pi≤pi f ′′
i (pi), respectively. Deﬁne
F(s) :=
F11(s)
F12(s)
F21(s)
F22(s)

(13)
where
F11(s) = 2sa1D −s2a1(I + (D)2 + 2ξˆn/nE)
−s2a2E + s3a1(−2ξˆnI + 2D −I)
−s2δI −s4a1(D)2
F12(s) = ξˆn/ns4a1(D1 + 1), F21(s) = F12(s)⊤
F22(s) = (ξˆn/n)2a1s2
 n

i=1
s2 + 2ζi
1 + s2 + 2ζi
−s2n

−a2s3.
Since
s2+2ζi
1+s2+2ζi ≥
2ζi
1+2ζi , we have that, for sufﬁciently small
s > 0
F22(s) > (ξˆn/n)2a1s2
 n

i=1
2ζi
1 + 2ζi
−s2n

−a2s3 > 0
where the last inequality follows since the quadratic term
dominates the higher-order terms for sufﬁciently small s > 0.
Let S(F )(s) denote the Schur complement of F22(s) in F(s),
namely, S(F )(s) := F11(s) −F12(s)F22(s)−1F21(s). It is easy
to see that, for sufﬁciently small s > 0, S(F )(s) is positive
deﬁnite, since the linear term dominates the higher-order terms.


---

Page 6

---

1028
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
Deﬁne
s := min{s > 0 : S(F )(s) is not positive deﬁnite or
F22(s) = 0}.
(14)
Then, by [29, Th. 7.7.6], since S(F )(s) is positive deﬁnite and
F22(s) > 0, ∀s ∈(0, s), F(s) is positive deﬁnite, ∀s ∈(0, s).
In the next result, we establish that H1 is ﬁnite-gain stable.
Proposition 1: Let Assumptions 1 and 2 hold. Then, un-
der (7), we have that
R1. ∥z∥a,K
2
≤α1∥e∥a,K
2
+ β1
(15)
for some positive α1 and β1, a ∈(0, 1), ∀s ∈(0, min(s, 1/
√ξˆn)), and ∀ξ > 0.
Proof: Deﬁne
P :=

a1I
−sa1ξ ˆn
n1
−sa1ξ ˆn
n1⊤
a2

.
Then, the Schur complement of a2 in P, denoted by S, is given
by
S := a1I −(1/a2)(sa1ξˆn/n)211⊤.
From (11), we have that δ < (ξˆn/n)2 s2a1n; then, it follows
from (12) that
a2 > (ξˆn/n)a1.
(16)
By using (16), we have that2
S/a1 > I −s2ξˆn/n11⊤.
Since s < 1/√ξˆn, it follows that S is positive deﬁnite. Then,
by [29, Th. 7.7.6], since S is positive deﬁnite and a2 > 0, P is
positive deﬁnite. Deﬁne a vector norm ∥x∥P :=
√
x⊤Px, and
ϕ[k] := p[k] −s∇f(p[k]) + sξ ˆn
n1ˆλ[k]
(17a)
ϕ∗:= p∗−s∇f(p∗) + sξ ˆn
n1λ∗
(17b)
ϵ[k] := sξe[k]
(17c)
Δϕ[k] := ϕ[k] + ϵ[k] −[ϕ[k] + ϵ[k]]p
p
(17d)
Δϕ∗:= ϕ∗−[ϕ∗]p
p.
(17e)
The result of the following lemma is needed for the subsequent
development; its proof can be found in the Appendix.
Lemma 2:


[ϕ[k] + ϵ[k]]p
p −[ϕ∗]p
p
ˆλ[k + 1] −λ∗

P
≤

ϕ[k] + ϵ[k] −ϕ∗
ˆλ[k + 1] −λ∗

P +T
where
T :=
a1 s2I
0n
0⊤
n
δ

.
■
2We write A > B (A ≥B) to denote that a matrix A −B is positive deﬁnite
(positive semideﬁnite).
Next, it follows from the mean value theorem [30, Th. 5.1]
applied to each component in ∇f(p[k]) −∇f(p∗) that
∇f(p[k]) −∇f(p∗) = ∇2f(υ[k])(p[k] −p∗)
(18)
where υ[k] := [υ1[k], υ2[k], . . . , υn[k]]⊤, with υi[k] lying on the
line segment connecting pi[k] and p∗
i, and ∇2f(υ[k]) is the
Hessian of f(x) at x = υ[k]. Deﬁne
A[k] :=
I −s∇2f(υ[k])
sξ ˆn
n1
−s1⊤
1

then, note that
 ϕ[k] −ϕ∗
ˆλ[k + 1] −λ∗

= A[k]z[k].
(19)
It follows from the triangle inequality that

ϕ[k] + ϵ[k] −ϕ∗
ˆλ[k + 1] −λ∗

P +T
≤

 ϕ[k] −ϕ∗
ˆλ[k + 1] −λ∗

P +T
+

a1(1 + s2)∥ϵ[k]∥2.
(20)
By noting that
z[k + 1] =

[ϕ[k] + ϵ[k]]p
p −[ϕ∗]p
p
ˆλ[k + 1] −λ∗

and putting together the results in Lemma 2, (19), and (20), we
obtain that
∥z[k + 1]∥P ≤

z[k]⊤A[k]⊤(P + T)A[k]z[k]
+

a1(1 + s2)∥ϵ[k]∥2.
(21)
Deﬁne Dk := ∇2f(υ[k]), Q[k] := P −A[k]⊤(P + T)A[k];
then, we show that Q[k] ≥s3P. Deﬁne R[k] := Q[k] −s3P
given by
R[k] =
R11[k]
R12[k]
R21[k]
R22[k]

where
R11[k] = 2sa1Dk −s2a1(I + D2
k + 2ξˆn/nE) −s2a2E
+ s3a1(ξˆn/nEDk + ξˆn/nDkE + 2Dk −I)
−s2δI −s4a1D2
k
R12[k] = ξˆn/ns4a1(Dk1 + 1), R21[k] = R12[k]⊤
R22[k] = (ξˆn/n)2a1 s2
 n

i=1
s2 + 2ζi
1 + s2 + 2ζi
−s2n

−a2 s3.
Let S(R)[k] denote the Schur complement of R22[k] in R[k],
namely, S(R)[k] := R11[k] −R12[k]R22[k]−1R21[k]. We recall
that S(F )(s) > 0 and F22(s) > 0, ∀s ∈(0, s). Since S(R)[k] ≥
S(F )(s) and R22[k] = F22(s), for all k, it follows that S(R)[k] >
0 and R22[k] > 0. Then, by [29, Th. 7.7.6], R[k] is positive
deﬁnite for all k. Hence, Q[k] ≥s3P, yielding the following


---

Page 7

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1029
relation from (21):
∥z[k + 1]∥P ≤

1 −s3∥z[k]∥P +

a1(1 + s2)∥ϵ[k]∥2.
(22)
Recalling that ϵ[k] = sξe[k], and letting γ :=
√
1 −s3, and
b1 :=

a1(1 + s2)sξ, we rewrite (22) as follows:
∥z[k + 1]∥P ≤γ∥z[k]∥P + b1∥e[k]∥2.
(23)
Now, by choosing a > γ, and multiplying both sides of (6)
by a−(k+1), we obtain
a−(k+1)∥z[k + 1]∥P ≤γ
aa−k∥z[k]∥P + b1
a a−k∥e[k]∥2. (24)
Then, by taking max0≤k≤K(·) on both sides of (24), we obtain
max
0≤k≤K a−(k+1)∥z[k + 1]∥P ≤γ
a max
0≤k≤K a−k∥z[k]∥P
+ b1
a
max
0≤k≤K a−k∥e[k]∥2. (25)
Since
max
0≤k≤K a−(k+1)∥z[k + 1]∥P =
max
0≤k≤K+1 a−k∥z[k]∥P −∥z[0]∥P
the relation (25) can be written as
∥z∥a,K+1
P
≤γ
a∥z∥a,K
P
+ b1
a ∥e∥a,K
2
+ ∥z[0]∥P
(26)
where
∥x∥a,K
P
:= max0≤k≤K a−k∥x[k]∥P
for
a
sequence
{x[k]}∞
k=0. Since ∥z∥a,K+1
P
≥∥z∥a,K
P
, it follows from (26) that
∥z∥a,K
P
≤γ
a∥z∥a,K
P
+ b1
a ∥e∥a,K
2
+ ∥z[0]∥P .
(27)
Then, after rearranging (27), we obtain
∥z∥a,K
P
≤
b1
a −γ ∥e∥a,K
2
+
a
a −γ ∥z[0]∥P .
Because ∥· ∥2 ≤α∥· ∥P
for some α > 0, we have that
∥z∥a,K
P
≥∥z∥a,K
2
/α. Hence
∥z∥a,K
2
α
≤
b1
a −γ ∥e∥a,K
2
+
a
a −γ ∥z[0]∥P
which can be rewritten as
∥z∥a,K
2
≤α1∥e∥a,K
2
+ β1
where α1 = b1α
a−γ , β1 =
aα
a−γ ∥z[0]∥P , yielding (15).
□
We omit the proof of the next result, where we show that
system H2 is ﬁnite-gain stable, since it is analogous to that of
a similar result proposed for directed communication graphs in
Section IV.
Proposition 2: Let Assumption 3 hold. Then, under (8), we
have that
R2. ∥e∥a,K
2
≤sα2∥z∥a,K
2
+ β2
for some positive α2 and β2, a ∈(0, 1).
Now, we show the convergence of algorithm (6) by applying
the small-gain theorem to the results in Propositions 1–2.
Proposition 3: Let Assumptions 1, 2, and 3 hold. Then, under
algorithm (6)
∥z∥a,K
2
≤β
(28)
for some a ∈(0, 1), β > 0, ∀s ∈(0, min(s, 1/√ξˆn, 1/(α1
α2))), and ∀ξ > 0. In particular, (pi[k], λi[k]) converges to
(p∗
i, λ∗), ∀i, at a geometric rate O(ak).
Proof: By using Propositions 1 and 2, it follows that
∥z∥a,K
2
≤α1∥e∥a,K
2
+ β1 ≤α1(sα2∥z∥a,K
2
+ β2) + β1
which, after rearranging, results in
∥z∥a,K
2
≤α1β2 + β1
1 −sα1α2
=: β
yielding (28). Hence, for s < 1/(α1α2), we have that sα1α2 <
1, which ensures that β is ﬁnite.
■
Remark 2: Propositions 1–3 imply that instead of (3), other
variants of the primal–dual algorithm (see, e.g., [21], [22]) can
be used as a base for designing the distributed counterparts as
long as these variants satisfy the relation R1, and the outputs of
H1 and H2 enter as additive disturbances to each other.
IV. DER COORDINATION OVER TIME-VARYING
DIRECTED GRAPHS
In this section, we present a distributed algorithm for solving
the DER coordination problem (1) over time-varying directed
communication graphs.
A. Communication Network Model
Here, we introduce the model describing the communication
network that enables the unidirectional exchange of information
between DER agents. Let G(0) = (V, E(0)) denote a directed
graph, where each agent in the vertex set V := {1, 2, . . . , n}
corresponds to a DER, and (i, j) ∈E(0) if there is a com-
munication link that allows agent i to send information to
agent j (but not vice versa). We assume that G(0) does not
have self-loops. During any time interval (tk, tk+1), successful
data transmissions among the DER agents can be captured by
the directed graph G(c)[k] = (V, E(c)[k]), where E(c)[k] ⊆E(0)
is the set of active communication links, with (i, j) ∈E(c)[k]
if agent j receives information from agent i during time in-
terval (tk, tk+1), but not necessarily vice versa. Let N +
i
:=
{j ∈V : (i, j) ∈E(0)} denote the set of nominal out-neighbors
of agent i, and deﬁne its nominal out-degree, which includes
itself, as di := |N +
i | + 1. Let N +
i [k] and N −
i [k] denote the
sets of out-neighbors and in-neighbors of agent i, respectively,
during time interval (tk, tk+1), i.e., N +
i [k] := {j ∈V : (i, j) ∈
E(c)[k]} and N −
i [k] := {ℓ∈V : (ℓ, i) ∈E(c)[k]}. We deﬁne
agent i’s instantaneous (communication) out-degree (including
itself) to be D+
i [k] := |N +
i [k]| + 1. We make the following
standard and reasonable assumptions (see, e.g., [31], [32]).
Assumption 4: The nominal communication graph G(0) =
(V, E(0)) is strongly connected.
Assumption 5: There exists some positive integer B such that
(i, j) ∈k+B−1
l=k
E(c)[l] for every (i, j) ∈E(0), k = 0, 1, . . . .
Assumption 5 is satisﬁed if a communication link in the
nominal communication graph becomes active at least once over
every time interval of some bounded length. We also assume that
each agent knows its nominal out-degree, as stated next.
Assumption 6: The value of d+
i is known to agent i, i = 1,
2, . . . , n.
Notice that Assumption 6 is weaker than the standard assump-
tion (see, e.g., [12], [15], [19]) that the instantaneous out-degree


---

Page 8

---

1030
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
D+
i [k] is known to agent i at every time instant k, which is hard
to obtain in practice due to unreliable communication.
B. Ratio Consensus Algorithm
We provide a brief overview of the ratio consensus algorithm
(see, e.g., [13], [33]) utilized to estimate the average power
imbalance (or total power imbalance if n is known) and to update
the Lagrange multipliers, λi[k], in the distributed algorithms
proposed later.
Consider a group of agents indexed by the set V, each with
some real initial value, i.e., vi at agent i. Each agent aims to ob-
tain the average of the initial values via exchange of information
over the graph G(c)[k]. To this end, we let agent i maintain two
variables, μi[k] and νi[k] such that μi[0] = vi and νi[0] = 1. We
ﬁrst consider the following updates performed by agent i:
μi[k + 1] =

j∈N −
i [k]∪{i}
μj[k]
D+
j [k]
(29a)
νi[k + 1] =

j∈N −
i [k]∪{i}
νj[k]
D+
j [k]
(29b)
ri[k + 1] = μi[k + 1]
νi[k + 1] .
(29c)
We write (29a)–(29b) in a matrix-vector form as follows:
μ[k + 1] = P[k]μ[k]
(30a)
ν[k + 1] = P[k]ν[k]
(30b)
where P[k] is an n × n matrix with Pij[k] = 1/D+
j [k], j ∈
N −
i [k] ∪{i}, and Pij[k] = 0, otherwise. We note that P[k] is
column stochastic, and it can be shown that ri[k] converges to
the average of the initial values, namely, limk→∞ri[k] =

i vi
n
[13], as long as Assumptions 4 and 5 hold.
C. Preliminary Distributed Primal–Dual Algorithm
We begin with the following preliminary distributed primal–
dual algorithm, where the averaging step is based on the ratio
consensus algorithm (29), executed by each agent i as follows:
pi[k + 1] = [pi[k] −sf ′
i(pi[k]) + sξxi[k]]pi
pi
(31a)
λi[k + 1] =

j∈N −
i [k]∪{i}
λj[k] −syj[k]
D+
j [k]
(31b)
vi[k + 1] =

j∈N −
i [k]∪{i}
vj[k]
D+
j [k]
(31c)
xi[k + 1] = λi[k + 1]
vi[k + 1]
(31d)
yi[k + 1] =

j∈N −
i [k]∪{i}
yj[k]
D+
j [k] + ˆn(pi[k + 1] −pi[k]) (31e)
where yi[k] is the estimate at instant k of the total power
imbalance, 1⊤(p[k] −ℓ), at agent i. The iterations in (31) are
initialized with xi[0] = 0, λi[0] = 0, vi[0] = 1, and yi[0] =
ˆn(pi[0] −ℓi). We note that the iterations used to update λi[k],
vi[k], and yi[k] are similar to the so-called Push-DIGing algo-
rithm proposed in [19] for solving an unconstrained consensus
optimization problem.
As in the case of undirected graphs, algorithm (31) can be
represented as a feedback interconnection of a nominal system,
denoted by ⃗H1, and a disturbance system, denoted by ⃗H2. To
this end, let e[k] := x[k] −( 1
n1⊤λ[k])1, and ˆλ[k] := 1
ˆn1⊤λ[k];
then, we deﬁne the nominal system, ⃗H1, as follows:
⃗H1 :
⎧
⎪
⎨
⎪
⎩
p[k + 1] =

p[k] −s∇f(p[k]) + sξ ˆn
n1ˆλ[k]
+sξe[k]
p
p
(32a)
ˆλ[k + 1] = ˆλ[k] −s1⊤(p[k] −ℓ)
(32b)
where we substituted e[k] + ˆn
n1ˆλ[k] for x[k] in (31a) to ob-
tain (32a), and we summed (31b) over all i and divided the result
by ˆn to obtain (32b). We note that e[k] is the vector of deviations
from their average at instant k of the local estimates of the
Lagrange multiplier; without e[k], the nominal system ⃗H1 has
almost the same form as (3). In fact, the nominal systems for the
undirected and directed cases are the same, namely, ⃗H1 = H1.
Now, we deﬁne the disturbance system, ⃗H2, as follows:
⃗H2 :
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
y[k] = P[k −1]y[k −1]
+ˆn(p[k] −p[k −1])
(33a)
λ[k + 1] = P[k](λ[k] −sy[k])
(33b)
v[k + 1] = P[k]v[k],
(33c)
x[k + 1] = (V [k + 1])−1λ[k + 1]
(33d)
e[k] = x[k] −

ˆn
nˆλ[k]

1
(33e)
where V [k] := diag(v[k]), P[k] ∈Rn×n with
Pij[k] :=

1
D+
j [k],
if i = j or (j, i) ∈E(c)[k]
0,
else.
Then, algorithm (31) can be viewed as a feedback interconnec-
tion of ⃗H1 and ⃗H2, where (p∗, λ∗) is the equilibrium of (32)
when e[k] ≡0, ∀k.
Since it is not assumed that each agent i knows its communi-
cation out-degree, D+
i [k], at every time instant k, the averaging
step in Algorithm (31) cannot be executed. However, Algo-
rithm (31) provides some basic ideas behind the main algorithm
presented next.
D. Running-Sum Ratio Consensus Algorithms
Without knowledge of the instantaneous out-degrees, the
averaging step in Algorithm (31) based on the ratio consensus
algorithm(29)cannotbeexecuted.Infact,ifd+
i isusedin(29)in-
stead of D+
i [k], then, P[k] is not necessarily column stochastic,
precluding the DER agents from achieving consensus. However,
the loss of column-stochasticity can be ﬁxed by augmenting
the original network of agents with additional virtual agents
and links such that if agent i does not receive a packet from
agent j, we let a virtual agent receive the packet via a virtual
link [14]. This allows us to augment (30) with additional states
corresponding to the virtual agents so that the augmented system
becomes
μ′[k + 1] = ˜P[k]μ′[k]
(34a)
ν′[k + 1] = ˜P[k]ν′[k]
(34b)


---

Page 9

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1031
where μ′[k] and ν′[k] are the augmented state vectors that, in
addition to the states of the real agents, also contain the states
of the virtual agents. The matrix ˜P[k] can be made column
stochastic by carefully updating the states of the virtual agents.
To explain this, we consider agents i and j connected via a
communication link (j, i) ∈E(0), and let μ′
ji denote the state
of the corresponding virtual agent. If (j, i) /∈E(c)[k], then,
μ′
ji[k + 1] = μ′
ji[k] + μj[k]
d+
j , namely, the virtual agent receives
the packet from agent j. If (j, i) ∈E(c)[k], then, we consider the
following two options for updating the state of the virtual agent.
1) The virtual agent sends the value of its current state,
μ′
ji[k], to agent i, and sets the value of the next state to
zero, i.e., μ′
ji[k + 1] = 0. In the meantime, agent j sends
μj[k]/d+
j to agent i.
2) The virtual agent sends a portion of its current state,
γμ′
ji[k], to agent i, where γ is strictly positive and less
than 1, and retains the other portion by performing the
following update:
μ′
ji[k + 1] = (1 −γ)μ′
ji[k] + (1 −γ)μj[k]/d+
j
where we notice that agent j sends (1 −γ)μj[k]/d+
j to
the virtual agent and the remaining portion, γμj[k]/d+
j ,
to agent i.
The ﬁrst option was chosen in the original running-sum ratio
consensus algorithm (see, e.g., [14]). In this work, we select the
second option, since it allows us to considerably simplify the
convergence analysis. To account for the absence of the virtual
agentsandlinksintheactualcommunicationnetwork,additional
computations must be performed by each transmitting/receiving
agent to effectively capture the effect of the updates by the virtual
agentsonthestatesoftheactualagents.Tothisend,weletagentj
broadcast the running sums k
t=0 μj[t]/d+
j and k
t=0 νj[t]/d+
j .
Then, μi[k] and νi[k] are updated by agent i as follows:
μi[k + 1] =

j∈N −
i [k]∪{i}
(μij[k + 1] −μij[k])
(35a)
νi[k + 1] =

j∈N −
i [k]∪{i}
(νij[k + 1] −νij[k])
(35b)
ri[k + 1] = μi[k + 1]
νi[k + 1]
(35c)
where μij[k] and νij[k] are additional variables maintained by
agentiandupdatedusingtherunningsumsreceivedfromagentj
as follows:
μij[k + 1] =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
(1 −γ)μij[k] + γ k
t=0
μj[t]
d+
j ,
if j ∈N −
i [k]
μij[k] + μj[k]
d+
j ,
if j = i
μij[k],
otherwise
(36a)
νij[k + 1] =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
(1 −γ)νij[k] + γ k
t=0
νj[t]
d+
j ,
if j ∈N −
i [k]
νij[k] + νj[k]
d+
j ,
if j = i
νij[k],
otherwise.
(36b)
It is straightforward to see that the use of the running sums in
the updates has the same effect on the states of the actual agents
as the updates by the virtual agents have. Furthermore, by using
the results in [14], it can be shown that ri[k] asymptotically
converges with probability one to the average of the initial
values, namely
lim
k→∞ri[k] =

i vi
n
.
E. Robust Distributed Primal–Dual Algorithm
By utilizing the running-sum ratio-consensus algorithm (35)–
(36) in the averaging step, we develop a robust extension of
algorithm (31). We show that this robust extension is able to
solve the DER coordination problem (1) even when every agent i
only knows its nominal out-degree, d+
i , but not its instantaneous
out-degree, D+
i [k].
We let agent j broadcast the running sums k
t=0
λj[t]
d+
j ,
k
t=0
vj[t]
d+
j , and k
t=0
yj[t]
d+
j
to its neighbors at each k ≥0.
Agent i performs the following updates:
pi[k + 1] = [pi[k] −sf ′
i(pi[k]) + sξxi[k]]pi
pi
(37a)
λi[k + 1] =

j∈N −
i [k]∪{i}
(λij[k + 1] −λij[k] −syij[k + 1]
+syij[k])
(37b)
vi[k + 1] =

j∈N −
i [k]∪{i}
(vij[k + 1] −vij[k])
(37c)
xi[k + 1] = λi[k + 1]
vi[k + 1]
(37d)
yi[k + 1] =

j∈N −
i [k]∪{i}
(yij[k + 1] −yij[k])
+ ˆn(pi[k + 1] −pi[k])
(37e)
where λij[k], vij[k], and yij[k] are updated using the running
sums received by agent i from agent j, and given by
λij[k + 1] =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
(1 −γ)λij[k] + γ k
t=0
λj[t]
d+
j ,
if j ∈N −
i [k]
λij[k] + λj[k]
d+
j ,
if j = i
λij[k],
otherwise
(38a)
vij[k + 1] =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
(1 −γ)vij[k] + γ k
t=0
vj[t]
d+
j ,
if j ∈N −
i [k]
vij[k] + vj[k]
d+
j ,
if j = i
vij[k],
otherwise
(38b)
yij[k + 1] =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
(1 −γ)yij[k] + γ k
t=0
yj[t]
d+
j ,
if j ∈N −
i [k]
yij[k] + yj[k]
d+
j ,
if j = i
yij[k],
otherwise
(38c)
where 0 < γ < 1.


---

Page 10

---

1032
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
Remark 3: Algorithm (37)–(38) relies on Assumption 6,
which can be further relaxed by replacing the running-sum ratio
consensus algorithm with its modiﬁcation in [14, Algorithm 2]
for handling imprecise knowledge of the nominal out-degrees.
However, the convergence analysis of the resulting distributed
approach is nontrivial and left for future work.
F. Feedback Representation of the Robust Distributed
Primal–Dual Algorithm in Virtual Domain
To facilitate the understanding of algorithm (37)–(38), we
represent it as a feedback interconnection of a nominal system,
denoted by ⃗Hr
1, and a disturbance system, denoted by ⃗Hr
2. How-
ever, unlike the previously described feedback representations,
this representation will be given in the virtual domain using the
virtual agents and links. Moreover, we show that while executing
algorithm (37)–(38), the actual agents, essentially, execute (31)
over a virtual network augmented with the virtual agents and
links.
Consider a set of virtual agents denoted by S = {n +
1, . . . , n + |E(0)|}, where the virtual agents correspond to the
edges in E(0) through a one-to-one map I such that I(j, i) ∈S
for (j, i) ∈E(0). Consider neighboring agents i and j, i.e.,
(j, i) ∈E(0), and a virtual agent l ∈S corresponding to the
link from j to i, i.e., I(j, i) = l. Let 
N −
l [k] denote the set of
in-neighbors of agent l at instant k given by 
N −
l [k] = {j}, ∀k,
implying that agent l always receives a packet from agent j. Let

N −
i [k] denote the augmented set of in-neighbors of agent i ∈V
at instant k given by

N −
i [k] = N −
i [k] ∪{a ∈S : a = I(j, i), j ∈N −
i [k]}
(39)
which contains the set of in-neighbors N −
i [k] and the set of
virtual agents, from which agent i receives a packet at instant k.
Note that the deﬁnition of 
N −
i [k] in (39) implies that agent i
receives a packet from agent l at instant k if agent i receives a
packet from agent j at instant k.
If we let agent l ∈S execute the following iterations:
λl[k + 1] =
⎧
⎨
⎩
λl[k] + λj[k]
d+
j ,
j /∈
N −
i [k]
(1 −γ)λl[k] + (1 −γ) λj[k]
d+
j ,
otherwise
(40a)
vl[k + 1] =
⎧
⎨
⎩
vl[k] + vj[k]
d+
j ,
j /∈
N −
i [k]
(1 −γ)vl[k] + (1 −γ) vj[k]
d+
j ,
otherwise
(40b)
yl[k + 1] =
⎧
⎨
⎩
yl[k] + yj[k]
d+
j ,
j /∈
N −
i [k]
(1 −γ)yl[k] + (1 −γ) yj[k]
d+
j ,
otherwise
(40c)
where λl[0] = 0, vl[0] = 0, and yl[0] = 0, then, it is not difﬁcult
to see that the agent i’s updates in (37) are equivalent to the
following iterations in the virtual domain:
pi[k + 1] = [pi[k] −sf ′
i(pi[k]) + sξxi[k]]pi
pi
(41a)
λi[k + 1] = λi[k] −syi[k]
d+
i
+

a∈
N −
i [k]
γ λa[k] −sya[k]
d+
a
(41b)
vi[k + 1] = vi[k]
d+
i
+

a∈
N −
i [k]
γ va[k]
d+
a
(41c)
xi[k + 1] = λi[k + 1]
vi[k + 1]
(41d)
yi[k + 1] = yi[k]
d+
i
+

a∈
N −
i [k]
γ ya[k]
d+
a
+ ˆn(pi[k + 1] −pi[k])
(41e)
where d+
a := 1, a ∈S. Note that the information sent by the
virtual agents is treated by agent i the same way as the infor-
mation sent by the real agents, and that the iterations in (41)
are, in essence, similar to those in (31); i.e., while executing
algorithm (37)–(38), the actual agents execute (31) over a virtual
network augmented with the virtual agents and links. Now, we
deﬁne N := n + |E(0)|, and ˜P[k] ∈RN×N such that
˜Pij[k] :=
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
γ
d+
j ,
if i ∈V, j ∈
N −
i [k]
1−γ
d+
j ,
if i ∈S, I(j, l) = i, j ∈
N −
l [k]
1
d+
j ,
if i ∈S, I(j, l) = i, j /∈
N −
l [k]
0,
else
˜Pii[k] :=
⎧
⎪
⎪
⎨
⎪
⎪
⎩
1
d+
i ,
if i ∈V
1−γ
d+
i ,
if i ∈S, I(j, l) = i, j ∈
N −
l [k]
1
d+
i ,
if i ∈S, I(j, l) = i, j /∈
N −
l [k].
Here, ˜P[k] denotes the one-step state transition matrix at time
k, and determines the values of λ[k], v[k], and y[k] at the next
iteration, e.g., v[k + 1] = ˜P[k]v[k]. Note that ˜P[k] is column
stochastic. Furthermore, for i = 1, . . . , N, we have that
˜Pij[k] ≥min(γ, 1 −γ) min
j∈V∪S
1
d+
j
≥min(γ, 1 −γ)/n := τ, j ∈
N −
i [k] ∪{i} ∀k (42)
where we used the fact that d+
j ≤n, ∀j. This, in particular,
implies that all diagonal entries in ˜P[k] are always strictly
positive. For further development, we establish the following
result using the analysis from the proof of [15, Lemma 4].
However, there are some subtle differences due to the fact that
vi[0] = 0, for i ∈S. We recall that vi[0] = 1, for i ∈V.
Lemma 3: For i = 1, 2, . . . , N, we have that
vi[k] ≥1 −γ
n
τ N(2B−1)
∀k ≥1.
(43)
Proof: Since ˜Pii[k] = 1/d+
i , ∀i ∈V, and d+
i ≤n, we have
that ˜Pii[k] ≥1/n, ∀i ∈V and k ≥0. Hence
( ˜P[k + 1] . . . ˜P[0])ii ≥1
n( ˜P[k] . . . ˜P[0])ii


---

Page 11

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1033
for i = 1, . . . , n. Because τ < 1/n, it becomes clear that when
1 ≤k ≤N(2B −1)
( ˜P[k −1] . . . ˜P[0]v[0])i ≥˜Pii[k −1] . . . ˜Pii[0]
≥1/nN(2B−1) > τ N(2B−1)
(44)
for all i ∈V, where v[t] := [v1[t], v2[t], . . . , vN[t]]⊤. We recall
that, by (42), we have that ˜Pij[k] ≥τ, i = 1, . . . , N, ∀j ∈

N −
i [k] ∪{i}, ∀k. Then, as shown in [32, Lemma 2], for t ≥
(N −1)(2B −1), we have that
( ˜P[t −1] . . . ˜P[0])ij ≥τ (N−1)(2B−1)
∀i, j.
(45)
By combining (44) and (45) and using the fact that vi[0] = 1,
for i = 1, . . . , n, we ﬁnd that
vi[k + 1] = ( ˜P[k] . . . ˜P[0]v[0])i ≥τ N(2B−1)
∀k ≥0. (46)
Now, consider a virtual agent l ∈S such that I(i, j) = l for
some i, j ∈V. Noticing that i ∈
N −
l [k], ∀k ≥0, and d+
i ≤n,
for l = n + 1, . . . , N, we have from (40b) that
vl[k + 1] ≥1 −γ
d+
i
vi[k] ≥1 −γ
n
τ N(2B−1)
∀k ≥0.
(47)
Combining (46) and (47) yields (43).
■
Next, we deﬁne additional virtual variables maintained by the
virtual agents. For i ∈S, we deﬁne
xi[k] :=
 λi[k]
vi[k],
if k > 0
0,
if k = 0.
We let pi[k] denote the iterate for the produced power at
the virtual agent i ∈S at instant k, fi(pi) := mp2
i denote the
cost function, pi = pi = 0 denote the capacity constraints, and
ℓi = 0 denote the consumed power. Since pi = pi = 0, we have
that pi[k] = 0, for all k ≥0. Since pi[k] = 0, ∀k, and ℓi = 0,
these virtual variables do not have any effect on the solution of
the considered problem, and are only needed for describing the
feedback system.
Next, we let
x[k] = [x1[k], x2[k], . . . , xN[k]]⊤
λ[k] = [λ1[k], λ2[k], . . . , λN[k]]⊤
y[k] = [y1[k], y2[k], . . . , yN[k]]⊤
p[k] = [p1[k], p2[k], . . . , pN[k]]⊤
ℓ= [ℓ1, ℓ2, . . . , ℓN]⊤
f(p[k]) = [f1(p1[k]), f2(p2[k]), . . . , fN(pN[k])]⊤
p = [p1, . . . , pN]⊤, p = [p1, . . . , pN]⊤
v[k] = [v1[k], v2[k], . . . , vn[k]]⊤
V [k] := diag(v[k]), ˜V [k] := diag(v[k]).
Noticing that, by Lemma 3, ˜V [k] is invertible for all k ≥1, we
deﬁne
h[k] :=
⎧
⎪
⎨
⎪
⎩
( ˜V [k])−1y[k]
if k > 0

(V [k])−1y[k]
0N−n

if k = 0
(48)
where y[k] = [y1[k], y2[k], . . . , yn[k]]⊤. [Instead of deﬁning
h[k] as ( ˜V [k])−1y[k], we adopt the deﬁnition in (48), be-
cause ˜V [k] is not invertible at k = 0.] Let ˜R[k] := ( ˜V [k +
1])−1 ˜P[k] ˜V [k],In denotethen × nidentitymatrix,0a×b denote
the a × b all-zeros matrix, and
˜I =

In
0n×(N−n)
0(N−n)×n
0(N−n)×(N−n)

.
Let x[k] := 1⊤x[k]/N, ˜x[k] = x[k] −1x[k], and ˆx[k] :=
1⊤x[k]/ˆn. Then, by substituting (ˆn/N)ˆx[k] + ˜x[k] for x[k],
˜V [k]x[k] for λ[k] and ( ˜V [k + 1])−1 ˜P[k] ˜V [k] for ˜R[k], and by
using (40)–(41) and (48), we obtain that
p[k + 1] =

p[k] −s∇f(p[k]) + sξ ˆn
N ˆx[k]1 + sξ˜x[k]
p
p
(49a)
x[k + 1] = ( ˜V [k + 1])−1 
˜P[k] ˜V [k]x[k] −s˜I ˜P[k]y[k]

= ( ˜V [k + 1])−1 ˜P[k] ˜V [k]x[k]
−s˜I( ˜V [k + 1])−1 ˜P[k]y[k]
= ( ˜V [k + 1])−1 ˜P[k] ˜V [k]x[k]
−s˜I( ˜V [k + 1])−1 ˜P[k] ˜V [k]h[k]
= ˜R[k]x[k] −s˜I ˜R[k]h[k]
(49b)
h[k + 1] = ( ˜V [k + 1])−1y[k + 1]
= ( ˜V [k + 1])−1 
˜P[k]y[k] + ˆn(p[k + 1] −p[k])

= ( ˜V [k+1])−1 
˜P[k] ˜V [k]h[k]+ˆn(p[k + 1]−p[k])

= ˜R[k]h[k] + ˆn( ˜V [k + 1])−1(p[k + 1] −p[k]).
(49c)
Let
h[k] := 1⊤y[k]
1⊤v[k] = ˆn
n1⊤(p[k] −ℓ).
(50)
Since ˜R[k] is row-stochastic [19], the following relations hold:
ˆx[k] = 1
ˆn1⊤x[k] = 1
ˆn1⊤˜R[k]1x[k]
(51)
h[k] = 1
n1⊤˜I ˜R[k]1h[k].
(52)
By using (50), (51), and (52), we ﬁnd from (49b) that
ˆx[k + 1] = 1
ˆn1⊤x[k + 1] = 1
ˆn1⊤˜R[k]x[k] −s 1
ˆn1⊤˜I ˜R[k]h[k]
= ˆx[k] −s1⊤(p[k] −ℓ) +
 1
ˆn1⊤˜R[k]x[k] −ˆx[k]

−s
 1
ˆn1⊤˜I ˜R[k]h[k] −n
ˆnh[k]

= ˆx[k] −s1⊤(p[k] −ℓ) + 1
ˆn1⊤˜R[k] (x[k] −1x[k])


---

Page 12

---

1034
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
−s 1
ˆn1⊤˜I ˜R[k]

h[k] −1h[k]
 
= ˆx[k] −s1⊤(p[k] −ℓ) + 1
ˆn1⊤˜R[k]˜x[k]
−s 1
ˆn1⊤˜I ˜R[k]˜h[k],
(53)
where ˜h[k] := h[k] −1h[k]. Then, we use (49a) and (53) to
determine the nominal system, ⃗Hr
1, as follows:
⃗Hr
1 :
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
p[k + 1] =
!
p[k] −s∇f(p[k])
+sξ ˆn
N ˆx[k]1 + sξ˜x[k]
"p
p
(54a)
ˆx[k + 1] = ˆx[k] −s1⊤(p[k] −ℓ)
+ 1
ˆn1⊤˜R[k]˜x[k]
−s 1
ˆn1⊤˜I ˜R[k]˜h[k].
(54b)
Now, we use (49b) and (49c) to determine the disturbance
system, ⃗H2, as follows:
⃗Hr
2 :
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
h[k] = ˜R[k −1]h[k −1]
+ˆn( ˜V [k])−1(p[k] −p[k −1])
(55a)
x[k + 1] = ˜R[k]x[k] −s˜I ˜R[k]h[k]
(55b)
e[k] = [˜x[k]⊤, s˜h[k]⊤]⊤.
(55c)
Then, algorithm (37)–(38) can be viewed as a feedback intercon-
nection of ⃗Hr
1 and ⃗Hr
2, where (p∗, x∗) is the equilibrium of (5)
when e[k] ≡0, ∀k.
G. Convergence Analysis
To establish the convergence results for algorithm (37)–(38),
we show that ⃗Hr
1 and ⃗Hr
2 are ﬁnite-gain stable. This allows us to
apply the small-gain theorem to prove that algorithm (37)–(38)
converges to an optimal solution geometrically fast.
For our analysis, we need the following result, where we recall
that ˜R[k] = ( ˜V [k + 1])−1 ˜P[k] ˜V [k]; its proof can be found in the
Appendix.
Lemma 4: For i = 1, . . . , N, we have that
˜Rij[k] ≥1 −γ
n2 τ N(2B−1)+1
∀j ∈
N −
i [k] ∪{i}, k ≥1.
(56)
The proof of the next result, where we show that ⃗Hr
1 is
ﬁnite-gain stable, is omitted because it is identical to that of
Proposition 1. The value of the parameter s is found using the
same expressions in (9)–(14) by substituting N for n, and using
a different value for ψ given by
ψ := max

1⊤(ℓ−p), 1⊤(p −ℓ)
 
/

ξˆn + MN/ˆn.
(57)
Proposition 4: Let Assumptions 1 and 2 hold. Then, un-
der (5), we have that
R1. ∥z∥a,K
2
≤α1∥e∥a,K
2
+ β1
for
some
positive
α1
and
β1,
a ∈(0, 1),
∀s ∈
(0, min(s, 1/√ξˆn)), and ∀ξ > 0, where
z[k] :=
p[k] −p∗
ˆx[k] −x∗

.
In the next result, we show that ⃗Hr
2 is ﬁnite-gain stable.
Proposition 5: Let Assumptions 4, 5, and 6 hold. Then,
under (55), we have that
R2. ∥e∥a,K
2
≤sα2∥z∥a,K
2
+ β2
(58)
for some positive α2 and β2, a ∈(0, 1).
Proof: Letting δ[k + 1] := ˆn(p[k + 1] −p[k]), and using
the triangle inequality, we obtain that
∥δ[k + 1]∥2 = ˆn∥p[k + 1] −p∗−p[k] + p∗∥2
≤ˆn(∥p[k + 1] −p∗∥2 + ∥p[k] −p∗∥2)
≤ˆn(∥z[k + 1]∥2 + ∥z[k]∥2).
(59)
Then, by taking max0≤k≤K(·) on both sides of (59), we obtain
max
0≤k≤K ∥δ[k + 1]∥2 ≤ˆn

max
0≤k≤K ∥z[k + 1]∥2
+ max
0≤k≤K ∥z[k]∥2

≤2ˆn
max
0≤k≤K+1 ∥z[k]∥2.
(60)
Since
max0≤k≤K ∥δ[k + 1]∥2 ≥max0≤k≤K+1 ∥δ[k]∥2 −
∥δ[0]∥2, it follows from (60) that
∥δ∥a,K
2
≤2ˆn∥z∥a,K
2
+ ∥δ[0]∥2.
(61)
Recall that e[k] = [˜x[k]⊤, s˜h[k]⊤]⊤; then, by using the fact that
√
a2 + b2 ≤a + b, ∀a, b ∈R+, we have that
∥e[k]∥2 ≤∥˜x[k]∥2 + s∥˜h[k]∥2.
(62)
By using (42) and the result in Lemma 4, the following lemmata
can be established by borrowing much of the analysis from the
proofs of [19, Lemmas 15–16].
Lemma 5:
∥˜h∥a,K
2
≤γ1∥δ∥a,K
2
+ γ2
(63)
for some positive constants γ1 and γ2.
Lemma 6:
∥˜x∥a,K
2
≤sγ3∥˜h∥a,K
2
+ γ4
(64)
for some positive constants γ3 and γ4.
By using (64), (63), and (61) in (62), we obtain
∥e∥a,K
2
≤∥˜x∥a,K
2
+ s∥˜h∥a,K
2
≤s(1 + γ3)∥˜h∥a,K
2
+ γ4
≤sγ1(1 + γ3)∥δ∥a,K
2
+ sγ2(1 + γ3) + γ4
≤2sγ1(1 + γ3)ˆn∥z∥a,K
2
+ sγ2(1 + γ3) + γ4
+ sγ1(1 + γ3)∥δ[0]∥2,
which can be rewritten as
∥e∥a,K
2
≤sα2∥z∥a,K
2
+ β2
where
α2 = 2γ1(1 + γ3)ˆn,
and
β2 = sγ2(1 + γ3) + γ4 +
sγ1(1 + γ3)∥δ[0]∥2, yielding (58).
■
In the following, we state the convergence results for algo-
rithm (37)–(38), which can be shown by applying the small-gain
theorem to the results in Propositions 4–5, similar to the analysis
in the proof of Proposition 3.


---

Page 13

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1035
Proposition 6: Let Assumptions 1, 2, 4, 5, and 6 hold. Then,
under algorithm (37)–(38)
∥z∥a,K
2
≤β
for some β > 0, a ∈(0, 1), ∀s ∈(0, min(s, 1/√ξˆn, 1/(α1
α2))), and ∀ξ > 0. In particular, (pi[k], xi[k]) converges to
(p∗
i, x∗), i = 1, . . . , n, at a geometric rate O(ak).
Finally, in the following, we establish that p∗:= [p∗
1, . . . , p∗
n]
is the solution of (1). [The proof is similar to the proof of
Lemma 1.]
Lemma 7: Consider (p∗, x∗), namely, the equilibrium of the
nominal system ⃗Hr
1 with e[k] ≡0, ∀k. Then, p∗is the solution
of (1).
V. NUMERICAL SIMULATIONS
In this section, we present numerical results that illustrate the
performance of the proposed algorithms using the IEEE 39-bus
test system [34].
We randomly pick the load demands and generation capacity
constraints of the DERs. For each i, we choose fi(pi) = aip2
i ,
where ai > 0 is randomly selected.
A. Time-Varying Undirected Communication Graphs
First, we illustrate the performance of the proposed algo-
rithm (6) over time-varying undirected communication graphs.
In the communication model, every pair of agents is connected
by a bidirectional communication link if there is an electrical
line between their respective DERs. Communication links are
assumed to fail with probability 0.2 independently (and inde-
pendently between different time steps). The weights aij[k],
{i, j} ∈E(0), are picked using the Metropolis rule [35], namely
aij[k] =

1
max(di,dj),
{i, j} ∈E(c)[k]
0,
otherwise.
For convenience, algorithm (6) is referred to as PD1. We
compare its performance with that of algorithm (1), referred
to as PD2. We run PD1 using a constant stepsize s = 0.01,
ξ = 0.06, and different values for ˆn, namely, ˆn = 10 and ˆn =
30. We execute PD2 using a constant stepsize s = 0.01, and,
also, using a diminishing stepsize of the form s[k] = a/(k + b),
where a > 0 and b > 0, with ξ = 0.06 and ˆn = 30. Both al-
gorithms are initialized with p[0] = 0. In Fig. 2, we provide
the convergence error, namely, the Euclidean distance between
the exact and iterative solutions, ∥p[k] −p∗∥2, for both algo-
rithms. It can be seen that PD1 signiﬁcantly outperforms PD2
when ˆn = 30 is used and has geometric convergence speed.
We also note that using ˆn = 10 yields signiﬁcantly slower
performance than when ˆn = 30 is used. This further implies
that if the power network size tends to vary substantially over
time, e.g., due to the connection of new DERs, it needs to be
estimated on a regular basis to maintain fast performance of
PD1.
B. Time-Varying Directed Communication Graphs
Next, we illustrate the performance of the proposed al-
gorithm (37)–(38) over time-varying directed communication
graphs. In the communication model, every pair of agents are
connected by a single or two opposite unidirectional communi-
cation links if there is an electrical line between their respective
Fig. 2.
Trajectories of ∥p[k] −p∗∥2 for algorithms PD1, PD2.
Fig. 3.
Trajectories of ∥p[k] −p∗∥2 for algorithms A1–A4.
DERs. We assign the orientations of the communication links
such that the nominal communication graph G(0) is strongly
connected. Communication links fail with probability 0.2 in-
dependently (and independently between different time steps).
We also assume that out-degrees, D+
i [k], are unknown to DER
agents.
We compare the performance of algorithm (37)–(38), for
convenience referred to as A1, against that of the distributed
algorithms proposed in [3], [7], and [11], referred to as A2, A3,
and A4, respectively. Algorithms A1 and A2 use a constant
stepsize s. In contrast, A3 and A4 need to use a diminishing
stepsize in order to guarantee convergence. However, if the
stepsize is constant and sufﬁciently small, A3 and A4 can still
achieve convergence within a small error. We run A1 using
γ = 0.9, s = 0.02, ξ = 0.2, and different values for ˆn, namely,
ˆn = 5 and ˆn = 30. We executed A3 using different diminishing
stepsizes of the form s[k] = a/(k + b), where a > 0 and b > 0.
We run A4 using the following parameter values: (αk, βk) =
(0.003, 0.3) and (αk, βk) = ( 0.08
k0.85 ,
0.2
k0.001 ), which are also used
in the numerical simulations in [3].
In Fig. 3, we provide the convergence error, namely, the
Euclidean distance between the exact and iterative solutions,


---

Page 14

---

1036
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
∥p[k] −p∗∥2, for all algorithms. Effects of unreliable com-
munication can be observed in Fig. 3; in particular, A2 fails
to converge because time-varying out-degrees, D+
i [k], are un-
known to DER agents, whereas A3 and A4 exhibit very slow
performance. By contrast, A1 manages to ﬁnd an optimal
solution with high accuracy, when ˆn = 30 is used, and has
geometric convergence speed despite the effects of unreliable
communication. We note that using ˆn = 5 results in noticeably
slower performance. Similar to the undirected case, it can then
be inferred that the power network size must be regularly es-
timated if it can vary substantially over time in order to main-
tain fast performance of A1. Through numerical simulations,
we also observed that it is in general difﬁcult to choose the
right values for a and b in order for A3 to operate well. In
fact, if the ratio a/b is large, A3 might exhibit oscillatory
behavior. But setting a/b to a small value results in a slow
convergence.
Numerical results shown in Figs. 2 and 3 demonstrate that the
error between exact and computed solutions becomes negligibly
small after 2000 iterations. Therefore, when we dispatch com-
puted DER setpoints, namely, the amount of power each DER
needs to produce, the error will have a negligible impact on the
operation of the considered power system.
VI. CONCLUSION
We presented distributed algorithms for solving the DER
coordination problem over time-varying communication graphs.
The algorithms have a geometric convergence rate. One im-
portant future direction is to extend the proposed algorithms to
solve more complex DER coordination problems with additional
constraints, e.g., line ﬂow constraints, voltage constraints, or re-
active power balance constraints. Another interesting endeavor
for future work is to leverage the methods based on the notion
of Integral Quadratic Constraints (see, e.g., [36]) for reﬁning the
convergence results or even redesigning some of the proposed
algorithms.
APPENDIX
A. Proof of Lemma 1
Proof: At the equilibrium, we have that
p∗= [p∗−s∇f(p∗) + sξ(ˆn/n)1λ∗]p
p
λ∗= λ∗−s1⊤(p∗−ℓ).
Then, the following relations hold:
0 = ∇f(p∗) −ξ(ˆn/n)1λ∗+ μ∗−ν∗
(65a)
0 = 1⊤(p∗−ℓ)
(65b)
0 = μ∗
i(p∗
i −pi)
(65c)
0 = ν∗
i (pi −p∗
i), i = 1, . . . , n
(65d)
where μ∗= [μ∗
1, . . . , μ∗
n]⊤, with μ∗
i ≥0, i = 1, . . . , n, and ν∗=
[ν∗
1, . . . , ν∗
n]⊤, with ν∗
i ≥0, i = 1, . . . , n. Noticing that (65)
represents the Karush–Kuhn–Tucker (KKT) conditions for (1),
it follows from [25, Prop. 3.3.1] that p∗is the solution of (1).■
B. Proof of Lemma 2
Proof: For our analysis, we need the results in the following
lemmas.
Lemma 8: Let v, w, v, v ∈R, where v ≤v, and deﬁne Δv :=
v −[v]v
v and Δw := w −[w]v
v. Then, we have that
(Δv −Δw)([v]v
v −[w]v
v) ≥0.
(66)
Proof: Suppose[v]v
v > [w]v
v,then,itfollowsthatΔv ≥0,and
Δw ≤0. Hence, Δv −Δw ≥0, and the result (66) holds.
■
Lemma 9: The following relation holds:
min(pi −p∗
i, p∗
i −pi) ≥ζi|Δϕi[k] −Δϕ∗
i|, i = 1, 2, . . . , n
(67)
for any s such that 0 < s ≤1/√ξˆn, and all k ≥0.
Proof: Note that if p∗
i = pi or p∗
i = pi, then, ζi = 0, and the
result (67) holds trivially. Suppose pi < p∗
i < pi. We ﬁrst show
that ˆλ[k] is always bounded. We recall that ψ := max(1⊤(ℓ−
p), 1⊤(p −ℓ))/√ξˆn and deﬁne
λmin :=
n
sξˆn

min
i∈V

pi −pi + sf ′
i(pi)

−sξM

λmax :=
n
sξˆn

max
i∈V

pi −pi + sf ′
i(pi)

+ sξM

.
We show by contradiction that
λmin −2ψ ≤ˆλ[k] ≤λmax + 2ψ
∀k.
(68)
Suppose ˆλ[k0] > λmax + 2ψ for some k0 > 0. Since
|ˆλ[k + 1] −ˆλ[k]| ≤ψ
∀k
there exists t ≥0 such that
ˆλ[t] ∈[λmax, λmax + ψ] .
Then, by using (7a) and the fact that ∥e[k]∥2 ≤M, we have that
pj[t + 1] = pj, j = 1, 2, . . . , n, and
ˆλ[t + 1] ≤ˆλ[t] + ψ ≤λmax + 2ψ.
In the next iterations, for τ ≥t + 1, we have that pj[τ] = pj,
j = 1, 2, . . . , n, as long as ˆλ[τ] ≥λmax, and that
ˆλ[τ + 1] = ˆλ[τ] −s1⊤(p −ℓ) < ˆλ[τ].
Hence,
ˆλ[k] ≤λmax + 2ψ
∀k.
Similarly, it can be shown that
ˆλ[k] ≥λmin −2ψ
∀k.
Therefore, the result (68) holds. Next, we show that |Δϕi[k] −
Δϕ∗
i| ≤Δϕmax
i
. Since pi < p∗
i < pi, and (p∗, λ∗) is the equilib-
rium of (7) when e[k] ≡0, for all k ≥0, it follows that Δϕ∗
i = 0.
By using (17), and the facts that pi[k], ˆλ[k], and ei[k] are always
bounded and s ≤1/√ξˆn, it is straightforward to derive the
upper bound Δϕmax
i
, which is given by
Δϕmax
i
:= max

max
j∈V

pj −pj + f ′
j(pj)/

ξˆn



---

Page 15

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1037
+ 2

ξˆn/nψ −f ′
i(pi)/

ξˆn + 2M

ξ/ˆn,
f ′
i(pi)/

ξˆn + 2M

ξ/ˆn + 2

ξˆn/nψ
−min
j∈V

pj −pj + f ′
j(pj)/

ξˆn
 
.
Then, by using the deﬁnition of ζi in (10), we obtain (67).
■
It follows from Lemma 8 that, for i = 1, 2, . . . , n
(Δϕi[k] −Δϕ∗
i)([ϕi[k] + ϵi[k]]pi
pi −[ϕ∗
i]pi
pi) ≥0.
(69)
Moreover, by Lemma 9, we have that
(Δϕi[k] −Δϕ∗
i)([ϕi[k] + ϵi[k]]pi
pi −[ϕ∗
i]pi
pi)
≥ζi(Δϕi[k] −Δϕ∗
i)2, i = 1, 2, . . . , n.
(70)
Then, we obtain that


ϕ[k] + ϵ[k] −ϕ∗
ˆλ[k + 1] −λ∗

2
P +T
=


[ϕ[k] + ϵ[k]]p
p −[ϕ∗]p
p
ˆλ[k + 1] −λ∗

2
P
−2sa1ξ ˆn
n(Δϕ[k] −Δϕ∗)⊤1(ˆλ[k + 1] −λ∗)
+ 2a1(1 + s2)(Δϕ[k] −Δϕ∗)⊤([ϕ[k] + ϵ[k]]p
p −[ϕ∗]p
p)
+ a1(1 + s2) ∥Δϕ[k] −Δϕ∗∥2
2 + δ(ˆλ[k + 1] −λ∗)2
+ a1 s2[ϕ[k] + ϵ[k]]p
p −[ϕ∗]p
p
2
2
≥


[ϕ[k] + ϵ[k]]p
p −[ϕ∗]p
p
ˆλ[k + 1] −λ∗

2
P
−2sa1ξ ˆn
n(Δϕ[k] −Δϕ∗)⊤1(ˆλ[k + 1] −λ∗)
+ 2a1
n

i=1
ζi(Δϕi[k] −Δϕ∗
i)2
+ a1(1 + s2) ∥Δϕ[k] −Δϕ∗∥2
2 + δ(ˆλ[k + 1] −λ∗)2 (71)
=


[ϕ[k] + ϵ[k]]p
p −[ϕ∗]p
p
ˆλ[k + 1] −λ∗

2
P
+
n

i=1


a1(1 + s2 + 2ζi)(Δϕi[k] −Δϕ∗
i)
−
#
a1 s2
1 + s2 + 2ζi
ξ ˆn
n(ˆλi[k + 1] −λ∗
i)
2
(72)
≥


[ϕ[k] + ϵ[k]]p
p −[ϕ∗]p
p
ˆλ[k + 1] −λ∗

2
P
(73)
where in (71) we used (69) and (70), and in (72), we used the
deﬁnition of δ in (11).
■
C. Proof of Lemma 4
Proof: From the deﬁnition of ˜R[k], we have that ˜Rij[k] =
˜Pij[k]vj[k]/vi[k + 1]. From Lemma 3, we have that
vj[k] ≥1 −γ
n
τ N(2B−1), k ≥1.
Since 1⊤v[t] = n, ∀t ≥0, it follows that vi[k + 1] ≤n. We re-
call that, by (42), ˜Pij[k] ≥τ, i = 1, . . . , N, ∀j ∈
N −
i [k] ∪{i},
∀k. Hence
˜Rij[k] ≥1 −γ
n2 τ N(2B−1)+1
i = 1, . . . , N, ∀j ∈
N −
i [k] ∪{i}, ∀k, yielding (56).
■
REFERENCES
[1] Z. Zhang and M. Y. Chow, “Convergence analysis of the incremental cost
consensus algorithm under different communication network topologies
in a smart grid,” IEEE Trans. Power Syst., vol. 27, no. 4, pp. 1761–1768,
Nov. 2012.
[2] A. D. Domínguez-García, S. T. Cady, and C. N. Hadjicostis, “Decentral-
ized optimal dispatch of distributed energy resources,” in Proc. IEEE Conf.
Decis. Control, Dec. 2012, pp. 3688–3693.
[3] S. Kar and G. Hug, “Distributed robust economic dispatch in power
systems: A consensus innovations approach,” in Proc. IEEE Power Energy
Soc. Gen. Meeting, Jul. 2012, pp. 1–8.
[4] X. Zhang and A. Papachristodoulou, “Redesigning generation control in
power systems: Methodology, stability and delay robustness,” in Proc.
IEEE Conf. Decis. Control, Dec. 2014, pp. 953–958.
[5] S. T. Cady, A. D. Domínguez-García, and C. N. Hadjicostis, “A distributed
generation control architecture for islanded AC microgrids,” IEEE Trans.
Control Syst. Technol., vol. 23, no. 5, pp. 1717–1735, Sep. 2015.
[6] G. Chen and Z. Zhao, “Distributed optimal active power control in micro-
grid with communication delays,” in Proc. Chin. Control Conf., Jul. 2016,
pp. 7515–7520.
[7] J. Wu, T. Yang, D. Wu, K. Kalsi, and K. H. Johansson, “Distributed optimal
dispatch of distributed energy resources over lossy communication net-
works,” IEEE Trans. Smart Grid, vol. 8, no. 6, pp. 3125–3137, Nov. 2017.
[8] A. Grami, Introduction to Digital Communications. Amsterdam, The
Netherlands: Elsevier., 2016.
[9] S. Yang, S. Tan, and J. Xu, “Consensus based approach for economic
dispatch problem in a smart grid,” IEEE Trans. Power Syst., vol. 28, no. 4,
pp. 4416–4426, Nov. 2013.
[10] A. Cherukuri and J. Cortés, “Distributed generator coordination for ini-
tialization and anytime optimization in economic dispatch,” IEEE Trans.
Control Netw. Syst., vol. 2, no. 3, pp. 226–237, Sep. 2015.
[11] W. Du, L. Yao, D. Wu, X. Li, G. Liu, and T. Yang, “Accelerated distributed
energy management for microgrids,” in Proc. IEEE Power Energy Soc.
Gen. Meeting, Aug. 2018, pp. 1–5.
[12] T. Yang et al., “Distributed energy resource coordination over time-varying
directed communication networks,” IEEE Trans. Control Netw. Syst.,
vol. 6, no. 3, pp. 1124–1134, Sep. 2019.
[13] A. D. Domínguez-García, C. N. Hadjicostis, and N. H. Vaidya, “Resilient
networked control of distributed energy resources,” IEEE J. Sel. Areas
Commun., vol. 30, no. 6, pp. 1137–1148, Jul. 2012.
[14] C. N. Hadjicostis, N. H. Vaidya, and A. D. Domínguez-García, “Robust
distributed average consensus via exchange of running sums,” IEEE Trans.
Autom. Control, vol. 61, no. 6, pp. 1492–1507, Jun. 2016.
[15] A. Nedi´c and A. Olshevsky, “Distributed optimization over time-varying
directed graphs,” IEEE Trans. Autom. Control, vol. 60, no. 3, pp. 601–615,
Mar. 2015.
[16] D. Kempe, A. Dobra, and J. Gehrke, “Gossip-based computation of aggre-
gate information,” in Proc. IEEE Symp. Found. Comput. Sci., Oct. 2003,
pp. 482–491.
[17] F. Bénézit, V. Blondel, P. Thiran, J. Tsitsiklis, and M. Vetterli, “Weighted
gossip: Distributed averaging using non-doubly stochastic matrices,” in
Proc. IEEE Int. Symp. Inf. Theory, Jun. 2010, pp. 1753–1757.
[18] A. D. Domínguez-García and C. N. Hadjicostis, “Distributed algorithms
for control of demand response and distributed energy resources,” in Proc.
IEEE Conf. Decis. Control Eur. Control Conf., Dec. 2011, pp. 27–32.


---

Page 16

---

1038
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
[19] A. Nedi´c, A. Olshevsky, and W. Shi, “Achieving geometric convergence
for distributed optimization over time-varying graphs,” SIAM J. Optim.,
vol. 27, no. 4, pp. 2597–2633, 2017.
[20] H. Khalil, Nonlinear Systems, 3rd ed. Upper Saddle River, NJ, USA:
Prentice-Hall, 2002.
[21] G. Qu and N. Li, “On the exponential stability of primal-dual gradient
dynamics,” IEEE Control Syst. Lett., vol. 3, no. 1, pp. 43–48, Jan. 2019.
[22] S. S. Du and W. Hu, “Linear convergence of the primal-dual gradient
method for convex-concave saddle point problems without strong convex-
ity,” in Proc. Mach. Learn. Res., vol. 89, Apr. 2019, pp. 196–205.
[23] R. B. Arthur and V. Vijay, Power Systems Analysis. Upper Saddle River,
NJ, USA: Prentice-Hall, 2000.
[24] A. Gomez-Exposito, A. J. Conejo, and C. Canizares, Electric Energy
Systems: Analysis and Operation, 2nd ed. Boca Raton, FL, USA: CRC
Press, 2018.
[25] D. P. Bertsekas, Nonlinear Program., 2nd ed. Nashua, NH, USA: Athena
Scientiﬁc, 1999.
[26] D. Varagnolo, G. Pillonetto, and L. Schenato, “Distributed statistical
estimation of the number of nodes in sensor networks,” in Proc. IEEE
Conf. Decis. Control, 2010, pp. 1498–1503.
[27] I. Shames, T. Charalambous, C. N. Hadjicostis, and M. Johansson, “Dis-
tributed network size estimation and average degree estimation and control
in networks isomorphic to directed graphs,” in Proc. Annu. Allerton Conf.
Commun., Control, Comput., 2012, pp. 1885–1892.
[28] S. Zhang, C. Tepedelenlio˘glu, M. K. Banavar, and A. Spanias, “Distributed
node counting in wireless sensor networks in the presence of communica-
tion noise,” IEEE Sensors J., vol. 17, no. 4, pp. 1175–1186, Feb. 2017.
[29] R. A. Horn and C. R. Johnson, Matrix Analysis, 2nd ed. Cambridge, U.K.:
Cambridge Univ. Press, 2013.
[30] W. Rudin, Principles of Mathematical Analysis, 3rd ed. New York, NY,
USA: McGraw-Hill, 1976.
[31] J. Tsitsiklis, “Problems in decentralized decision making and computa-
tion,” Ph.D. dissertation, Dept. Elect. Eng. Comput. Sci., Massachusetts
Inst. Technol., Cambridge, MA, USA, 1984.
[32] A. Nedi´c and A. Ozdaglar, “Distributed subgradient methods for multi-
agent optimization,” IEEE Trans. Autom. Control, vol. 54, no. 1, pp. 48–61,
Jan. 2009.
[33] C. N. Hadjicostis, A. D. Domínguez-García, and T. Charalambous, “Dis-
tributed averaging and balancing in network systems: With applications
to coordination and control,” Found. Trends Syst. Control, vol. 5, no. 2/3,
pp. 99–292, 2018.
[34] R. D. Zimmerman, C. E. Murillo-Sanchez, and R. J. Thomas, “MAT-
POWER: Steady-state operations, planning, and analysis tools for power
systems research and education,” IEEE Trans. Power Syst., vol. 26, no. 1,
pp. 12–19, Feb. 2011.
[35] L. Xiao, S. Boyd, and S. Lall, “A scheme for robust distributed sensor
fusion based on average consensus,” in Proc. Int. Symp. Inf. Process.
Sensor Netw., 2005, pp. 63–70.
[36] L. Lessard, B. Recht, and A. Packard, “Analysis and design of optimization
algorithms via integral quadratic constraints,” SIAM J. Optim., vol. 26,
no. 1, pp. 57–95, 2016.
Madi Zholbaryssov received the B.S., M.S.,
and Ph.D. degrees in electrical engineering from
the University of Illinois at Urbana-Champaign,
Urbana, IL, USA, in 2011, 2014, and 2019, re-
spectively.
He is currently a Postdoctoral Research As-
sociate with the Department of Electrical and
Computer Engineering, University of Illinois at
Urbana-Champaign. His current research inter-
ests include applications of distributed control
and optimization in electric power systems.
Christoforos N. Hadjicostis (Fellow, IEEE) re-
ceived the S.B. degrees in electrical engineer-
ing, in computer science and engineering, and
in mathematics, in 1993, the M.Eng. degree in
electrical engineering and computer science in
1995, and the Ph.D. degree in electrical engi-
neering and computer science in 1999 from the
Massachusetts Institute of Technology, Cam-
bridge, MA, USA.
In 1999, he joined the Faculty with the Uni-
versity of Illinois at Urbana–Champaign, where
he was an Assistant and then Associate Professor with the Department
of Electrical and Computer Engineering, the Coordinated Science Lab-
oratory, and the Information Trust Institute. Since 2007, he has been
with the Department of Electrical and Computer Engineering, University
of Cyprus, where he is currently a Professor. His research interests
include fault diagnosis and tolerance in distributed dynamic systems,
error control coding, monitoring, diagnosis and control of large-scale
discrete-event systems, and applications to network security, anomaly
detection, energy distribution systems, medical diagnosis, biosequenc-
ing, and genetic regulatory models.
Dr. Hadjicostis is an Editor in Chief of the Journal of Discrete Event
Dynamic Systems and an Associate Editor of Automatica. He was an
Associate Editor for IEEE TRANSACTIONS ON AUTOMATIC CONTROL, IEEE
TRANSACTIONS ON AUTOMATION SCIENCE AND ENGINEERING, IEEE TRANS-
ACTIONS ON CONTROL SYSTEMS TECHNOLOGY, IEEE TRANSACTIONS ON
CIRCUITS AND SYSTEMS I, and the Journal of Nonlinear Analysis of Hybrid
Systems.
Alejandro D. Domínguez-García (Senior Mem-
ber, IEEE) received the master’s degree in elec-
trical engineering from the University of Oviedo,
Oviedo, Spain, in 2001, and the Ph.D. degree
in electrical engineering and computer science
from the Massachusetts Institute of Technology,
Cambridge, MA, USA, in 2007.
He is currently a Professor with the Depart-
ment of Electrical and Computer Engineering
(ECE) and a Research Professor with the Coor-
dinated Science Laboratory and the Information
Trust Institute, University of Illinois at Urbana-Champaign. He is also
with the ECE Power and Energy Systems Area and has been a Grainger
Associate since August 2011. His research interests include the areas
of system reliability theory and control, and their applications to electric
power systems, power electronics, and embedded electronic systems
for safety-critical/fault-tolerant aircraft, aerospace, and automotive appli-
cations.
Dr. Domínguez-García is a recipient of the NSF CAREER Award in
2010, and the Young Engineer Award from the IEEE Power and Energy
Society in 2012. In 2014, he was invited by the National Academy of
Engineering to attend the US Frontiers of Engineering Symposium, and
was selected by the University of Illinois at Urbana-Champaign Provost
to receive a Distinguished Promotion Award. In 2015, he received the U
of I College of Engineering Dean’s Award for Excellence in Research. He
is an Editor for IEEE TRANSACTIONS POWER SYSTEMS and IEEE POWER
ENGINEERING LETTERS; he has been an editor for IEEE TRANSACTIONS
ON CONTROL OF NETWORK SYSTEMS.

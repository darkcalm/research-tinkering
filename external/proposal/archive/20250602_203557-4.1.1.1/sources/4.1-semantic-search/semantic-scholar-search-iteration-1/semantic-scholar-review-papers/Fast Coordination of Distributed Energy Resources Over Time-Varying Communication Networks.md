

---

Page 1

---

IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
1023
Fast Coordination of Distributed Energy
Resources Over Time-Varying
Communication Networks
Madi Zholbaryssov
, Christoforos N. Hadjicostis
, Fellow, IEEE,
and Alejandro D. DomÃ­nguez-GarcÃ­a
, Senior Member, IEEE
Abstractâ€”In this article, we consider the problem of op-
timally coordinating the response of a group of distributed
energy resources (DERs) controlled by distributed agents
so they collectively meet the electric power demanded by
a collection of loads while minimizing the total generation
cost and respecting the DER capacity limits. This problem
can be cast as a convex optimization problem, where the
global objective is to minimize a sum of convex functions
corresponding to individual DER generation cost while
satisfying 1) linear inequality constraints corresponding to
the DER capacity limits and 2) a linear equality constraint
corresponding to the total power generated by the DERs
being equal to the total power demand. We develop
distributed algorithms to solve the DER coordination
problem over time-varying communication networks with
either bidirectional or unidirectional communication links.
The proposed algorithms can be seen as distributed
versions of a centralized primalâ€“dual algorithm. One of
the
algorithms
proposed
for
directed
communication
graphs has a geometric convergence rate even when
communication out-degrees are unknown to agents. We
showcase the proposed algorithms using the standard
IEEE 39-bus test system and compare their performance
against other ones proposed in the literature.
Index Termsâ€”Consensus control, directed graphs, dis-
tributed algorithms, distributed power generation.
I. INTRODUCTION
I
T IS envisioned that present-day power grids, which are
dependent on centralized power generation stations, will
Manuscript received 28 January 2021; revised 25 May 2021, 26
November 2021, 16 April 2022, and 29 August 2022; accepted 2 Oc-
tober 2022. Date of publication 11 October 2022; date of current ver-
sion 30 January 2023. The work of A. D. DomÃ­nguez-GarcÃ­a and M.
Zholbaryssov was supported in part by the U.S. Department of En-
ergyâ€™s Ofï¬ce of Energy Efï¬ciency and Renewable Energy (EERE) under
Solar Energy Technologies Ofï¬ce (SETO) under Agreement Number
EE0009025 and in part by the U.S. Department of Defenseâ€™s Envi-
ronmental Security Technology Certiï¬cation Program (ESTCP) under
Contract Number W912HQ-20-C-0039. Recommended by Associate
Editor S.-i. Azuma. (Corresponding author: Christoforos N. Hadjicostis.)
Madi Zholbaryssov and Alejandro D. DomÃ­nguez-GarcÃ­a are with the
ECE Department, University of Illinois at Urbana-Champaign, Urbana,
IL 61801 USA (e-mail: madikaz@gmail.com; aledan@illinois.edu).
Christoforos N. Hadjicostis is with the ECE Department, University of
Illinois at Urbana-Champaign, Urbana, IL 61801 USA, and also with the
ECE Department, University of Cyprus, 1678 Nicosia, Cyprus (e-mail:
chadjic@ucy.ac.cy).
Color versions of one or more ï¬gures in this article are available at
https://doi.org/10.1109/TAC.2022.3213626.
Digital Object Identiï¬er 10.1109/TAC.2022.3213626
transition toward more decentralized power generation mostly
based on distributed energy resources (DERs). One of the ob-
stacles in making this shift happen is to ï¬nd effective control
strategies for coordinating DERs. In this regard, and partly due
to high variability introduced by renewable-based generation
resources, DERs will need to more frequently adjust their set-
points, which entails the development of fast control strategies.
Also, because of the communication overhead, it may not be
feasible to use a centralized approach to coordinate a large
number of DERs over a large geographic area. This necessitates
DER coordination using distributed control strategies that scale
well to power networks of large size.
Inthiswork,weconsideragroupofDERsandelectricalloads,
which are interconnected by an electric power network, and can
exchange information among themselves via some communica-
tion network. Each DER is endowed with a power generation
cost function, which is unknown to other DERs, and its power
output is upper- and lower-limited by some (possibly time-
varying) capacity constraints. A computing device, referred to
as an agent, attached to each DER is able to communicate with
the computing devices (agents) of other DERs located within
its communication range. Then, the objective is to determine,
in a distributed manner, DER optimal power outputs so as to
satisfy total electric power demand while minimizing the total
generation cost and respecting DER capacity limits. This DER
coordination problem can be cast as a convex optimization
problem (see, e.g., [1], [2], [3], [4], [5], [6], [7]), where the
global objective is to minimize a sum of convex functions corre-
sponding to the costs of generating power from the DERs while
satisfying linear inequality constraints on the power produced by
each DER, and a linear equality constraint corresponding to the
total generated power being equal to the total power consumed
by the electrical loads.
We consider two types of communication networks described
by either an undirected or directed graph based on various modes
of communication between communication devices: simplex
mode, half-duplex mode, and full-duplex mode (see, e.g., [8,
Ch. 11]). In simplex mode, transmission occurs only in one
direction. In half-duplex mode, transmission occurs in both
directions, but only in one direction at a time. In full-duplex
mode, the end communication devices transmit and receive
information simultaneously. In our work, undirected graphs are
used to represent networks where communication devices oper-
ate in full-duplex mode allowing us to use a signiï¬cantly simpler
distributed algorithm than the one proposed for directed graphs.
Directed graphs are used to represent a more general class of
networks where communication devices operate in any of the
This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see http://creativecommons.org/licenses/by/4.0/


---

Page 2

---

1024
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
three aforementioned modes but require a more complicated
algorithm to coordinate DERs.
As packets of data transmitted by communication devices
are not guaranteed to reach their destination, communication
links of the corresponding communication graph will only be
present with some probability making the communication graph
time-varying. Typical causes of packet losses are a link conges-
tion due to limited bandwidth, interference from other signals,
hardware faults, and, in the case of wireless communication
networks, weak wireless signal, and a receiver being able to
receive and process only one signal at a time [8]. Not handling
unreliable communication in a proper way will prevent us from
ï¬nding an optimal solution to the DER coordination problem.
This serves as a motivation for designing algorithms that solve
the DER coordination problem by properly handling unreliable
communication.
To this end, we focus on the challenges that arise due to the
time-varying nature of the underlying communication network
and address the DER coordination problem via distributed algo-
rithms that are capable of operating over time-varying commu-
nication graphs with either 1) bidirectional or 2) unidirectional
communication links. These algorithms also have a geometric
convergence rate, which is a desirable feature for ensuring
fast performance. We believe that the proposed algorithms can
be extended to solve more complex DER coordination prob-
lems with additional constraints, e.g., line ï¬‚ow constraints,
voltage constraints, or reactive power balance constraints, as
long as these are linear or have a separable structure, i.e.,
each constraint is local or involves only a pair of neighboring
agents.
A vast body of work has focused on solving the DER coor-
dination problem in a distributed way (see, e.g., [1], [2], [3],
[4], [5], [6], [7], [9], [10], [11], [12]). Earlier works focused
on time-invariant communication networks (see, e.g., [1], [2],
[9], [10]). In one of the earliest works, Zhang and Chow [1]
proposed a distributed approach in which agentsâ€™ local estimates
aredriventotheoptimal incremental cost viatheleaderâ€“follower
consensus algorithm. DomÃ­nguez-GarcÃ­a et al. [2] utilize the
so-called ratio-consensus algorithm (see, e.g., [13], [14]) to
distributively compute the solution to the dual formulation of
the DER coordination problem. Later works focused on time-
varyingcommunicationnetworks(see,e.g.,[3],[4],[5],[6],[7]).
For example, in [3], assuming that generation cost functions are
quadratic, Kar and Hug propose a distributed algorithm that uses
a consensus term to converge to a common incremental cost, and
a subgradient term to satisfy the total load demand. In [7], Wu
et al. propose a robustiï¬ed version of the so-called subgradient-
push method (see, e.g., [15]) that utilizes the so-called push-sum
protocol (see, e.g., [16], [17], [18]) to converge to a consensual
solution over time-varying directed communication networks.
However, the convergence of the algorithms proposed in [3]
and [7] is not guaranteed to be geometrically fast and might be
slow due to the fact that the algorithms use a diminishing step-
size. In [11] and [12], the authors propose distributed algorithms
based on the dual-ascent method that have a geometric conver-
gence rate but require the agents to know their communication
out-degrees.
Our starting point in the design of our algorithms is a primalâ€“
dual algorithm (ï¬rst-order Lagrangian method), where the dual
variable associated with the power balance constraint depends
on the total power imbalance (supplyâ€“demand mismatch). We
then develop distributed versions of this primalâ€“dual algorithm
by having DER agents closely emulate the iterations of the
primalâ€“dual algorithm. To this end, each agent maintains an
estimate of the dual variable and updates it using a local es-
timate of the total power imbalance and the neighborsâ€™ esti-
mates of the total power imbalance. The update of the total
power imbalance estimate is based on the gradient tracking idea
that appeared in [19]. To enable agents to operate over time-
varying directed communication graphs when their communi-
cation out-degrees are unknown to them, we propose a robust
distributed primalâ€“dual algorithm that converges geometrically
fast.
Each proposed algorithm is viewed as a feedback intercon-
nection of the (centralized) primalâ€“dual algorithm representing
the nominal system and the error dynamics due to the nature
of the distributed implementation. The key ingredient for estab-
lishing the convergence results is to show that both systems are
ï¬nite-gain stable, which then allows us to use the small-gain
theorem (see, e.g., [20]) to establish the convergence of the
feedback interconnected system. The small-gain-theorem-based
analysis ï¬rst appeared in [19] in the context of distributed
algorithms for solving an unconstrained consensus optimization
problem.
Contributions: We note that the distributed algorithms in [19],
which were proposed to solve an unconstrained distributed
optimization problem, cannot be easily applied to solve the DER
coordination problem because of the additional inequality and
equality constraints that appear in our problem formulation. The
presence of these inequality and equality constraints poses major
challenges in establishing the convergence of the distributed
algorithms we propose and in quantifying an upper bound for
stepsizes where this convergence occurs. Showing the ï¬nite-gain
stability of the two systems, the nominal system and the error
dynamics, which comprise the distributed algorithm, requires a
nontrivial analysis. Although the distributed algorithms in [11]
and [12] can be used to solve the DER coordination problem over
directed graphs, they require each agent to know its communica-
tion out-degree, i.e., the number of neighbors who received its
information, at every iteration. Obtaining such information at
every iteration is a very challenging task when communication
links are directed and not reliable. To overcome these issues,
we propose a distributed algorithm, which attains a geometric
convergence rate and where each agent is only required to know
its nominal out-degree, i.e., the number of neighbors who can
receive its information, which can be learned or precomputed
before executing the proposed algorithm.
Additionally, we propose a different algorithm for undirected
graphs used to represent the communication networks where
communication devices operate in the so-called full-duplex
mode (see, e.g., [8, Ch. 11]) that allows communication de-
vices to transmit and receive information simultaneously. This
distributed algorithm is signiï¬cantly simpler than the one pro-
posed for directed graphs and does not require any additional
information about the nominal out-degrees. We also show that
other variants of the primalâ€“dual algorithm (see, e.g., [21],
[22]) can be leveraged as a base for designing the distributed
counterparts as long as these variants under additive disturbance
are ï¬nite-gain stable maps from the disturbance to their out-
put, and the outputs of the individual systems in the feedback
system representation enter as additive disturbances to each
other.


---

Page 3

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1025
II. PRELIMINARIES
In this section, we formulate the DER coordination problem
and give an overview of the small-gain theorem for discrete-time
systems.
A. DER Coordination Problem
We consider a collection of DERs and electrical loads inter-
connected by a power network. Let pi denote the power output of
the DER at bus i, 1 â‰¤i â‰¤n. Let â„“i denote the amount of power
to be consumed by the load at bus i, 1 â‰¤i â‰¤n, which is locally
measured and known to the DER at the same bus, and assumed
to be ï¬xed while the DER coordination problem is solved. Let
pi and pi denote the lower and upper limits, respectively, on the
power that the DER at bus i can generate. Also, let fi(Â·) denote
the cost function associated with the electric power generated
by the DER at bus i. Then, our main objective is to determine
the power that needs to be generated by the DERs in order to
collectively satisfy the total electric power demand, n
i=1 â„“i,
while minimizing the total generation cost, n
i=1 fi(pi).
More formally, we consider the following DER coordination
problem that has been studied in [1], [2], [3], [4], [6], and [7]:
minimize
pâˆˆRn
n

i=1
fi(pi)
(1a)
subject to 1âŠ¤p = 1âŠ¤â„“
(1b)
p â‰¤p â‰¤p
(1c)
where p = [p1, . . . , pn]âŠ¤, â„“= [â„“1, . . . , â„“n]âŠ¤, p = [p1, . . . , pn]âŠ¤,
p = [p1, . . . , pn]âŠ¤, and 1 is the all-ones vector (its size should
be clear from the context). We assume that 1âŠ¤p â‰¤1âŠ¤â„“â‰¤1âŠ¤p,
which makes (1) feasible. A widely used function for represent-
ing the generation cost of electric power generator units is a
quadratic function (see, e.g., [23, Ch. 11], [24, Ch. 5]), which
belongs to the class of twice differentiable and strongly convex
functions as stated in the following assumption.
Assumption 1: Each cost function fi(Â·) is twice differentiable
and strongly convex with parameter m > 0, i.e., f â€²â€²
i (x) â‰¥m,
âˆ€x âˆˆ[pi, pi], âˆ€i âˆˆV.
Let A(x) denote the set of active inequality constraints for a
feasible point x âˆˆRn given by
A(x) := {j | xj = pj or xj = pj}.
Let ej denote an n-dimensional vector whose jth entry is equal
to 1 and all other entries are equal to zero. We make the
following standard regularity assumption on the solution of (1)
(see, e.g., [25, Ch. 3.3]).
Assumption 2: The optimal solution of (1), denoted by pâ‹†,
is regular, namely, the equality constraint gradient, given by
1, and the active inequality constraint gradients, given by ej,
j âˆˆA(pâ‹†), are linearly independent.
The main objective of our work in this article is to design
a distributed algorithm for solving (1) geometrically fast over
time-varying communication networks.
B. Small-Gain Theorem
In the following, we give a brief overview of the main analysis
tool used in later developmentsâ€”the small-gain theorem (see,
e.g.,[20,Th.5.6])fordiscrete-timesystems.Fortheforthcoming
developments, we adopt the appropriate metric for measuring
the energy content of signals of interest. For a given sequence
of iterates, {x[k]}âˆ
k=0, where x[k] âˆˆRn, consider the following
norm (previously used in [19]):
âˆ¥xâˆ¥a,K
2
:= max
0â‰¤kâ‰¤K aâˆ’kâˆ¥x[k]âˆ¥2
for some a âˆˆ(0, 1), where âˆ¥Â· âˆ¥2 is the Euclidean norm. If
âˆ¥xâˆ¥a,K
2
is bounded for all K â‰¥0, then, aâˆ’kâˆ¥x[k]âˆ¥2 is bounded
for all k â‰¥0, and, thus, it follows that x[k] converges to zero at
a geometric rate O(ak).
Now, consider a feedback connection of two discrete-time
systems, H1 and H2, such that
e2[k + 1] = H1(e1[k])
e1[k + 1] = H2(e2[k]).
We assume that H1 and H2 are ï¬nite-gain stable in the sense of
the norm âˆ¥Â· âˆ¥a,K
2
, namely, the following relations hold:
âˆ¥e2âˆ¥a,K
2
â‰¤Î³1âˆ¥e1âˆ¥a,K
2
+ Î²1
(2a)
âˆ¥e1âˆ¥a,K
2
â‰¤Î³2âˆ¥e2âˆ¥a,K
2
+ Î²2
(2b)
for some nonnegative constants Î²1, Î²2, Î³1, and Î³2. From (1), we
have that
âˆ¥e2âˆ¥a,K
2
â‰¤Î³1âˆ¥e1âˆ¥a,K
2
+ Î²1 â‰¤Î³1Î³2âˆ¥e2âˆ¥a,K
2
+ Î³1Î²2 + Î²1
which by rearranging yields âˆ¥e2âˆ¥a,K
2
â‰¤Î³1Î²2+Î²1
1âˆ’Î³1Î³2 . Similarly,
âˆ¥e1âˆ¥a,K
2
â‰¤Î³2Î²1+Î²2
1âˆ’Î³1Î³2 . Then, if Î³1Î³2 < 1, âˆ¥e1âˆ¥a,K
2
and âˆ¥e2âˆ¥a,K
2
are bounded, and e1[k] and e2[k] converge to zero at a geometric
rate O(ak).
III. DER COORDINATION OVER TIME-VARYING UNDIRECTED
GRAPHS
In this section, we present a distributed algorithm for solving
the DER coordination problem (1) over time-varying undirected
communication graphs.
A. Communication Network Model
Here, we introduce the model describing the communication
network that enables the bidirectional exchange of information
between DER agents. Let G(0) = (V, E(0)) denote an undirected
graph, where each agent in the vertex set V := {1, 2, . . . , n} cor-
responds to a DER, and {i, j} âˆˆE(0) if there is a communication
link between DER agents i and j that allows them to exchange
information. It is assumed that G(0) does not contain self-loops.
During any bounded time interval (tk, tk+1), successful data
transmissions among the DER agents can be captured by the
undirected graph G(c)[k] = (V, E(c)[k]), where E(c)[k] âŠ†E(0)
is the set of active communication links, with {i, j} âˆˆE(c)[k]
if agents i and j simultaneously (and successfully) exchange
information with each other during time interval (tk, tk+1). Let
Ni := {j âˆˆV : {i, j} âˆˆE(0)} denote the set of nominal neigh-
bors of agent i, and deï¬ne its nominal degree, which includes
itself, as d+
i := |N +
i | + 1. Let Ni[k] denote the set of neighbors
of agent i during time interval (tk, tk+1), i.e., Ni[k] := {j âˆˆV :
{i, j} âˆˆE(c)[k]}. We make the following standard assumption
regarding the connectivity of the network (see, e.g., [15], [19]).


---

Page 4

---

1026
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
Assumption 3: There exists some positive integer B such that
the graph with vertex set V and edge set (k+1)Bâˆ’1
l=kB
E(c)[l] is
connected for k = 0, 1, . . . .
To satisfy Assumption 3, active communication links are not
required to form a connected graph during every time interval
(tk, tk+1), k = 1, 2, . . . , but only during some longer time in-
tervals of bounded length. Note that Assumption 3 necessarily
implies that the nominal graph G(0) is connected.
B. Distributed Primalâ€“Dual Algorithm
Our starting point to solve (1) is the following primalâ€“dual
algorithm [25, Ch. 4.4] with the additional projection:
pi[k + 1] =

pi[k] âˆ’sf â€²
i(pi[k]) + sÎ¾Î»[k]
pi
pi
(3a)
Î»[k + 1] = Î»[k] âˆ’s1âŠ¤(p[k] âˆ’â„“)
(3b)
where p[k] = [p1[k], . . . , pn[k]]âŠ¤, [Â·]pi
pi denotes the projection
onto the interval [pi, pi], i.e.,
[x]pi
pi =
â§
â¨
â©
pi
if x < pi
x
if x âˆˆ[pi, pi]
pi
if x > pi
s > 0 is a constant stepsize, Î¾ > 0 is a constant parameter,
and Î»[k] is the estimate of the Lagrange multiplier at time
k associated with the power balance constraint, 1âŠ¤p = 1âŠ¤â„“.
Algorithm (3) does not conform to the general communication
model described in Section III-A because in order to execute it,
the total power imbalance, 1âŠ¤(p[k] âˆ’â„“), at time k is needed to
update Î»[k].
To design a distributed version of (3), each agent i needs
to have a local estimate of Î»[k], denoted by Î»i[k]. To update
Î»i[k], it should also have an estimate of 1âŠ¤(p[k] âˆ’â„“). One such
estimate that can be constructed purely based on the local power
imbalance is Ë†n(pi[k] âˆ’â„“i), where Ë†n is some estimate of n that
every agent has,1 e.g., Ë†n can be one, which leads us to the
following distributed algorithm:
pi[k + 1] = [pi[k] âˆ’sf â€²
i(pi[k]) + sÎ¾Î»i[k]]pi
pi
(4a)
Î»i[k + 1] =
â›
â1 âˆ’

j
wij[k]
â
â Î»i[k] +

j
wij[k]Î»j[k]
âˆ’sË†n(pi[k] âˆ’â„“i)
(4b)
where wij[k] = wji[k] â‰¥Î· if {i, j} âˆˆE(c)[k], wij[k] = 0 if
{i, j} /âˆˆE(c)[k], and the constant Î· > 0 is chosen so that
1 âˆ’
j wij[k] â‰¥Î·. Even if Ë†n is an accurate estimate of n,
Ë†n(pi[k] âˆ’â„“i) is a very crude estimate of 1âŠ¤(p[k] âˆ’â„“), and
results in poor performance as will be demonstrated later via
numerical simulations.
A better approach is to let each agent estimate the total power
imbalance by using its local power imbalance and the estimates
of its neighbors. To elaborate on this further, we let yi denote
1We note that Ë†n must be precomputed before running the distributed algo-
rithms we propose. The problem of estimating distributively the number of
nodes in various types of networks has been extensively discussed and tackled
in a number of works (see, e.g., [26], [27], [28] and references therein) under
various assumptions on the underlying communication graph.
agent iâ€™s estimate of the total power imbalance. Then, one way
to update yi is as follows:
yi[k + 1] =
â›
â1 âˆ’

j
wij[k]
â
â yi[k] +

j
wij[k]yj[k]
+ Ë†n(pi[k + 1] âˆ’pi[k])
(5)
where yi[0] = Ë†n(pi[0] âˆ’â„“i). In (5), agent i ï¬rst computes the
average of its estimate and the estimates of its neighbors,
and then adds Ë†n(pi[k + 1] âˆ’pi[k]) to ensure that the aver-
age of all total power imbalance estimates is always equal to
(Ë†n/n)1âŠ¤(p[k] âˆ’â„“), which is equal to the total power imbalance,
1âŠ¤(p[k] âˆ’â„“) if Ë†n = n. This second step allows local estimates
to remain close to the total power imbalance. In the following,
we provide the complete update formulae for the primal and dual
variables:
pi[k + 1] = [pi[k] âˆ’sf â€²
i(pi[k]) + sÎ¾Î»i[k]]pi
pi
(6a)
Î»i[k + 1] =
â›
â1 âˆ’

j
wij[k]
â
â Î»i[k] +

j
wij[k]Î»j[k]
âˆ’syi[k]
(6b)
yi[k + 1] =
â›
â1 âˆ’

j
wij[k]
â
â yi[k] +

j
wij[k]yj[k]
+ Ë†n(pi[k + 1] âˆ’pi[k]).
(6c)
Note that in (6b), agent i computes the (weighted) average of its
estimate and the estimates of its neighbors, which yields a good
estimate of Î». The iterations in (6) are initialized with Î»i[0] = 0,
and yi[0] = Ë†n(pi[0] âˆ’â„“i).
C. Feedback Interconnection Representation of the
Distributed Primalâ€“Dual Algorithm
In the following, we represent (6) as a feedback interconnec-
tion of a nominal system, denoted by H1, and a disturbance
system, denoted by H2, which allows us to utilize the small-
gain theorem for convergence analysis purposes. To this end,
let e[k] := Î»[k] âˆ’( 1
n1âŠ¤Î»[k])1, Î»[k] = [Î»1[k], . . . , Î»n[k]]âŠ¤, and
Ë†Î»[k] := (1/Ë†n)1âŠ¤Î»[k]; then, we deï¬ne the nominal system, H1,
as follows:
H1 :
â§
âª
â¨
âª
â©
p[k + 1] =

p[k] âˆ’sâˆ‡f(p[k]) + sÎ¾ Ë†n
n1Ë†Î»[k]
+sÎ¾e[k]
p
p
(7a)
Ë†Î»[k + 1] = Ë†Î»[k] âˆ’s1âŠ¤(p[k] âˆ’â„“)
(7b)
where âˆ‡f(p[k]) = [f â€²
1(p1[k]), f â€²
2(p2[k]), . . . , f â€²
n(pn[k])]âŠ¤, and
[Â·]p
p denotes the componentwise projection onto the box [p, p],
i.e., [x]p
p = [[x1]p1
p1, [x2]p2
p2, . . . , [xn]pn
pn]âŠ¤. Note that in order to
obtain (7a), we substituted e[k] + (Ë†n/n)1Ë†Î»[k] for Î»[k] in (6a),
and summed (6b) over all i and divided the result by Ë†n to
obtain (7b). We note that e[k] is the vector of deviations of the
local estimates of the Lagrange multiplier from their average at
time instant k; without e[k], the nominal system H1 has almost
the same form as (3). Now, we deï¬ne the disturbance system,


---

Page 5

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1027
Fig. 1.
Algorithm (2) as a feedback system.
H2, as follows:
H2 :
â§
â¨
â©
y[k + 1] = W[k]y[k] + Ë†n(p[k + 1] âˆ’p[k])
(8a)
Î»[k + 1] = W[k]Î»[k] âˆ’sy[k]
(8b)
e[k] = Î»[k] âˆ’(Ë†n/n)1Ë†Î»[k]
(8c)
where W[k] = [wij[k]] âˆˆRnÃ—n is a weight matrix at time in-
stant k. Then, as illustrated in Fig. 1, algorithm (6) can be viewed
as a feedback interconnection of H1 and H2, where (pâˆ—, Î»âˆ—) is
the equilibrium of (7) when e[k] â‰¡0, for all k â‰¥0. Finding the
relationship between the loop gain of the feedback system and
the stepsize s allows us to quantify the effect of the feedback
system on the convergence error in terms of the stepsize. We
later show that the loop gain can be decreased by decreasing s.
As a matter of fact, if the loop gain is sufï¬ciently small, then, the
feedback loop does not amplify the energy of the convergence
error, and, on the contrary, the error eventually decays to zero,
which follows from the small-gain theorem.
Remark 1: We note that the feedback system representation
in Fig. 1 allows one to decouple the convergence analysis of the
distributed algorithm into two separate parts. In the ï¬rst part,
we analyze the convergence properties of the basic primalâ€“dual
algorithm (1) under disturbance, whereas in the second part, we
analyze the convergence properties of the underlying consen-
sus algorithm under disturbance. Then, the small-gain theorem
merges these two parts to show the convergence properties of
the entire system.
D. Convergence Analysis
In order to invoke the small-gain theorem, we must ï¬rst
show that the following relations between the energy of the
convergence error and that of the disturbance hold:
R1. âˆ¥zâˆ¥a,K
2
â‰¤Î±1âˆ¥eâˆ¥a,K
2
+ Î²1 for some positive Î±1 and Î²1
R2. âˆ¥eâˆ¥a,K
2
â‰¤sÎ±2âˆ¥zâˆ¥a,K
2
+ Î²2 for some positive Î±2 and
Î²2
for some a âˆˆ(0, 1), small enough s > 0, and âˆ€Î¾ > 0, where
z[k] :=
p[k] âˆ’pâˆ—
Ë†Î»[k] âˆ’Î»âˆ—

denotes the convergence error. The results R1 and R2 are equiv-
alent to ensuring that the systems H1 and H2 in Fig. 1 are
ï¬nite-gain stable. From R1 and R2, it can be determined that
the loop gain is sÎ±1Î±2. Noticing that the gain sÎ±1Î±2 becomes
strictly smaller than 1 for sufï¬ciently small s, we later show that
âˆ¥zâˆ¥a,K
2
becomes bounded for all K > 0, and that z[k] converges
to zero at a geometric rate O(ak). In the following, we show that
the relations R1 and R2 hold and present the convergence results
for algorithm (6).
We ï¬rst establish that pâˆ—= pâ‹†, namely, pâˆ—is the solution of
(1); its proof can be found in the Appendix.
Lemma 1: Consider (pâˆ—, Î»âˆ—), namely, the equilibrium of the
nominal system H1 with e[k] â‰¡0, âˆ€k. Then, pâˆ—is the solution
of (1).
To provide an upper bound on the stepsize s, we introduce
some notation. It follows from the proof of [19, Lemma 3.10]
that âˆ¥e[k]âˆ¥2 is always bounded, i.e., âˆ¥e[k]âˆ¥2 â‰¤M, for some
M > 0. Deï¬ne Ïˆ := max(1âŠ¤(â„“âˆ’p), 1âŠ¤(p âˆ’â„“))/âˆšÎ¾Ë†n
Î”Ï•max
i
:= max

max
jâˆˆV

pj âˆ’pj + f â€²
j(pj)/

Î¾Ë†n

+ 2

Î¾Ë†n/nÏˆ âˆ’f â€²
i(pi)/

Î¾Ë†n + 2M

Î¾/Ë†n
f â€²
i(pi)/

Î¾Ë†n + 2M

Î¾/Ë†n + 2

Î¾Ë†n/nÏˆ
âˆ’min
jâˆˆV

pj âˆ’pj + f â€²
j(pj)/

Î¾Ë†n
 
(9)
Î¶i := min(pi âˆ’pâˆ—
i, pâˆ—
i âˆ’pi)/Î”Ï•max
i
(10)
and let constants a1, a2, and Î´ be such that a1 > 0, and
Î´ := (Î¾Ë†n/n)2
n

i=1
a1s2
1 + s2 + 2Î¶i
(11)
a2 := (Î¾Ë†n/n)a1 + (Î¾Ë†n/n)2s2a1n + (Î¾Ë†n/n)a1s2 âˆ’Î´.
(12)
Note that since pâˆ—is regular, there exists l such that pl < pâˆ—
l <
pl, yielding Î¶l > 0. Let E := 11âŠ¤, D âˆˆRnÃ—n and D âˆˆRnÃ—n
denote diagonal matrices with Dii = minpiâ‰¤piâ‰¤pi f â€²â€²
i (pi) and
Dii = maxpiâ‰¤piâ‰¤pi f â€²â€²
i (pi), respectively. Deï¬ne
F(s) :=
F11(s)
F12(s)
F21(s)
F22(s)

(13)
where
F11(s) = 2sa1D âˆ’s2a1(I + (D)2 + 2Î¾Ë†n/nE)
âˆ’s2a2E + s3a1(âˆ’2Î¾Ë†nI + 2D âˆ’I)
âˆ’s2Î´I âˆ’s4a1(D)2
F12(s) = Î¾Ë†n/ns4a1(D1 + 1), F21(s) = F12(s)âŠ¤
F22(s) = (Î¾Ë†n/n)2a1s2
 n

i=1
s2 + 2Î¶i
1 + s2 + 2Î¶i
âˆ’s2n

âˆ’a2s3.
Since
s2+2Î¶i
1+s2+2Î¶i â‰¥
2Î¶i
1+2Î¶i , we have that, for sufï¬ciently small
s > 0
F22(s) > (Î¾Ë†n/n)2a1s2
 n

i=1
2Î¶i
1 + 2Î¶i
âˆ’s2n

âˆ’a2s3 > 0
where the last inequality follows since the quadratic term
dominates the higher-order terms for sufï¬ciently small s > 0.
Let S(F )(s) denote the Schur complement of F22(s) in F(s),
namely, S(F )(s) := F11(s) âˆ’F12(s)F22(s)âˆ’1F21(s). It is easy
to see that, for sufï¬ciently small s > 0, S(F )(s) is positive
deï¬nite, since the linear term dominates the higher-order terms.


---

Page 6

---

1028
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
Deï¬ne
s := min{s > 0 : S(F )(s) is not positive deï¬nite or
F22(s) = 0}.
(14)
Then, by [29, Th. 7.7.6], since S(F )(s) is positive deï¬nite and
F22(s) > 0, âˆ€s âˆˆ(0, s), F(s) is positive deï¬nite, âˆ€s âˆˆ(0, s).
In the next result, we establish that H1 is ï¬nite-gain stable.
Proposition 1: Let Assumptions 1 and 2 hold. Then, un-
der (7), we have that
R1. âˆ¥zâˆ¥a,K
2
â‰¤Î±1âˆ¥eâˆ¥a,K
2
+ Î²1
(15)
for some positive Î±1 and Î²1, a âˆˆ(0, 1), âˆ€s âˆˆ(0, min(s, 1/
âˆšÎ¾Ë†n)), and âˆ€Î¾ > 0.
Proof: Deï¬ne
P :=

a1I
âˆ’sa1Î¾ Ë†n
n1
âˆ’sa1Î¾ Ë†n
n1âŠ¤
a2

.
Then, the Schur complement of a2 in P, denoted by S, is given
by
S := a1I âˆ’(1/a2)(sa1Î¾Ë†n/n)211âŠ¤.
From (11), we have that Î´ < (Î¾Ë†n/n)2 s2a1n; then, it follows
from (12) that
a2 > (Î¾Ë†n/n)a1.
(16)
By using (16), we have that2
S/a1 > I âˆ’s2Î¾Ë†n/n11âŠ¤.
Since s < 1/âˆšÎ¾Ë†n, it follows that S is positive deï¬nite. Then,
by [29, Th. 7.7.6], since S is positive deï¬nite and a2 > 0, P is
positive deï¬nite. Deï¬ne a vector norm âˆ¥xâˆ¥P :=
âˆš
xâŠ¤Px, and
Ï•[k] := p[k] âˆ’sâˆ‡f(p[k]) + sÎ¾ Ë†n
n1Ë†Î»[k]
(17a)
Ï•âˆ—:= pâˆ—âˆ’sâˆ‡f(pâˆ—) + sÎ¾ Ë†n
n1Î»âˆ—
(17b)
Ïµ[k] := sÎ¾e[k]
(17c)
Î”Ï•[k] := Ï•[k] + Ïµ[k] âˆ’[Ï•[k] + Ïµ[k]]p
p
(17d)
Î”Ï•âˆ—:= Ï•âˆ—âˆ’[Ï•âˆ—]p
p.
(17e)
The result of the following lemma is needed for the subsequent
development; its proof can be found in the Appendix.
Lemma 2:


[Ï•[k] + Ïµ[k]]p
p âˆ’[Ï•âˆ—]p
p
Ë†Î»[k + 1] âˆ’Î»âˆ—

P
â‰¤

Ï•[k] + Ïµ[k] âˆ’Ï•âˆ—
Ë†Î»[k + 1] âˆ’Î»âˆ—

P +T
where
T :=
a1 s2I
0n
0âŠ¤
n
Î´

.
â– 
2We write A > B (A â‰¥B) to denote that a matrix A âˆ’B is positive deï¬nite
(positive semideï¬nite).
Next, it follows from the mean value theorem [30, Th. 5.1]
applied to each component in âˆ‡f(p[k]) âˆ’âˆ‡f(pâˆ—) that
âˆ‡f(p[k]) âˆ’âˆ‡f(pâˆ—) = âˆ‡2f(Ï…[k])(p[k] âˆ’pâˆ—)
(18)
where Ï…[k] := [Ï…1[k], Ï…2[k], . . . , Ï…n[k]]âŠ¤, with Ï…i[k] lying on the
line segment connecting pi[k] and pâˆ—
i, and âˆ‡2f(Ï…[k]) is the
Hessian of f(x) at x = Ï…[k]. Deï¬ne
A[k] :=
I âˆ’sâˆ‡2f(Ï…[k])
sÎ¾ Ë†n
n1
âˆ’s1âŠ¤
1

then, note that
 Ï•[k] âˆ’Ï•âˆ—
Ë†Î»[k + 1] âˆ’Î»âˆ—

= A[k]z[k].
(19)
It follows from the triangle inequality that

Ï•[k] + Ïµ[k] âˆ’Ï•âˆ—
Ë†Î»[k + 1] âˆ’Î»âˆ—

P +T
â‰¤

 Ï•[k] âˆ’Ï•âˆ—
Ë†Î»[k + 1] âˆ’Î»âˆ—

P +T
+

a1(1 + s2)âˆ¥Ïµ[k]âˆ¥2.
(20)
By noting that
z[k + 1] =

[Ï•[k] + Ïµ[k]]p
p âˆ’[Ï•âˆ—]p
p
Ë†Î»[k + 1] âˆ’Î»âˆ—

and putting together the results in Lemma 2, (19), and (20), we
obtain that
âˆ¥z[k + 1]âˆ¥P â‰¤

z[k]âŠ¤A[k]âŠ¤(P + T)A[k]z[k]
+

a1(1 + s2)âˆ¥Ïµ[k]âˆ¥2.
(21)
Deï¬ne Dk := âˆ‡2f(Ï…[k]), Q[k] := P âˆ’A[k]âŠ¤(P + T)A[k];
then, we show that Q[k] â‰¥s3P. Deï¬ne R[k] := Q[k] âˆ’s3P
given by
R[k] =
R11[k]
R12[k]
R21[k]
R22[k]

where
R11[k] = 2sa1Dk âˆ’s2a1(I + D2
k + 2Î¾Ë†n/nE) âˆ’s2a2E
+ s3a1(Î¾Ë†n/nEDk + Î¾Ë†n/nDkE + 2Dk âˆ’I)
âˆ’s2Î´I âˆ’s4a1D2
k
R12[k] = Î¾Ë†n/ns4a1(Dk1 + 1), R21[k] = R12[k]âŠ¤
R22[k] = (Î¾Ë†n/n)2a1 s2
 n

i=1
s2 + 2Î¶i
1 + s2 + 2Î¶i
âˆ’s2n

âˆ’a2 s3.
Let S(R)[k] denote the Schur complement of R22[k] in R[k],
namely, S(R)[k] := R11[k] âˆ’R12[k]R22[k]âˆ’1R21[k]. We recall
that S(F )(s) > 0 and F22(s) > 0, âˆ€s âˆˆ(0, s). Since S(R)[k] â‰¥
S(F )(s) and R22[k] = F22(s), for all k, it follows that S(R)[k] >
0 and R22[k] > 0. Then, by [29, Th. 7.7.6], R[k] is positive
deï¬nite for all k. Hence, Q[k] â‰¥s3P, yielding the following


---

Page 7

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1029
relation from (21):
âˆ¥z[k + 1]âˆ¥P â‰¤

1 âˆ’s3âˆ¥z[k]âˆ¥P +

a1(1 + s2)âˆ¥Ïµ[k]âˆ¥2.
(22)
Recalling that Ïµ[k] = sÎ¾e[k], and letting Î³ :=
âˆš
1 âˆ’s3, and
b1 :=

a1(1 + s2)sÎ¾, we rewrite (22) as follows:
âˆ¥z[k + 1]âˆ¥P â‰¤Î³âˆ¥z[k]âˆ¥P + b1âˆ¥e[k]âˆ¥2.
(23)
Now, by choosing a > Î³, and multiplying both sides of (6)
by aâˆ’(k+1), we obtain
aâˆ’(k+1)âˆ¥z[k + 1]âˆ¥P â‰¤Î³
aaâˆ’kâˆ¥z[k]âˆ¥P + b1
a aâˆ’kâˆ¥e[k]âˆ¥2. (24)
Then, by taking max0â‰¤kâ‰¤K(Â·) on both sides of (24), we obtain
max
0â‰¤kâ‰¤K aâˆ’(k+1)âˆ¥z[k + 1]âˆ¥P â‰¤Î³
a max
0â‰¤kâ‰¤K aâˆ’kâˆ¥z[k]âˆ¥P
+ b1
a
max
0â‰¤kâ‰¤K aâˆ’kâˆ¥e[k]âˆ¥2. (25)
Since
max
0â‰¤kâ‰¤K aâˆ’(k+1)âˆ¥z[k + 1]âˆ¥P =
max
0â‰¤kâ‰¤K+1 aâˆ’kâˆ¥z[k]âˆ¥P âˆ’âˆ¥z[0]âˆ¥P
the relation (25) can be written as
âˆ¥zâˆ¥a,K+1
P
â‰¤Î³
aâˆ¥zâˆ¥a,K
P
+ b1
a âˆ¥eâˆ¥a,K
2
+ âˆ¥z[0]âˆ¥P
(26)
where
âˆ¥xâˆ¥a,K
P
:= max0â‰¤kâ‰¤K aâˆ’kâˆ¥x[k]âˆ¥P
for
a
sequence
{x[k]}âˆ
k=0. Since âˆ¥zâˆ¥a,K+1
P
â‰¥âˆ¥zâˆ¥a,K
P
, it follows from (26) that
âˆ¥zâˆ¥a,K
P
â‰¤Î³
aâˆ¥zâˆ¥a,K
P
+ b1
a âˆ¥eâˆ¥a,K
2
+ âˆ¥z[0]âˆ¥P .
(27)
Then, after rearranging (27), we obtain
âˆ¥zâˆ¥a,K
P
â‰¤
b1
a âˆ’Î³ âˆ¥eâˆ¥a,K
2
+
a
a âˆ’Î³ âˆ¥z[0]âˆ¥P .
Because âˆ¥Â· âˆ¥2 â‰¤Î±âˆ¥Â· âˆ¥P
for some Î± > 0, we have that
âˆ¥zâˆ¥a,K
P
â‰¥âˆ¥zâˆ¥a,K
2
/Î±. Hence
âˆ¥zâˆ¥a,K
2
Î±
â‰¤
b1
a âˆ’Î³ âˆ¥eâˆ¥a,K
2
+
a
a âˆ’Î³ âˆ¥z[0]âˆ¥P
which can be rewritten as
âˆ¥zâˆ¥a,K
2
â‰¤Î±1âˆ¥eâˆ¥a,K
2
+ Î²1
where Î±1 = b1Î±
aâˆ’Î³ , Î²1 =
aÎ±
aâˆ’Î³ âˆ¥z[0]âˆ¥P , yielding (15).
â–¡
We omit the proof of the next result, where we show that
system H2 is ï¬nite-gain stable, since it is analogous to that of
a similar result proposed for directed communication graphs in
Section IV.
Proposition 2: Let Assumption 3 hold. Then, under (8), we
have that
R2. âˆ¥eâˆ¥a,K
2
â‰¤sÎ±2âˆ¥zâˆ¥a,K
2
+ Î²2
for some positive Î±2 and Î²2, a âˆˆ(0, 1).
Now, we show the convergence of algorithm (6) by applying
the small-gain theorem to the results in Propositions 1â€“2.
Proposition 3: Let Assumptions 1, 2, and 3 hold. Then, under
algorithm (6)
âˆ¥zâˆ¥a,K
2
â‰¤Î²
(28)
for some a âˆˆ(0, 1), Î² > 0, âˆ€s âˆˆ(0, min(s, 1/âˆšÎ¾Ë†n, 1/(Î±1
Î±2))), and âˆ€Î¾ > 0. In particular, (pi[k], Î»i[k]) converges to
(pâˆ—
i, Î»âˆ—), âˆ€i, at a geometric rate O(ak).
Proof: By using Propositions 1 and 2, it follows that
âˆ¥zâˆ¥a,K
2
â‰¤Î±1âˆ¥eâˆ¥a,K
2
+ Î²1 â‰¤Î±1(sÎ±2âˆ¥zâˆ¥a,K
2
+ Î²2) + Î²1
which, after rearranging, results in
âˆ¥zâˆ¥a,K
2
â‰¤Î±1Î²2 + Î²1
1 âˆ’sÎ±1Î±2
=: Î²
yielding (28). Hence, for s < 1/(Î±1Î±2), we have that sÎ±1Î±2 <
1, which ensures that Î² is ï¬nite.
â– 
Remark 2: Propositions 1â€“3 imply that instead of (3), other
variants of the primalâ€“dual algorithm (see, e.g., [21], [22]) can
be used as a base for designing the distributed counterparts as
long as these variants satisfy the relation R1, and the outputs of
H1 and H2 enter as additive disturbances to each other.
IV. DER COORDINATION OVER TIME-VARYING
DIRECTED GRAPHS
In this section, we present a distributed algorithm for solving
the DER coordination problem (1) over time-varying directed
communication graphs.
A. Communication Network Model
Here, we introduce the model describing the communication
network that enables the unidirectional exchange of information
between DER agents. Let G(0) = (V, E(0)) denote a directed
graph, where each agent in the vertex set V := {1, 2, . . . , n}
corresponds to a DER, and (i, j) âˆˆE(0) if there is a com-
munication link that allows agent i to send information to
agent j (but not vice versa). We assume that G(0) does not
have self-loops. During any time interval (tk, tk+1), successful
data transmissions among the DER agents can be captured by
the directed graph G(c)[k] = (V, E(c)[k]), where E(c)[k] âŠ†E(0)
is the set of active communication links, with (i, j) âˆˆE(c)[k]
if agent j receives information from agent i during time in-
terval (tk, tk+1), but not necessarily vice versa. Let N +
i
:=
{j âˆˆV : (i, j) âˆˆE(0)} denote the set of nominal out-neighbors
of agent i, and deï¬ne its nominal out-degree, which includes
itself, as di := |N +
i | + 1. Let N +
i [k] and N âˆ’
i [k] denote the
sets of out-neighbors and in-neighbors of agent i, respectively,
during time interval (tk, tk+1), i.e., N +
i [k] := {j âˆˆV : (i, j) âˆˆ
E(c)[k]} and N âˆ’
i [k] := {â„“âˆˆV : (â„“, i) âˆˆE(c)[k]}. We deï¬ne
agent iâ€™s instantaneous (communication) out-degree (including
itself) to be D+
i [k] := |N +
i [k]| + 1. We make the following
standard and reasonable assumptions (see, e.g., [31], [32]).
Assumption 4: The nominal communication graph G(0) =
(V, E(0)) is strongly connected.
Assumption 5: There exists some positive integer B such that
(i, j) âˆˆk+Bâˆ’1
l=k
E(c)[l] for every (i, j) âˆˆE(0), k = 0, 1, . . . .
Assumption 5 is satisï¬ed if a communication link in the
nominal communication graph becomes active at least once over
every time interval of some bounded length. We also assume that
each agent knows its nominal out-degree, as stated next.
Assumption 6: The value of d+
i is known to agent i, i = 1,
2, . . . , n.
Notice that Assumption 6 is weaker than the standard assump-
tion (see, e.g., [12], [15], [19]) that the instantaneous out-degree


---

Page 8

---

1030
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
D+
i [k] is known to agent i at every time instant k, which is hard
to obtain in practice due to unreliable communication.
B. Ratio Consensus Algorithm
We provide a brief overview of the ratio consensus algorithm
(see, e.g., [13], [33]) utilized to estimate the average power
imbalance (or total power imbalance if n is known) and to update
the Lagrange multipliers, Î»i[k], in the distributed algorithms
proposed later.
Consider a group of agents indexed by the set V, each with
some real initial value, i.e., vi at agent i. Each agent aims to ob-
tain the average of the initial values via exchange of information
over the graph G(c)[k]. To this end, we let agent i maintain two
variables, Î¼i[k] and Î½i[k] such that Î¼i[0] = vi and Î½i[0] = 1. We
ï¬rst consider the following updates performed by agent i:
Î¼i[k + 1] =

jâˆˆN âˆ’
i [k]âˆª{i}
Î¼j[k]
D+
j [k]
(29a)
Î½i[k + 1] =

jâˆˆN âˆ’
i [k]âˆª{i}
Î½j[k]
D+
j [k]
(29b)
ri[k + 1] = Î¼i[k + 1]
Î½i[k + 1] .
(29c)
We write (29a)â€“(29b) in a matrix-vector form as follows:
Î¼[k + 1] = P[k]Î¼[k]
(30a)
Î½[k + 1] = P[k]Î½[k]
(30b)
where P[k] is an n Ã— n matrix with Pij[k] = 1/D+
j [k], j âˆˆ
N âˆ’
i [k] âˆª{i}, and Pij[k] = 0, otherwise. We note that P[k] is
column stochastic, and it can be shown that ri[k] converges to
the average of the initial values, namely, limkâ†’âˆri[k] =

i vi
n
[13], as long as Assumptions 4 and 5 hold.
C. Preliminary Distributed Primalâ€“Dual Algorithm
We begin with the following preliminary distributed primalâ€“
dual algorithm, where the averaging step is based on the ratio
consensus algorithm (29), executed by each agent i as follows:
pi[k + 1] = [pi[k] âˆ’sf â€²
i(pi[k]) + sÎ¾xi[k]]pi
pi
(31a)
Î»i[k + 1] =

jâˆˆN âˆ’
i [k]âˆª{i}
Î»j[k] âˆ’syj[k]
D+
j [k]
(31b)
vi[k + 1] =

jâˆˆN âˆ’
i [k]âˆª{i}
vj[k]
D+
j [k]
(31c)
xi[k + 1] = Î»i[k + 1]
vi[k + 1]
(31d)
yi[k + 1] =

jâˆˆN âˆ’
i [k]âˆª{i}
yj[k]
D+
j [k] + Ë†n(pi[k + 1] âˆ’pi[k]) (31e)
where yi[k] is the estimate at instant k of the total power
imbalance, 1âŠ¤(p[k] âˆ’â„“), at agent i. The iterations in (31) are
initialized with xi[0] = 0, Î»i[0] = 0, vi[0] = 1, and yi[0] =
Ë†n(pi[0] âˆ’â„“i). We note that the iterations used to update Î»i[k],
vi[k], and yi[k] are similar to the so-called Push-DIGing algo-
rithm proposed in [19] for solving an unconstrained consensus
optimization problem.
As in the case of undirected graphs, algorithm (31) can be
represented as a feedback interconnection of a nominal system,
denoted by âƒ—H1, and a disturbance system, denoted by âƒ—H2. To
this end, let e[k] := x[k] âˆ’( 1
n1âŠ¤Î»[k])1, and Ë†Î»[k] := 1
Ë†n1âŠ¤Î»[k];
then, we deï¬ne the nominal system, âƒ—H1, as follows:
âƒ—H1 :
â§
âª
â¨
âª
â©
p[k + 1] =

p[k] âˆ’sâˆ‡f(p[k]) + sÎ¾ Ë†n
n1Ë†Î»[k]
+sÎ¾e[k]
p
p
(32a)
Ë†Î»[k + 1] = Ë†Î»[k] âˆ’s1âŠ¤(p[k] âˆ’â„“)
(32b)
where we substituted e[k] + Ë†n
n1Ë†Î»[k] for x[k] in (31a) to ob-
tain (32a), and we summed (31b) over all i and divided the result
by Ë†n to obtain (32b). We note that e[k] is the vector of deviations
from their average at instant k of the local estimates of the
Lagrange multiplier; without e[k], the nominal system âƒ—H1 has
almost the same form as (3). In fact, the nominal systems for the
undirected and directed cases are the same, namely, âƒ—H1 = H1.
Now, we deï¬ne the disturbance system, âƒ—H2, as follows:
âƒ—H2 :
â§
âª
âª
âª
âª
âª
âª
âª
âª
â¨
âª
âª
âª
âª
âª
âª
âª
âª
â©
y[k] = P[k âˆ’1]y[k âˆ’1]
+Ë†n(p[k] âˆ’p[k âˆ’1])
(33a)
Î»[k + 1] = P[k](Î»[k] âˆ’sy[k])
(33b)
v[k + 1] = P[k]v[k],
(33c)
x[k + 1] = (V [k + 1])âˆ’1Î»[k + 1]
(33d)
e[k] = x[k] âˆ’

Ë†n
nË†Î»[k]

1
(33e)
where V [k] := diag(v[k]), P[k] âˆˆRnÃ—n with
Pij[k] :=

1
D+
j [k],
if i = j or (j, i) âˆˆE(c)[k]
0,
else.
Then, algorithm (31) can be viewed as a feedback interconnec-
tion of âƒ—H1 and âƒ—H2, where (pâˆ—, Î»âˆ—) is the equilibrium of (32)
when e[k] â‰¡0, âˆ€k.
Since it is not assumed that each agent i knows its communi-
cation out-degree, D+
i [k], at every time instant k, the averaging
step in Algorithm (31) cannot be executed. However, Algo-
rithm (31) provides some basic ideas behind the main algorithm
presented next.
D. Running-Sum Ratio Consensus Algorithms
Without knowledge of the instantaneous out-degrees, the
averaging step in Algorithm (31) based on the ratio consensus
algorithm(29)cannotbeexecuted.Infact,ifd+
i isusedin(29)in-
stead of D+
i [k], then, P[k] is not necessarily column stochastic,
precluding the DER agents from achieving consensus. However,
the loss of column-stochasticity can be ï¬xed by augmenting
the original network of agents with additional virtual agents
and links such that if agent i does not receive a packet from
agent j, we let a virtual agent receive the packet via a virtual
link [14]. This allows us to augment (30) with additional states
corresponding to the virtual agents so that the augmented system
becomes
Î¼â€²[k + 1] = ËœP[k]Î¼â€²[k]
(34a)
Î½â€²[k + 1] = ËœP[k]Î½â€²[k]
(34b)


---

Page 9

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1031
where Î¼â€²[k] and Î½â€²[k] are the augmented state vectors that, in
addition to the states of the real agents, also contain the states
of the virtual agents. The matrix ËœP[k] can be made column
stochastic by carefully updating the states of the virtual agents.
To explain this, we consider agents i and j connected via a
communication link (j, i) âˆˆE(0), and let Î¼â€²
ji denote the state
of the corresponding virtual agent. If (j, i) /âˆˆE(c)[k], then,
Î¼â€²
ji[k + 1] = Î¼â€²
ji[k] + Î¼j[k]
d+
j , namely, the virtual agent receives
the packet from agent j. If (j, i) âˆˆE(c)[k], then, we consider the
following two options for updating the state of the virtual agent.
1) The virtual agent sends the value of its current state,
Î¼â€²
ji[k], to agent i, and sets the value of the next state to
zero, i.e., Î¼â€²
ji[k + 1] = 0. In the meantime, agent j sends
Î¼j[k]/d+
j to agent i.
2) The virtual agent sends a portion of its current state,
Î³Î¼â€²
ji[k], to agent i, where Î³ is strictly positive and less
than 1, and retains the other portion by performing the
following update:
Î¼â€²
ji[k + 1] = (1 âˆ’Î³)Î¼â€²
ji[k] + (1 âˆ’Î³)Î¼j[k]/d+
j
where we notice that agent j sends (1 âˆ’Î³)Î¼j[k]/d+
j to
the virtual agent and the remaining portion, Î³Î¼j[k]/d+
j ,
to agent i.
The ï¬rst option was chosen in the original running-sum ratio
consensus algorithm (see, e.g., [14]). In this work, we select the
second option, since it allows us to considerably simplify the
convergence analysis. To account for the absence of the virtual
agentsandlinksintheactualcommunicationnetwork,additional
computations must be performed by each transmitting/receiving
agent to effectively capture the effect of the updates by the virtual
agentsonthestatesoftheactualagents.Tothisend,weletagentj
broadcast the running sums k
t=0 Î¼j[t]/d+
j and k
t=0 Î½j[t]/d+
j .
Then, Î¼i[k] and Î½i[k] are updated by agent i as follows:
Î¼i[k + 1] =

jâˆˆN âˆ’
i [k]âˆª{i}
(Î¼ij[k + 1] âˆ’Î¼ij[k])
(35a)
Î½i[k + 1] =

jâˆˆN âˆ’
i [k]âˆª{i}
(Î½ij[k + 1] âˆ’Î½ij[k])
(35b)
ri[k + 1] = Î¼i[k + 1]
Î½i[k + 1]
(35c)
where Î¼ij[k] and Î½ij[k] are additional variables maintained by
agentiandupdatedusingtherunningsumsreceivedfromagentj
as follows:
Î¼ij[k + 1] =
â§
âª
âª
â¨
âª
âª
â©
(1 âˆ’Î³)Î¼ij[k] + Î³ k
t=0
Î¼j[t]
d+
j ,
if j âˆˆN âˆ’
i [k]
Î¼ij[k] + Î¼j[k]
d+
j ,
if j = i
Î¼ij[k],
otherwise
(36a)
Î½ij[k + 1] =
â§
âª
âª
â¨
âª
âª
â©
(1 âˆ’Î³)Î½ij[k] + Î³ k
t=0
Î½j[t]
d+
j ,
if j âˆˆN âˆ’
i [k]
Î½ij[k] + Î½j[k]
d+
j ,
if j = i
Î½ij[k],
otherwise.
(36b)
It is straightforward to see that the use of the running sums in
the updates has the same effect on the states of the actual agents
as the updates by the virtual agents have. Furthermore, by using
the results in [14], it can be shown that ri[k] asymptotically
converges with probability one to the average of the initial
values, namely
lim
kâ†’âˆri[k] =

i vi
n
.
E. Robust Distributed Primalâ€“Dual Algorithm
By utilizing the running-sum ratio-consensus algorithm (35)â€“
(36) in the averaging step, we develop a robust extension of
algorithm (31). We show that this robust extension is able to
solve the DER coordination problem (1) even when every agent i
only knows its nominal out-degree, d+
i , but not its instantaneous
out-degree, D+
i [k].
We let agent j broadcast the running sums k
t=0
Î»j[t]
d+
j ,
k
t=0
vj[t]
d+
j , and k
t=0
yj[t]
d+
j
to its neighbors at each k â‰¥0.
Agent i performs the following updates:
pi[k + 1] = [pi[k] âˆ’sf â€²
i(pi[k]) + sÎ¾xi[k]]pi
pi
(37a)
Î»i[k + 1] =

jâˆˆN âˆ’
i [k]âˆª{i}
(Î»ij[k + 1] âˆ’Î»ij[k] âˆ’syij[k + 1]
+syij[k])
(37b)
vi[k + 1] =

jâˆˆN âˆ’
i [k]âˆª{i}
(vij[k + 1] âˆ’vij[k])
(37c)
xi[k + 1] = Î»i[k + 1]
vi[k + 1]
(37d)
yi[k + 1] =

jâˆˆN âˆ’
i [k]âˆª{i}
(yij[k + 1] âˆ’yij[k])
+ Ë†n(pi[k + 1] âˆ’pi[k])
(37e)
where Î»ij[k], vij[k], and yij[k] are updated using the running
sums received by agent i from agent j, and given by
Î»ij[k + 1] =
â§
âª
âª
â¨
âª
âª
â©
(1 âˆ’Î³)Î»ij[k] + Î³ k
t=0
Î»j[t]
d+
j ,
if j âˆˆN âˆ’
i [k]
Î»ij[k] + Î»j[k]
d+
j ,
if j = i
Î»ij[k],
otherwise
(38a)
vij[k + 1] =
â§
âª
âª
â¨
âª
âª
â©
(1 âˆ’Î³)vij[k] + Î³ k
t=0
vj[t]
d+
j ,
if j âˆˆN âˆ’
i [k]
vij[k] + vj[k]
d+
j ,
if j = i
vij[k],
otherwise
(38b)
yij[k + 1] =
â§
âª
âª
â¨
âª
âª
â©
(1 âˆ’Î³)yij[k] + Î³ k
t=0
yj[t]
d+
j ,
if j âˆˆN âˆ’
i [k]
yij[k] + yj[k]
d+
j ,
if j = i
yij[k],
otherwise
(38c)
where 0 < Î³ < 1.


---

Page 10

---

1032
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
Remark 3: Algorithm (37)â€“(38) relies on Assumption 6,
which can be further relaxed by replacing the running-sum ratio
consensus algorithm with its modiï¬cation in [14, Algorithm 2]
for handling imprecise knowledge of the nominal out-degrees.
However, the convergence analysis of the resulting distributed
approach is nontrivial and left for future work.
F. Feedback Representation of the Robust Distributed
Primalâ€“Dual Algorithm in Virtual Domain
To facilitate the understanding of algorithm (37)â€“(38), we
represent it as a feedback interconnection of a nominal system,
denoted by âƒ—Hr
1, and a disturbance system, denoted by âƒ—Hr
2. How-
ever, unlike the previously described feedback representations,
this representation will be given in the virtual domain using the
virtual agents and links. Moreover, we show that while executing
algorithm (37)â€“(38), the actual agents, essentially, execute (31)
over a virtual network augmented with the virtual agents and
links.
Consider a set of virtual agents denoted by S = {n +
1, . . . , n + |E(0)|}, where the virtual agents correspond to the
edges in E(0) through a one-to-one map I such that I(j, i) âˆˆS
for (j, i) âˆˆE(0). Consider neighboring agents i and j, i.e.,
(j, i) âˆˆE(0), and a virtual agent l âˆˆS corresponding to the
link from j to i, i.e., I(j, i) = l. Let 
N âˆ’
l [k] denote the set of
in-neighbors of agent l at instant k given by 
N âˆ’
l [k] = {j}, âˆ€k,
implying that agent l always receives a packet from agent j. Let

N âˆ’
i [k] denote the augmented set of in-neighbors of agent i âˆˆV
at instant k given by

N âˆ’
i [k] = N âˆ’
i [k] âˆª{a âˆˆS : a = I(j, i), j âˆˆN âˆ’
i [k]}
(39)
which contains the set of in-neighbors N âˆ’
i [k] and the set of
virtual agents, from which agent i receives a packet at instant k.
Note that the deï¬nition of 
N âˆ’
i [k] in (39) implies that agent i
receives a packet from agent l at instant k if agent i receives a
packet from agent j at instant k.
If we let agent l âˆˆS execute the following iterations:
Î»l[k + 1] =
â§
â¨
â©
Î»l[k] + Î»j[k]
d+
j ,
j /âˆˆ
N âˆ’
i [k]
(1 âˆ’Î³)Î»l[k] + (1 âˆ’Î³) Î»j[k]
d+
j ,
otherwise
(40a)
vl[k + 1] =
â§
â¨
â©
vl[k] + vj[k]
d+
j ,
j /âˆˆ
N âˆ’
i [k]
(1 âˆ’Î³)vl[k] + (1 âˆ’Î³) vj[k]
d+
j ,
otherwise
(40b)
yl[k + 1] =
â§
â¨
â©
yl[k] + yj[k]
d+
j ,
j /âˆˆ
N âˆ’
i [k]
(1 âˆ’Î³)yl[k] + (1 âˆ’Î³) yj[k]
d+
j ,
otherwise
(40c)
where Î»l[0] = 0, vl[0] = 0, and yl[0] = 0, then, it is not difï¬cult
to see that the agent iâ€™s updates in (37) are equivalent to the
following iterations in the virtual domain:
pi[k + 1] = [pi[k] âˆ’sf â€²
i(pi[k]) + sÎ¾xi[k]]pi
pi
(41a)
Î»i[k + 1] = Î»i[k] âˆ’syi[k]
d+
i
+

aâˆˆ
N âˆ’
i [k]
Î³ Î»a[k] âˆ’sya[k]
d+
a
(41b)
vi[k + 1] = vi[k]
d+
i
+

aâˆˆ
N âˆ’
i [k]
Î³ va[k]
d+
a
(41c)
xi[k + 1] = Î»i[k + 1]
vi[k + 1]
(41d)
yi[k + 1] = yi[k]
d+
i
+

aâˆˆ
N âˆ’
i [k]
Î³ ya[k]
d+
a
+ Ë†n(pi[k + 1] âˆ’pi[k])
(41e)
where d+
a := 1, a âˆˆS. Note that the information sent by the
virtual agents is treated by agent i the same way as the infor-
mation sent by the real agents, and that the iterations in (41)
are, in essence, similar to those in (31); i.e., while executing
algorithm (37)â€“(38), the actual agents execute (31) over a virtual
network augmented with the virtual agents and links. Now, we
deï¬ne N := n + |E(0)|, and ËœP[k] âˆˆRNÃ—N such that
ËœPij[k] :=
â§
âª
âª
âª
âª
â¨
âª
âª
âª
âª
â©
Î³
d+
j ,
if i âˆˆV, j âˆˆ
N âˆ’
i [k]
1âˆ’Î³
d+
j ,
if i âˆˆS, I(j, l) = i, j âˆˆ
N âˆ’
l [k]
1
d+
j ,
if i âˆˆS, I(j, l) = i, j /âˆˆ
N âˆ’
l [k]
0,
else
ËœPii[k] :=
â§
âª
âª
â¨
âª
âª
â©
1
d+
i ,
if i âˆˆV
1âˆ’Î³
d+
i ,
if i âˆˆS, I(j, l) = i, j âˆˆ
N âˆ’
l [k]
1
d+
i ,
if i âˆˆS, I(j, l) = i, j /âˆˆ
N âˆ’
l [k].
Here, ËœP[k] denotes the one-step state transition matrix at time
k, and determines the values of Î»[k], v[k], and y[k] at the next
iteration, e.g., v[k + 1] = ËœP[k]v[k]. Note that ËœP[k] is column
stochastic. Furthermore, for i = 1, . . . , N, we have that
ËœPij[k] â‰¥min(Î³, 1 âˆ’Î³) min
jâˆˆVâˆªS
1
d+
j
â‰¥min(Î³, 1 âˆ’Î³)/n := Ï„, j âˆˆ
N âˆ’
i [k] âˆª{i} âˆ€k (42)
where we used the fact that d+
j â‰¤n, âˆ€j. This, in particular,
implies that all diagonal entries in ËœP[k] are always strictly
positive. For further development, we establish the following
result using the analysis from the proof of [15, Lemma 4].
However, there are some subtle differences due to the fact that
vi[0] = 0, for i âˆˆS. We recall that vi[0] = 1, for i âˆˆV.
Lemma 3: For i = 1, 2, . . . , N, we have that
vi[k] â‰¥1 âˆ’Î³
n
Ï„ N(2Bâˆ’1)
âˆ€k â‰¥1.
(43)
Proof: Since ËœPii[k] = 1/d+
i , âˆ€i âˆˆV, and d+
i â‰¤n, we have
that ËœPii[k] â‰¥1/n, âˆ€i âˆˆV and k â‰¥0. Hence
( ËœP[k + 1] . . . ËœP[0])ii â‰¥1
n( ËœP[k] . . . ËœP[0])ii


---

Page 11

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1033
for i = 1, . . . , n. Because Ï„ < 1/n, it becomes clear that when
1 â‰¤k â‰¤N(2B âˆ’1)
( ËœP[k âˆ’1] . . . ËœP[0]v[0])i â‰¥ËœPii[k âˆ’1] . . . ËœPii[0]
â‰¥1/nN(2Bâˆ’1) > Ï„ N(2Bâˆ’1)
(44)
for all i âˆˆV, where v[t] := [v1[t], v2[t], . . . , vN[t]]âŠ¤. We recall
that, by (42), we have that ËœPij[k] â‰¥Ï„, i = 1, . . . , N, âˆ€j âˆˆ

N âˆ’
i [k] âˆª{i}, âˆ€k. Then, as shown in [32, Lemma 2], for t â‰¥
(N âˆ’1)(2B âˆ’1), we have that
( ËœP[t âˆ’1] . . . ËœP[0])ij â‰¥Ï„ (Nâˆ’1)(2Bâˆ’1)
âˆ€i, j.
(45)
By combining (44) and (45) and using the fact that vi[0] = 1,
for i = 1, . . . , n, we ï¬nd that
vi[k + 1] = ( ËœP[k] . . . ËœP[0]v[0])i â‰¥Ï„ N(2Bâˆ’1)
âˆ€k â‰¥0. (46)
Now, consider a virtual agent l âˆˆS such that I(i, j) = l for
some i, j âˆˆV. Noticing that i âˆˆ
N âˆ’
l [k], âˆ€k â‰¥0, and d+
i â‰¤n,
for l = n + 1, . . . , N, we have from (40b) that
vl[k + 1] â‰¥1 âˆ’Î³
d+
i
vi[k] â‰¥1 âˆ’Î³
n
Ï„ N(2Bâˆ’1)
âˆ€k â‰¥0.
(47)
Combining (46) and (47) yields (43).
â– 
Next, we deï¬ne additional virtual variables maintained by the
virtual agents. For i âˆˆS, we deï¬ne
xi[k] :=
 Î»i[k]
vi[k],
if k > 0
0,
if k = 0.
We let pi[k] denote the iterate for the produced power at
the virtual agent i âˆˆS at instant k, fi(pi) := mp2
i denote the
cost function, pi = pi = 0 denote the capacity constraints, and
â„“i = 0 denote the consumed power. Since pi = pi = 0, we have
that pi[k] = 0, for all k â‰¥0. Since pi[k] = 0, âˆ€k, and â„“i = 0,
these virtual variables do not have any effect on the solution of
the considered problem, and are only needed for describing the
feedback system.
Next, we let
x[k] = [x1[k], x2[k], . . . , xN[k]]âŠ¤
Î»[k] = [Î»1[k], Î»2[k], . . . , Î»N[k]]âŠ¤
y[k] = [y1[k], y2[k], . . . , yN[k]]âŠ¤
p[k] = [p1[k], p2[k], . . . , pN[k]]âŠ¤
â„“= [â„“1, â„“2, . . . , â„“N]âŠ¤
f(p[k]) = [f1(p1[k]), f2(p2[k]), . . . , fN(pN[k])]âŠ¤
p = [p1, . . . , pN]âŠ¤, p = [p1, . . . , pN]âŠ¤
v[k] = [v1[k], v2[k], . . . , vn[k]]âŠ¤
V [k] := diag(v[k]), ËœV [k] := diag(v[k]).
Noticing that, by Lemma 3, ËœV [k] is invertible for all k â‰¥1, we
deï¬ne
h[k] :=
â§
âª
â¨
âª
â©
( ËœV [k])âˆ’1y[k]
if k > 0

(V [k])âˆ’1y[k]
0Nâˆ’n

if k = 0
(48)
where y[k] = [y1[k], y2[k], . . . , yn[k]]âŠ¤. [Instead of deï¬ning
h[k] as ( ËœV [k])âˆ’1y[k], we adopt the deï¬nition in (48), be-
cause ËœV [k] is not invertible at k = 0.] Let ËœR[k] := ( ËœV [k +
1])âˆ’1 ËœP[k] ËœV [k],In denotethen Ã— nidentitymatrix,0aÃ—b denote
the a Ã— b all-zeros matrix, and
ËœI =

In
0nÃ—(Nâˆ’n)
0(Nâˆ’n)Ã—n
0(Nâˆ’n)Ã—(Nâˆ’n)

.
Let x[k] := 1âŠ¤x[k]/N, Ëœx[k] = x[k] âˆ’1x[k], and Ë†x[k] :=
1âŠ¤x[k]/Ë†n. Then, by substituting (Ë†n/N)Ë†x[k] + Ëœx[k] for x[k],
ËœV [k]x[k] for Î»[k] and ( ËœV [k + 1])âˆ’1 ËœP[k] ËœV [k] for ËœR[k], and by
using (40)â€“(41) and (48), we obtain that
p[k + 1] =

p[k] âˆ’sâˆ‡f(p[k]) + sÎ¾ Ë†n
N Ë†x[k]1 + sÎ¾Ëœx[k]
p
p
(49a)
x[k + 1] = ( ËœV [k + 1])âˆ’1 
ËœP[k] ËœV [k]x[k] âˆ’sËœI ËœP[k]y[k]

= ( ËœV [k + 1])âˆ’1 ËœP[k] ËœV [k]x[k]
âˆ’sËœI( ËœV [k + 1])âˆ’1 ËœP[k]y[k]
= ( ËœV [k + 1])âˆ’1 ËœP[k] ËœV [k]x[k]
âˆ’sËœI( ËœV [k + 1])âˆ’1 ËœP[k] ËœV [k]h[k]
= ËœR[k]x[k] âˆ’sËœI ËœR[k]h[k]
(49b)
h[k + 1] = ( ËœV [k + 1])âˆ’1y[k + 1]
= ( ËœV [k + 1])âˆ’1 
ËœP[k]y[k] + Ë†n(p[k + 1] âˆ’p[k])

= ( ËœV [k+1])âˆ’1 
ËœP[k] ËœV [k]h[k]+Ë†n(p[k + 1]âˆ’p[k])

= ËœR[k]h[k] + Ë†n( ËœV [k + 1])âˆ’1(p[k + 1] âˆ’p[k]).
(49c)
Let
h[k] := 1âŠ¤y[k]
1âŠ¤v[k] = Ë†n
n1âŠ¤(p[k] âˆ’â„“).
(50)
Since ËœR[k] is row-stochastic [19], the following relations hold:
Ë†x[k] = 1
Ë†n1âŠ¤x[k] = 1
Ë†n1âŠ¤ËœR[k]1x[k]
(51)
h[k] = 1
n1âŠ¤ËœI ËœR[k]1h[k].
(52)
By using (50), (51), and (52), we ï¬nd from (49b) that
Ë†x[k + 1] = 1
Ë†n1âŠ¤x[k + 1] = 1
Ë†n1âŠ¤ËœR[k]x[k] âˆ’s 1
Ë†n1âŠ¤ËœI ËœR[k]h[k]
= Ë†x[k] âˆ’s1âŠ¤(p[k] âˆ’â„“) +
 1
Ë†n1âŠ¤ËœR[k]x[k] âˆ’Ë†x[k]

âˆ’s
 1
Ë†n1âŠ¤ËœI ËœR[k]h[k] âˆ’n
Ë†nh[k]

= Ë†x[k] âˆ’s1âŠ¤(p[k] âˆ’â„“) + 1
Ë†n1âŠ¤ËœR[k] (x[k] âˆ’1x[k])


---

Page 12

---

1034
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
âˆ’s 1
Ë†n1âŠ¤ËœI ËœR[k]

h[k] âˆ’1h[k]
 
= Ë†x[k] âˆ’s1âŠ¤(p[k] âˆ’â„“) + 1
Ë†n1âŠ¤ËœR[k]Ëœx[k]
âˆ’s 1
Ë†n1âŠ¤ËœI ËœR[k]Ëœh[k],
(53)
where Ëœh[k] := h[k] âˆ’1h[k]. Then, we use (49a) and (53) to
determine the nominal system, âƒ—Hr
1, as follows:
âƒ—Hr
1 :
â§
âª
âª
âª
âª
âª
âª
âª
â¨
âª
âª
âª
âª
âª
âª
âª
â©
p[k + 1] =
!
p[k] âˆ’sâˆ‡f(p[k])
+sÎ¾ Ë†n
N Ë†x[k]1 + sÎ¾Ëœx[k]
"p
p
(54a)
Ë†x[k + 1] = Ë†x[k] âˆ’s1âŠ¤(p[k] âˆ’â„“)
+ 1
Ë†n1âŠ¤ËœR[k]Ëœx[k]
âˆ’s 1
Ë†n1âŠ¤ËœI ËœR[k]Ëœh[k].
(54b)
Now, we use (49b) and (49c) to determine the disturbance
system, âƒ—H2, as follows:
âƒ—Hr
2 :
â§
âª
âª
âª
â¨
âª
âª
âª
â©
h[k] = ËœR[k âˆ’1]h[k âˆ’1]
+Ë†n( ËœV [k])âˆ’1(p[k] âˆ’p[k âˆ’1])
(55a)
x[k + 1] = ËœR[k]x[k] âˆ’sËœI ËœR[k]h[k]
(55b)
e[k] = [Ëœx[k]âŠ¤, sËœh[k]âŠ¤]âŠ¤.
(55c)
Then, algorithm (37)â€“(38) can be viewed as a feedback intercon-
nection of âƒ—Hr
1 and âƒ—Hr
2, where (pâˆ—, xâˆ—) is the equilibrium of (5)
when e[k] â‰¡0, âˆ€k.
G. Convergence Analysis
To establish the convergence results for algorithm (37)â€“(38),
we show that âƒ—Hr
1 and âƒ—Hr
2 are ï¬nite-gain stable. This allows us to
apply the small-gain theorem to prove that algorithm (37)â€“(38)
converges to an optimal solution geometrically fast.
For our analysis, we need the following result, where we recall
that ËœR[k] = ( ËœV [k + 1])âˆ’1 ËœP[k] ËœV [k]; its proof can be found in the
Appendix.
Lemma 4: For i = 1, . . . , N, we have that
ËœRij[k] â‰¥1 âˆ’Î³
n2 Ï„ N(2Bâˆ’1)+1
âˆ€j âˆˆ
N âˆ’
i [k] âˆª{i}, k â‰¥1.
(56)
The proof of the next result, where we show that âƒ—Hr
1 is
ï¬nite-gain stable, is omitted because it is identical to that of
Proposition 1. The value of the parameter s is found using the
same expressions in (9)â€“(14) by substituting N for n, and using
a different value for Ïˆ given by
Ïˆ := max

1âŠ¤(â„“âˆ’p), 1âŠ¤(p âˆ’â„“)
 
/

Î¾Ë†n + MN/Ë†n.
(57)
Proposition 4: Let Assumptions 1 and 2 hold. Then, un-
der (5), we have that
R1. âˆ¥zâˆ¥a,K
2
â‰¤Î±1âˆ¥eâˆ¥a,K
2
+ Î²1
for
some
positive
Î±1
and
Î²1,
a âˆˆ(0, 1),
âˆ€s âˆˆ
(0, min(s, 1/âˆšÎ¾Ë†n)), and âˆ€Î¾ > 0, where
z[k] :=
p[k] âˆ’pâˆ—
Ë†x[k] âˆ’xâˆ—

.
In the next result, we show that âƒ—Hr
2 is ï¬nite-gain stable.
Proposition 5: Let Assumptions 4, 5, and 6 hold. Then,
under (55), we have that
R2. âˆ¥eâˆ¥a,K
2
â‰¤sÎ±2âˆ¥zâˆ¥a,K
2
+ Î²2
(58)
for some positive Î±2 and Î²2, a âˆˆ(0, 1).
Proof: Letting Î´[k + 1] := Ë†n(p[k + 1] âˆ’p[k]), and using
the triangle inequality, we obtain that
âˆ¥Î´[k + 1]âˆ¥2 = Ë†nâˆ¥p[k + 1] âˆ’pâˆ—âˆ’p[k] + pâˆ—âˆ¥2
â‰¤Ë†n(âˆ¥p[k + 1] âˆ’pâˆ—âˆ¥2 + âˆ¥p[k] âˆ’pâˆ—âˆ¥2)
â‰¤Ë†n(âˆ¥z[k + 1]âˆ¥2 + âˆ¥z[k]âˆ¥2).
(59)
Then, by taking max0â‰¤kâ‰¤K(Â·) on both sides of (59), we obtain
max
0â‰¤kâ‰¤K âˆ¥Î´[k + 1]âˆ¥2 â‰¤Ë†n

max
0â‰¤kâ‰¤K âˆ¥z[k + 1]âˆ¥2
+ max
0â‰¤kâ‰¤K âˆ¥z[k]âˆ¥2

â‰¤2Ë†n
max
0â‰¤kâ‰¤K+1 âˆ¥z[k]âˆ¥2.
(60)
Since
max0â‰¤kâ‰¤K âˆ¥Î´[k + 1]âˆ¥2 â‰¥max0â‰¤kâ‰¤K+1 âˆ¥Î´[k]âˆ¥2 âˆ’
âˆ¥Î´[0]âˆ¥2, it follows from (60) that
âˆ¥Î´âˆ¥a,K
2
â‰¤2Ë†nâˆ¥zâˆ¥a,K
2
+ âˆ¥Î´[0]âˆ¥2.
(61)
Recall that e[k] = [Ëœx[k]âŠ¤, sËœh[k]âŠ¤]âŠ¤; then, by using the fact that
âˆš
a2 + b2 â‰¤a + b, âˆ€a, b âˆˆR+, we have that
âˆ¥e[k]âˆ¥2 â‰¤âˆ¥Ëœx[k]âˆ¥2 + sâˆ¥Ëœh[k]âˆ¥2.
(62)
By using (42) and the result in Lemma 4, the following lemmata
can be established by borrowing much of the analysis from the
proofs of [19, Lemmas 15â€“16].
Lemma 5:
âˆ¥Ëœhâˆ¥a,K
2
â‰¤Î³1âˆ¥Î´âˆ¥a,K
2
+ Î³2
(63)
for some positive constants Î³1 and Î³2.
Lemma 6:
âˆ¥Ëœxâˆ¥a,K
2
â‰¤sÎ³3âˆ¥Ëœhâˆ¥a,K
2
+ Î³4
(64)
for some positive constants Î³3 and Î³4.
By using (64), (63), and (61) in (62), we obtain
âˆ¥eâˆ¥a,K
2
â‰¤âˆ¥Ëœxâˆ¥a,K
2
+ sâˆ¥Ëœhâˆ¥a,K
2
â‰¤s(1 + Î³3)âˆ¥Ëœhâˆ¥a,K
2
+ Î³4
â‰¤sÎ³1(1 + Î³3)âˆ¥Î´âˆ¥a,K
2
+ sÎ³2(1 + Î³3) + Î³4
â‰¤2sÎ³1(1 + Î³3)Ë†nâˆ¥zâˆ¥a,K
2
+ sÎ³2(1 + Î³3) + Î³4
+ sÎ³1(1 + Î³3)âˆ¥Î´[0]âˆ¥2,
which can be rewritten as
âˆ¥eâˆ¥a,K
2
â‰¤sÎ±2âˆ¥zâˆ¥a,K
2
+ Î²2
where
Î±2 = 2Î³1(1 + Î³3)Ë†n,
and
Î²2 = sÎ³2(1 + Î³3) + Î³4 +
sÎ³1(1 + Î³3)âˆ¥Î´[0]âˆ¥2, yielding (58).
â– 
In the following, we state the convergence results for algo-
rithm (37)â€“(38), which can be shown by applying the small-gain
theorem to the results in Propositions 4â€“5, similar to the analysis
in the proof of Proposition 3.


---

Page 13

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1035
Proposition 6: Let Assumptions 1, 2, 4, 5, and 6 hold. Then,
under algorithm (37)â€“(38)
âˆ¥zâˆ¥a,K
2
â‰¤Î²
for some Î² > 0, a âˆˆ(0, 1), âˆ€s âˆˆ(0, min(s, 1/âˆšÎ¾Ë†n, 1/(Î±1
Î±2))), and âˆ€Î¾ > 0. In particular, (pi[k], xi[k]) converges to
(pâˆ—
i, xâˆ—), i = 1, . . . , n, at a geometric rate O(ak).
Finally, in the following, we establish that pâˆ—:= [pâˆ—
1, . . . , pâˆ—
n]
is the solution of (1). [The proof is similar to the proof of
Lemma 1.]
Lemma 7: Consider (pâˆ—, xâˆ—), namely, the equilibrium of the
nominal system âƒ—Hr
1 with e[k] â‰¡0, âˆ€k. Then, pâˆ—is the solution
of (1).
V. NUMERICAL SIMULATIONS
In this section, we present numerical results that illustrate the
performance of the proposed algorithms using the IEEE 39-bus
test system [34].
We randomly pick the load demands and generation capacity
constraints of the DERs. For each i, we choose fi(pi) = aip2
i ,
where ai > 0 is randomly selected.
A. Time-Varying Undirected Communication Graphs
First, we illustrate the performance of the proposed algo-
rithm (6) over time-varying undirected communication graphs.
In the communication model, every pair of agents is connected
by a bidirectional communication link if there is an electrical
line between their respective DERs. Communication links are
assumed to fail with probability 0.2 independently (and inde-
pendently between different time steps). The weights aij[k],
{i, j} âˆˆE(0), are picked using the Metropolis rule [35], namely
aij[k] =

1
max(di,dj),
{i, j} âˆˆE(c)[k]
0,
otherwise.
For convenience, algorithm (6) is referred to as PD1. We
compare its performance with that of algorithm (1), referred
to as PD2. We run PD1 using a constant stepsize s = 0.01,
Î¾ = 0.06, and different values for Ë†n, namely, Ë†n = 10 and Ë†n =
30. We execute PD2 using a constant stepsize s = 0.01, and,
also, using a diminishing stepsize of the form s[k] = a/(k + b),
where a > 0 and b > 0, with Î¾ = 0.06 and Ë†n = 30. Both al-
gorithms are initialized with p[0] = 0. In Fig. 2, we provide
the convergence error, namely, the Euclidean distance between
the exact and iterative solutions, âˆ¥p[k] âˆ’pâˆ—âˆ¥2, for both algo-
rithms. It can be seen that PD1 signiï¬cantly outperforms PD2
when Ë†n = 30 is used and has geometric convergence speed.
We also note that using Ë†n = 10 yields signiï¬cantly slower
performance than when Ë†n = 30 is used. This further implies
that if the power network size tends to vary substantially over
time, e.g., due to the connection of new DERs, it needs to be
estimated on a regular basis to maintain fast performance of
PD1.
B. Time-Varying Directed Communication Graphs
Next, we illustrate the performance of the proposed al-
gorithm (37)â€“(38) over time-varying directed communication
graphs. In the communication model, every pair of agents are
connected by a single or two opposite unidirectional communi-
cation links if there is an electrical line between their respective
Fig. 2.
Trajectories of âˆ¥p[k] âˆ’pâˆ—âˆ¥2 for algorithms PD1, PD2.
Fig. 3.
Trajectories of âˆ¥p[k] âˆ’pâˆ—âˆ¥2 for algorithms A1â€“A4.
DERs. We assign the orientations of the communication links
such that the nominal communication graph G(0) is strongly
connected. Communication links fail with probability 0.2 in-
dependently (and independently between different time steps).
We also assume that out-degrees, D+
i [k], are unknown to DER
agents.
We compare the performance of algorithm (37)â€“(38), for
convenience referred to as A1, against that of the distributed
algorithms proposed in [3], [7], and [11], referred to as A2, A3,
and A4, respectively. Algorithms A1 and A2 use a constant
stepsize s. In contrast, A3 and A4 need to use a diminishing
stepsize in order to guarantee convergence. However, if the
stepsize is constant and sufï¬ciently small, A3 and A4 can still
achieve convergence within a small error. We run A1 using
Î³ = 0.9, s = 0.02, Î¾ = 0.2, and different values for Ë†n, namely,
Ë†n = 5 and Ë†n = 30. We executed A3 using different diminishing
stepsizes of the form s[k] = a/(k + b), where a > 0 and b > 0.
We run A4 using the following parameter values: (Î±k, Î²k) =
(0.003, 0.3) and (Î±k, Î²k) = ( 0.08
k0.85 ,
0.2
k0.001 ), which are also used
in the numerical simulations in [3].
In Fig. 3, we provide the convergence error, namely, the
Euclidean distance between the exact and iterative solutions,


---

Page 14

---

1036
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
âˆ¥p[k] âˆ’pâˆ—âˆ¥2, for all algorithms. Effects of unreliable com-
munication can be observed in Fig. 3; in particular, A2 fails
to converge because time-varying out-degrees, D+
i [k], are un-
known to DER agents, whereas A3 and A4 exhibit very slow
performance. By contrast, A1 manages to ï¬nd an optimal
solution with high accuracy, when Ë†n = 30 is used, and has
geometric convergence speed despite the effects of unreliable
communication. We note that using Ë†n = 5 results in noticeably
slower performance. Similar to the undirected case, it can then
be inferred that the power network size must be regularly es-
timated if it can vary substantially over time in order to main-
tain fast performance of A1. Through numerical simulations,
we also observed that it is in general difï¬cult to choose the
right values for a and b in order for A3 to operate well. In
fact, if the ratio a/b is large, A3 might exhibit oscillatory
behavior. But setting a/b to a small value results in a slow
convergence.
Numerical results shown in Figs. 2 and 3 demonstrate that the
error between exact and computed solutions becomes negligibly
small after 2000 iterations. Therefore, when we dispatch com-
puted DER setpoints, namely, the amount of power each DER
needs to produce, the error will have a negligible impact on the
operation of the considered power system.
VI. CONCLUSION
We presented distributed algorithms for solving the DER
coordination problem over time-varying communication graphs.
The algorithms have a geometric convergence rate. One im-
portant future direction is to extend the proposed algorithms to
solve more complex DER coordination problems with additional
constraints, e.g., line ï¬‚ow constraints, voltage constraints, or re-
active power balance constraints. Another interesting endeavor
for future work is to leverage the methods based on the notion
of Integral Quadratic Constraints (see, e.g., [36]) for reï¬ning the
convergence results or even redesigning some of the proposed
algorithms.
APPENDIX
A. Proof of Lemma 1
Proof: At the equilibrium, we have that
pâˆ—= [pâˆ—âˆ’sâˆ‡f(pâˆ—) + sÎ¾(Ë†n/n)1Î»âˆ—]p
p
Î»âˆ—= Î»âˆ—âˆ’s1âŠ¤(pâˆ—âˆ’â„“).
Then, the following relations hold:
0 = âˆ‡f(pâˆ—) âˆ’Î¾(Ë†n/n)1Î»âˆ—+ Î¼âˆ—âˆ’Î½âˆ—
(65a)
0 = 1âŠ¤(pâˆ—âˆ’â„“)
(65b)
0 = Î¼âˆ—
i(pâˆ—
i âˆ’pi)
(65c)
0 = Î½âˆ—
i (pi âˆ’pâˆ—
i), i = 1, . . . , n
(65d)
where Î¼âˆ—= [Î¼âˆ—
1, . . . , Î¼âˆ—
n]âŠ¤, with Î¼âˆ—
i â‰¥0, i = 1, . . . , n, and Î½âˆ—=
[Î½âˆ—
1, . . . , Î½âˆ—
n]âŠ¤, with Î½âˆ—
i â‰¥0, i = 1, . . . , n. Noticing that (65)
represents the Karushâ€“Kuhnâ€“Tucker (KKT) conditions for (1),
it follows from [25, Prop. 3.3.1] that pâˆ—is the solution of (1).â– 
B. Proof of Lemma 2
Proof: For our analysis, we need the results in the following
lemmas.
Lemma 8: Let v, w, v, v âˆˆR, where v â‰¤v, and deï¬ne Î”v :=
v âˆ’[v]v
v and Î”w := w âˆ’[w]v
v. Then, we have that
(Î”v âˆ’Î”w)([v]v
v âˆ’[w]v
v) â‰¥0.
(66)
Proof: Suppose[v]v
v > [w]v
v,then,itfollowsthatÎ”v â‰¥0,and
Î”w â‰¤0. Hence, Î”v âˆ’Î”w â‰¥0, and the result (66) holds.
â– 
Lemma 9: The following relation holds:
min(pi âˆ’pâˆ—
i, pâˆ—
i âˆ’pi) â‰¥Î¶i|Î”Ï•i[k] âˆ’Î”Ï•âˆ—
i|, i = 1, 2, . . . , n
(67)
for any s such that 0 < s â‰¤1/âˆšÎ¾Ë†n, and all k â‰¥0.
Proof: Note that if pâˆ—
i = pi or pâˆ—
i = pi, then, Î¶i = 0, and the
result (67) holds trivially. Suppose pi < pâˆ—
i < pi. We ï¬rst show
that Ë†Î»[k] is always bounded. We recall that Ïˆ := max(1âŠ¤(â„“âˆ’
p), 1âŠ¤(p âˆ’â„“))/âˆšÎ¾Ë†n and deï¬ne
Î»min :=
n
sÎ¾Ë†n

min
iâˆˆV

pi âˆ’pi + sf â€²
i(pi)

âˆ’sÎ¾M

Î»max :=
n
sÎ¾Ë†n

max
iâˆˆV

pi âˆ’pi + sf â€²
i(pi)

+ sÎ¾M

.
We show by contradiction that
Î»min âˆ’2Ïˆ â‰¤Ë†Î»[k] â‰¤Î»max + 2Ïˆ
âˆ€k.
(68)
Suppose Ë†Î»[k0] > Î»max + 2Ïˆ for some k0 > 0. Since
|Ë†Î»[k + 1] âˆ’Ë†Î»[k]| â‰¤Ïˆ
âˆ€k
there exists t â‰¥0 such that
Ë†Î»[t] âˆˆ[Î»max, Î»max + Ïˆ] .
Then, by using (7a) and the fact that âˆ¥e[k]âˆ¥2 â‰¤M, we have that
pj[t + 1] = pj, j = 1, 2, . . . , n, and
Ë†Î»[t + 1] â‰¤Ë†Î»[t] + Ïˆ â‰¤Î»max + 2Ïˆ.
In the next iterations, for Ï„ â‰¥t + 1, we have that pj[Ï„] = pj,
j = 1, 2, . . . , n, as long as Ë†Î»[Ï„] â‰¥Î»max, and that
Ë†Î»[Ï„ + 1] = Ë†Î»[Ï„] âˆ’s1âŠ¤(p âˆ’â„“) < Ë†Î»[Ï„].
Hence,
Ë†Î»[k] â‰¤Î»max + 2Ïˆ
âˆ€k.
Similarly, it can be shown that
Ë†Î»[k] â‰¥Î»min âˆ’2Ïˆ
âˆ€k.
Therefore, the result (68) holds. Next, we show that |Î”Ï•i[k] âˆ’
Î”Ï•âˆ—
i| â‰¤Î”Ï•max
i
. Since pi < pâˆ—
i < pi, and (pâˆ—, Î»âˆ—) is the equilib-
rium of (7) when e[k] â‰¡0, for all k â‰¥0, it follows that Î”Ï•âˆ—
i = 0.
By using (17), and the facts that pi[k], Ë†Î»[k], and ei[k] are always
bounded and s â‰¤1/âˆšÎ¾Ë†n, it is straightforward to derive the
upper bound Î”Ï•max
i
, which is given by
Î”Ï•max
i
:= max

max
jâˆˆV

pj âˆ’pj + f â€²
j(pj)/

Î¾Ë†n



---

Page 15

---

ZHOLBARYSSOV et al.: FAST COORDINATION OF DISTRIBUTED ENERGY RESOURCES OVER TIME-VARYING COMMUNICATION NETWORKS
1037
+ 2

Î¾Ë†n/nÏˆ âˆ’f â€²
i(pi)/

Î¾Ë†n + 2M

Î¾/Ë†n,
f â€²
i(pi)/

Î¾Ë†n + 2M

Î¾/Ë†n + 2

Î¾Ë†n/nÏˆ
âˆ’min
jâˆˆV

pj âˆ’pj + f â€²
j(pj)/

Î¾Ë†n
 
.
Then, by using the deï¬nition of Î¶i in (10), we obtain (67).
â– 
It follows from Lemma 8 that, for i = 1, 2, . . . , n
(Î”Ï•i[k] âˆ’Î”Ï•âˆ—
i)([Ï•i[k] + Ïµi[k]]pi
pi âˆ’[Ï•âˆ—
i]pi
pi) â‰¥0.
(69)
Moreover, by Lemma 9, we have that
(Î”Ï•i[k] âˆ’Î”Ï•âˆ—
i)([Ï•i[k] + Ïµi[k]]pi
pi âˆ’[Ï•âˆ—
i]pi
pi)
â‰¥Î¶i(Î”Ï•i[k] âˆ’Î”Ï•âˆ—
i)2, i = 1, 2, . . . , n.
(70)
Then, we obtain that


Ï•[k] + Ïµ[k] âˆ’Ï•âˆ—
Ë†Î»[k + 1] âˆ’Î»âˆ—

2
P +T
=


[Ï•[k] + Ïµ[k]]p
p âˆ’[Ï•âˆ—]p
p
Ë†Î»[k + 1] âˆ’Î»âˆ—

2
P
âˆ’2sa1Î¾ Ë†n
n(Î”Ï•[k] âˆ’Î”Ï•âˆ—)âŠ¤1(Ë†Î»[k + 1] âˆ’Î»âˆ—)
+ 2a1(1 + s2)(Î”Ï•[k] âˆ’Î”Ï•âˆ—)âŠ¤([Ï•[k] + Ïµ[k]]p
p âˆ’[Ï•âˆ—]p
p)
+ a1(1 + s2) âˆ¥Î”Ï•[k] âˆ’Î”Ï•âˆ—âˆ¥2
2 + Î´(Ë†Î»[k + 1] âˆ’Î»âˆ—)2
+ a1 s2[Ï•[k] + Ïµ[k]]p
p âˆ’[Ï•âˆ—]p
p
2
2
â‰¥


[Ï•[k] + Ïµ[k]]p
p âˆ’[Ï•âˆ—]p
p
Ë†Î»[k + 1] âˆ’Î»âˆ—

2
P
âˆ’2sa1Î¾ Ë†n
n(Î”Ï•[k] âˆ’Î”Ï•âˆ—)âŠ¤1(Ë†Î»[k + 1] âˆ’Î»âˆ—)
+ 2a1
n

i=1
Î¶i(Î”Ï•i[k] âˆ’Î”Ï•âˆ—
i)2
+ a1(1 + s2) âˆ¥Î”Ï•[k] âˆ’Î”Ï•âˆ—âˆ¥2
2 + Î´(Ë†Î»[k + 1] âˆ’Î»âˆ—)2 (71)
=


[Ï•[k] + Ïµ[k]]p
p âˆ’[Ï•âˆ—]p
p
Ë†Î»[k + 1] âˆ’Î»âˆ—

2
P
+
n

i=1


a1(1 + s2 + 2Î¶i)(Î”Ï•i[k] âˆ’Î”Ï•âˆ—
i)
âˆ’
#
a1 s2
1 + s2 + 2Î¶i
Î¾ Ë†n
n(Ë†Î»i[k + 1] âˆ’Î»âˆ—
i)
2
(72)
â‰¥


[Ï•[k] + Ïµ[k]]p
p âˆ’[Ï•âˆ—]p
p
Ë†Î»[k + 1] âˆ’Î»âˆ—

2
P
(73)
where in (71) we used (69) and (70), and in (72), we used the
deï¬nition of Î´ in (11).
â– 
C. Proof of Lemma 4
Proof: From the deï¬nition of ËœR[k], we have that ËœRij[k] =
ËœPij[k]vj[k]/vi[k + 1]. From Lemma 3, we have that
vj[k] â‰¥1 âˆ’Î³
n
Ï„ N(2Bâˆ’1), k â‰¥1.
Since 1âŠ¤v[t] = n, âˆ€t â‰¥0, it follows that vi[k + 1] â‰¤n. We re-
call that, by (42), ËœPij[k] â‰¥Ï„, i = 1, . . . , N, âˆ€j âˆˆ
N âˆ’
i [k] âˆª{i},
âˆ€k. Hence
ËœRij[k] â‰¥1 âˆ’Î³
n2 Ï„ N(2Bâˆ’1)+1
i = 1, . . . , N, âˆ€j âˆˆ
N âˆ’
i [k] âˆª{i}, âˆ€k, yielding (56).
â– 
REFERENCES
[1] Z. Zhang and M. Y. Chow, â€œConvergence analysis of the incremental cost
consensus algorithm under different communication network topologies
in a smart grid,â€ IEEE Trans. Power Syst., vol. 27, no. 4, pp. 1761â€“1768,
Nov. 2012.
[2] A. D. DomÃ­nguez-GarcÃ­a, S. T. Cady, and C. N. Hadjicostis, â€œDecentral-
ized optimal dispatch of distributed energy resources,â€ in Proc. IEEE Conf.
Decis. Control, Dec. 2012, pp. 3688â€“3693.
[3] S. Kar and G. Hug, â€œDistributed robust economic dispatch in power
systems: A consensus innovations approach,â€ in Proc. IEEE Power Energy
Soc. Gen. Meeting, Jul. 2012, pp. 1â€“8.
[4] X. Zhang and A. Papachristodoulou, â€œRedesigning generation control in
power systems: Methodology, stability and delay robustness,â€ in Proc.
IEEE Conf. Decis. Control, Dec. 2014, pp. 953â€“958.
[5] S. T. Cady, A. D. DomÃ­nguez-GarcÃ­a, and C. N. Hadjicostis, â€œA distributed
generation control architecture for islanded AC microgrids,â€ IEEE Trans.
Control Syst. Technol., vol. 23, no. 5, pp. 1717â€“1735, Sep. 2015.
[6] G. Chen and Z. Zhao, â€œDistributed optimal active power control in micro-
grid with communication delays,â€ in Proc. Chin. Control Conf., Jul. 2016,
pp. 7515â€“7520.
[7] J. Wu, T. Yang, D. Wu, K. Kalsi, and K. H. Johansson, â€œDistributed optimal
dispatch of distributed energy resources over lossy communication net-
works,â€ IEEE Trans. Smart Grid, vol. 8, no. 6, pp. 3125â€“3137, Nov. 2017.
[8] A. Grami, Introduction to Digital Communications. Amsterdam, The
Netherlands: Elsevier., 2016.
[9] S. Yang, S. Tan, and J. Xu, â€œConsensus based approach for economic
dispatch problem in a smart grid,â€ IEEE Trans. Power Syst., vol. 28, no. 4,
pp. 4416â€“4426, Nov. 2013.
[10] A. Cherukuri and J. CortÃ©s, â€œDistributed generator coordination for ini-
tialization and anytime optimization in economic dispatch,â€ IEEE Trans.
Control Netw. Syst., vol. 2, no. 3, pp. 226â€“237, Sep. 2015.
[11] W. Du, L. Yao, D. Wu, X. Li, G. Liu, and T. Yang, â€œAccelerated distributed
energy management for microgrids,â€ in Proc. IEEE Power Energy Soc.
Gen. Meeting, Aug. 2018, pp. 1â€“5.
[12] T. Yang et al., â€œDistributed energy resource coordination over time-varying
directed communication networks,â€ IEEE Trans. Control Netw. Syst.,
vol. 6, no. 3, pp. 1124â€“1134, Sep. 2019.
[13] A. D. DomÃ­nguez-GarcÃ­a, C. N. Hadjicostis, and N. H. Vaidya, â€œResilient
networked control of distributed energy resources,â€ IEEE J. Sel. Areas
Commun., vol. 30, no. 6, pp. 1137â€“1148, Jul. 2012.
[14] C. N. Hadjicostis, N. H. Vaidya, and A. D. DomÃ­nguez-GarcÃ­a, â€œRobust
distributed average consensus via exchange of running sums,â€ IEEE Trans.
Autom. Control, vol. 61, no. 6, pp. 1492â€“1507, Jun. 2016.
[15] A. NediÂ´c and A. Olshevsky, â€œDistributed optimization over time-varying
directed graphs,â€ IEEE Trans. Autom. Control, vol. 60, no. 3, pp. 601â€“615,
Mar. 2015.
[16] D. Kempe, A. Dobra, and J. Gehrke, â€œGossip-based computation of aggre-
gate information,â€ in Proc. IEEE Symp. Found. Comput. Sci., Oct. 2003,
pp. 482â€“491.
[17] F. BÃ©nÃ©zit, V. Blondel, P. Thiran, J. Tsitsiklis, and M. Vetterli, â€œWeighted
gossip: Distributed averaging using non-doubly stochastic matrices,â€ in
Proc. IEEE Int. Symp. Inf. Theory, Jun. 2010, pp. 1753â€“1757.
[18] A. D. DomÃ­nguez-GarcÃ­a and C. N. Hadjicostis, â€œDistributed algorithms
for control of demand response and distributed energy resources,â€ in Proc.
IEEE Conf. Decis. Control Eur. Control Conf., Dec. 2011, pp. 27â€“32.


---

Page 16

---

1038
IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 68, NO. 2, FEBRUARY 2023
[19] A. NediÂ´c, A. Olshevsky, and W. Shi, â€œAchieving geometric convergence
for distributed optimization over time-varying graphs,â€ SIAM J. Optim.,
vol. 27, no. 4, pp. 2597â€“2633, 2017.
[20] H. Khalil, Nonlinear Systems, 3rd ed. Upper Saddle River, NJ, USA:
Prentice-Hall, 2002.
[21] G. Qu and N. Li, â€œOn the exponential stability of primal-dual gradient
dynamics,â€ IEEE Control Syst. Lett., vol. 3, no. 1, pp. 43â€“48, Jan. 2019.
[22] S. S. Du and W. Hu, â€œLinear convergence of the primal-dual gradient
method for convex-concave saddle point problems without strong convex-
ity,â€ in Proc. Mach. Learn. Res., vol. 89, Apr. 2019, pp. 196â€“205.
[23] R. B. Arthur and V. Vijay, Power Systems Analysis. Upper Saddle River,
NJ, USA: Prentice-Hall, 2000.
[24] A. Gomez-Exposito, A. J. Conejo, and C. Canizares, Electric Energy
Systems: Analysis and Operation, 2nd ed. Boca Raton, FL, USA: CRC
Press, 2018.
[25] D. P. Bertsekas, Nonlinear Program., 2nd ed. Nashua, NH, USA: Athena
Scientiï¬c, 1999.
[26] D. Varagnolo, G. Pillonetto, and L. Schenato, â€œDistributed statistical
estimation of the number of nodes in sensor networks,â€ in Proc. IEEE
Conf. Decis. Control, 2010, pp. 1498â€“1503.
[27] I. Shames, T. Charalambous, C. N. Hadjicostis, and M. Johansson, â€œDis-
tributed network size estimation and average degree estimation and control
in networks isomorphic to directed graphs,â€ in Proc. Annu. Allerton Conf.
Commun., Control, Comput., 2012, pp. 1885â€“1892.
[28] S. Zhang, C. TepedelenlioË˜glu, M. K. Banavar, and A. Spanias, â€œDistributed
node counting in wireless sensor networks in the presence of communica-
tion noise,â€ IEEE Sensors J., vol. 17, no. 4, pp. 1175â€“1186, Feb. 2017.
[29] R. A. Horn and C. R. Johnson, Matrix Analysis, 2nd ed. Cambridge, U.K.:
Cambridge Univ. Press, 2013.
[30] W. Rudin, Principles of Mathematical Analysis, 3rd ed. New York, NY,
USA: McGraw-Hill, 1976.
[31] J. Tsitsiklis, â€œProblems in decentralized decision making and computa-
tion,â€ Ph.D. dissertation, Dept. Elect. Eng. Comput. Sci., Massachusetts
Inst. Technol., Cambridge, MA, USA, 1984.
[32] A. NediÂ´c and A. Ozdaglar, â€œDistributed subgradient methods for multi-
agent optimization,â€ IEEE Trans. Autom. Control, vol. 54, no. 1, pp. 48â€“61,
Jan. 2009.
[33] C. N. Hadjicostis, A. D. DomÃ­nguez-GarcÃ­a, and T. Charalambous, â€œDis-
tributed averaging and balancing in network systems: With applications
to coordination and control,â€ Found. Trends Syst. Control, vol. 5, no. 2/3,
pp. 99â€“292, 2018.
[34] R. D. Zimmerman, C. E. Murillo-Sanchez, and R. J. Thomas, â€œMAT-
POWER: Steady-state operations, planning, and analysis tools for power
systems research and education,â€ IEEE Trans. Power Syst., vol. 26, no. 1,
pp. 12â€“19, Feb. 2011.
[35] L. Xiao, S. Boyd, and S. Lall, â€œA scheme for robust distributed sensor
fusion based on average consensus,â€ in Proc. Int. Symp. Inf. Process.
Sensor Netw., 2005, pp. 63â€“70.
[36] L. Lessard, B. Recht, and A. Packard, â€œAnalysis and design of optimization
algorithms via integral quadratic constraints,â€ SIAM J. Optim., vol. 26,
no. 1, pp. 57â€“95, 2016.
Madi Zholbaryssov received the B.S., M.S.,
and Ph.D. degrees in electrical engineering from
the University of Illinois at Urbana-Champaign,
Urbana, IL, USA, in 2011, 2014, and 2019, re-
spectively.
He is currently a Postdoctoral Research As-
sociate with the Department of Electrical and
Computer Engineering, University of Illinois at
Urbana-Champaign. His current research inter-
ests include applications of distributed control
and optimization in electric power systems.
Christoforos N. Hadjicostis (Fellow, IEEE) re-
ceived the S.B. degrees in electrical engineer-
ing, in computer science and engineering, and
in mathematics, in 1993, the M.Eng. degree in
electrical engineering and computer science in
1995, and the Ph.D. degree in electrical engi-
neering and computer science in 1999 from the
Massachusetts Institute of Technology, Cam-
bridge, MA, USA.
In 1999, he joined the Faculty with the Uni-
versity of Illinois at Urbanaâ€“Champaign, where
he was an Assistant and then Associate Professor with the Department
of Electrical and Computer Engineering, the Coordinated Science Lab-
oratory, and the Information Trust Institute. Since 2007, he has been
with the Department of Electrical and Computer Engineering, University
of Cyprus, where he is currently a Professor. His research interests
include fault diagnosis and tolerance in distributed dynamic systems,
error control coding, monitoring, diagnosis and control of large-scale
discrete-event systems, and applications to network security, anomaly
detection, energy distribution systems, medical diagnosis, biosequenc-
ing, and genetic regulatory models.
Dr. Hadjicostis is an Editor in Chief of the Journal of Discrete Event
Dynamic Systems and an Associate Editor of Automatica. He was an
Associate Editor for IEEE TRANSACTIONS ON AUTOMATIC CONTROL, IEEE
TRANSACTIONS ON AUTOMATION SCIENCE AND ENGINEERING, IEEE TRANS-
ACTIONS ON CONTROL SYSTEMS TECHNOLOGY, IEEE TRANSACTIONS ON
CIRCUITS AND SYSTEMS I, and the Journal of Nonlinear Analysis of Hybrid
Systems.
Alejandro D. DomÃ­nguez-GarcÃ­a (Senior Mem-
ber, IEEE) received the masterâ€™s degree in elec-
trical engineering from the University of Oviedo,
Oviedo, Spain, in 2001, and the Ph.D. degree
in electrical engineering and computer science
from the Massachusetts Institute of Technology,
Cambridge, MA, USA, in 2007.
He is currently a Professor with the Depart-
ment of Electrical and Computer Engineering
(ECE) and a Research Professor with the Coor-
dinated Science Laboratory and the Information
Trust Institute, University of Illinois at Urbana-Champaign. He is also
with the ECE Power and Energy Systems Area and has been a Grainger
Associate since August 2011. His research interests include the areas
of system reliability theory and control, and their applications to electric
power systems, power electronics, and embedded electronic systems
for safety-critical/fault-tolerant aircraft, aerospace, and automotive appli-
cations.
Dr. DomÃ­nguez-GarcÃ­a is a recipient of the NSF CAREER Award in
2010, and the Young Engineer Award from the IEEE Power and Energy
Society in 2012. In 2014, he was invited by the National Academy of
Engineering to attend the US Frontiers of Engineering Symposium, and
was selected by the University of Illinois at Urbana-Champaign Provost
to receive a Distinguished Promotion Award. In 2015, he received the U
of I College of Engineering Deanâ€™s Award for Excellence in Research. He
is an Editor for IEEE TRANSACTIONS POWER SYSTEMS and IEEE POWER
ENGINEERING LETTERS; he has been an editor for IEEE TRANSACTIONS
ON CONTROL OF NETWORK SYSTEMS.
